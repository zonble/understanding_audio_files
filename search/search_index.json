{"config":{"lang":["en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u95dc\u65bc\u300a\u8a8d\u8b58\u97f3\u6a94\u300b","text":"<p>2022 and onwards \u00a9 Weizhong Yang a.k.a zonble</p> <p>\u300a\u8a8d\u8b58\u97f3\u6a94\u300b\u662f\u4e00\u672c\u6211\u5728\u524d\u4e00\u4efd\u5de5\u4f5c\u96e2\u8077\u524d\uff082020 \u5e74\u4e94\u6708\uff09\u5beb\u7684\u4e00\u672c\u5c0f\u518a\u5b50\uff0c\u5c31\u5982\u540c\u6a19\u984c\u4e00\u822c\uff0c\u5167\u5bb9\u5c31\u662f\u8b1b\u89e3\u6211\u5728\u5de5\u4f5c\u4e0a\u66fe\u7d93\u8655\u7406\u904e\u3001\u6211\u6240\u4e86\u89e3\u7684\u97f3\u6a94\u683c\u5f0f\u3002\u4e00\u958b\u59cb\u5c31\u5beb\u4e86\u5169\u500b\u7248\u672c\uff0c\u4e00\u500b\u662f\u5305\u542b\u524d\u516c\u53f8\u696d\u52d9\u5167\u5bb9\u7684\u7248\u672c\uff0c\u53e6\u5916\u5c31\u662f\u60a8\u73fe\u5728\u6240\u770b\u5230\uff0c\u628a\u516c\u53f8\u76f8\u95dc\u696d\u52d9\u5167\u5bb9\u62ff\u6389\uff0c\u9069\u5408\u516c\u958b\u767c\u4f48\u7684\u7248\u672c\u3002\u539f\u672c\u5beb\u9019\u672c\u624b\u518a\uff0c\u4e5f\u4e0d\u662f\u8ab0\u7279\u5730\u6307\u6d3e\u7684\u5de5\u4f5c\uff0c\u53ea\u662f\u89ba\u5f97\u7e3d\u8981\u6709\u4eba\u6574\u7406\u4e00\u4e9b knowhow \u800c\u5df2\u3002</p> <p>\u9019\u500b\u7248\u672c\u7576\u4e2d\u7684\u5167\u5bb9\uff0c\u5176\u5be6\u53ea\u8981\u82b1\u9ede\u6642\u9593\uff0c\u90fd\u53ef\u4ee5\u900f\u904e\u641c\u5c0b\u5f15\u64ce\uff0c\u5728\u7db2\u8def\u4e0a\u627e\u5230\u76f8\u95dc\u7684\u516c\u958b\u8cc7\u6599\uff0c\u53ea\u662f\u60a8\u53ef\u80fd\u4e0d\u78ba\u5b9a\u61c9\u8a72\u8981\u4f7f\u7528\u4ec0\u9ebc\u95dc\u9375\u5b57\u641c\u5c0b\uff0c\u800c\u9019\u672c\u624b\u518a\u4e2d\uff0c\u7b97\u662f\u6211\u500b\u4eba\u6574\u7406\u904e\u7684\u7cfb\u7d71\u5316\u77e5\u8b58\uff0c\u5e0c\u671b\u53ef\u4ee5\u5c0d\u9700\u8981\u4e86\u89e3\u97f3\u6a94\u683c\u5f0f\u662f\u4ec0\u9ebc\u7684\u670b\u53cb\u6709\u4e9b\u5e6b\u52a9\u3002</p> <p>\u97f3\u6a94\u2014\u6216\u662f\u8aaa\uff0c\u5404\u7a2e\u96fb\u8166\u6a94\u6848\u683c\u5f0f\uff0c\u4e26\u4e0d\u662f\u5404\u7a2e\u8cc7\u8a0a\u6559\u80b2\u6703\u7279\u5225\u8b1b\u89e3\u7684\u4e00\u584a\uff0c\u5c0d\u7d55\u5927\u591a\u6578\u7684\u96fb\u8166\u7528\u6236\u4f86\u8aaa\uff0c\u53ea\u8981\u80fd\u5920\u628a\u8072\u97f3\u64ad\u51fa\u4f86\u5c31\u5920\u4e86\uff1b\u4f60\u554f\u4efb\u4f55\u4e00\u500b\u96fb\u8166\u7528\u6236\u300c\u4ec0\u9ebc\u662f MP3\u300d\uff1f\u5927\u6982\u6240\u6709\u4eba\u90fd\u53ef\u4ee5\u8b1b\u51fa\u300cMP3 \u662f\u4e00\u7a2e\u6a94\u6848\u300d\uff0c\u4f46 MP3 \u662f\u600e\u6a23\u7684\u6a94\u6848\uff1f MP3 \u8207 AAC \u6709\u4ec0\u9ebc\u4e0d\u540c\uff0c\u80fd\u5920\u56de\u7b54\u7684\u5c31\u5f88\u5c11\uff0c\u56e0\u70ba\u6c92\u6709\u7279\u5225\u4e86\u89e3\u7684\u5fc5\u8981\u3002</p> <p>\u751a\u81f3\u5728\u696d\u754c\uff0c\u5176\u5be6\u4e5f\u53ea\u6709\u5728\u5c11\u6578\u516c\u53f8\u4efb\u8077\u7684\u5de5\u7a0b\u5e2b\u9700\u8981\u4e86\u89e3\uff0c\u5927\u6982\u4e5f\u53ea\u6709\u9047\u5230\u7522\u88fd\u97f3\u6a94\uff0c\u6216\u662f\u64ad\u653e\u97f3\u6a94\u9019\u4e9b\u9700\u6c42\uff0c\u9700\u8981\u88fd\u4f5c\u64ad\u653e\u8edf\u9ad4\u6642\u624d\u6709\u7279\u5730\u4e86\u89e3\u7684\u5fc5\u8981\u3002\u6240\u4ee5\uff0c\u5373\u4f7f\u4ec0\u9ebc\u8cc7\u6599\u5728\u7db2\u8def\u4e0a\u90fd\u5f88\u5bb9\u6613\u627e\u5230\uff0c\u4f46\u662f\u60f3\u8981\u4e86\u89e3\u9019\u4e9b\u7db2\u8def\u4e0a\u7684\u6587\u4ef6\u5230\u5e95\u5728\u8b1b\u4ec0\u9ebc\uff0c\u5176\u5be6\u4e5f\u8981\u82b1\u4e0a\u4e00\u6bb5\u6642\u9593\u3002\u8d77\u78bc\u6211\u81ea\u8a8d\u82b1\u4e86\u4e0d\u5c11\u6642\u9593\u3002</p> <p>\u5373\u4f7f\u662f\u5de5\u7a0b\u5e2b\u90fd\u8981\u82b1\u4e0a\u4e0d\u5c11\u6642\u9593\uff0c\u5728\u6578\u4f4d\u97f3\u6a02\u3001\u6216\u662f\u5176\u4ed6\u8207\u96fb\u8166\u97f3\u6a94\u76f8\u95dc\u7684\u7522\u696d\uff0c\u9084\u6709\u5176\u4ed6\u4e0d\u540c\u529f\u80fd\u7684\u89d2\u8272\uff0c\u5176\u5be6\u4e5f\u9700\u8981\u4e86\u89e3\u97f3\u6a94\uff0c\u5982\u679c\u4f60\u662f\u500b\u60f3\u8981\u9032\u5165\u6578\u4f4d\u97f3\u6a02\u7522\u696d\u7684 PM\uff0c\u4f60\u53ef\u80fd\u4e0a\u73ed\u7684\u7b2c\u4e00\u5929\uff0c\u5c31\u53ef\u80fd\u807d\u5230\u300c\u5ba2\u6236\u53cd\u61c9\u64ad\u653e\u97f3\u6a02\u6703\u7206\u97f3\u300d\u3001\u300c\u6211\u5011\u8a08\u756b\u63a8\u51fa\u9ad8\u97f3\u8cea\u65b9\u6848\u300d\u7b49\uff0c\u800c\u9019\u4e9b\u90fd\u662f\u9700\u8981\u5c0d\u97f3\u6a94\u6709\u4e00\u5b9a\u4e86\u89e3\u624d\u80fd\u5b8c\u6210\u7684\u4efb\u52d9\u3002</p> <p>\u6211\u5728\u524d\u4e00\u4efd\u5de5\u4f5c\u4e2d\uff0c\u4e3b\u8981\u5de5\u4f5c\u5167\u5bb9\u4e4b\u4e00\uff0c\u5c31\u662f\u88fd\u4f5c client \u7aef\u7684\u64ad\u653e\u8edf\u9ad4\u3002\u6240\u4ee5\uff0c\u9019\u4efd\u624b\u518a\u6703\u66f4\u504f\u5411 client \u7aef\u7684\u89d2\u5ea6\uff0c\u600e\u6a23\u89e3\u6790\uff08parse\uff09\u6a94\u6848\u683c\u5f0f\uff0c\u800c\u4e14\u4e5f\u6bd4\u8f03\u504f\u91cd container \u7684\u90e8\u4efd\uff0c\u7562\u7adf\u8ddf codec \u6709\u95dc\u7684\u90e8\u5206\uff0c\u4e5f\u5c31\u53ea\u80fd\u5920\u547c\u53eb library\uff0d\u4e00\u7a2e\u97f3\u6a94\u683c\u5f0f\u5206\u6210 container \u8207 codec\uff0c\u6211\u5011\u665a\u9ede\u6703\u8aaa\u660e\u3002\u81f3\u65bc\u8f49\u6a94\u5de5\u5177\u7684\u4f7f\u7528\uff0c\u600e\u6a23\u5728 server \u4e0a\u3001CDN \u4e0a\u4f48\u7f72\u6a94\u6848\uff0c\u5c31\u4e0d\u662f\u6211\u6240\u719f\u6089\u7684\u7bc4\u570d\uff0c\u6240\u4ee5\u4e0d\u6703\u5728\u9019\u4efd\u624b\u518a\u4e2d\u3002</p> <p>\u9810\u671f\u5728\u8b80\u5b8c\u9019\u4efd\u6587\u4ef6\u4e4b\u5f8c\uff0c\u4f60\u53ef\u4ee5\uff1a</p> <ul> <li>\u4ee5\u5f8c\u770b\u5230\u6709\u4eba\u63d0\u5230 48000Hz 24bit \u7684\u9ad8\u97f3\u8cea\u6a94\u6848\uff0c\u53ef\u4ee5\u99ac\u4e0a\u53eb\u51fa\u300c\u9019\u662f DVD \u97f3\u8cea\u300d</li> <li>\u77e5\u9053\u97f3\u6a94\u5206\u6210 codec \u4ee5\u53ca container\uff0c\u800c\u4e14\u77e5\u9053\u9019\u4e9b\u540d\u8a5e\u7684\u610f\u7fa9</li> <li>\u77e5\u9053 FairPlay \u8207 Widevine \u9019\u4e9b\u5546\u7528 DRM \u6240\u4fdd\u8b77\u7684\u662f\u4ec0\u9ebc\u683c\u5f0f</li> </ul> <p>\u7576\u4e2d\u6709\u4ec0\u9ebc\u932f\u6f0f\u4e4b\u8655\uff0c\u4e5f\u7948\u8acb\u5927\u5bb6\u6307\u6b63\u3002\u5927\u5bb6\u53ef\u4ee5\u76f4\u63a5 fork \u9019\u672c\u624b\u518a\u7136\u5f8c\u767c pull request\u3002\u7136\u5f8c\uff0c\u6839\u64da\u672c\u4eba\u904e\u53bb\u7d93\u9a57\uff0c\u61c9\u8a72\u6c92\u6709\u4ec0\u9ebc\u6642\u9593\u7d93\u71df\u8a0e\u8ad6\u5340\u6216\u7fa4\u7d44\uff0c\u6240\u4ee5 GitHub \u4e0a\u5c31\u76f4\u63a5\u95dc\u9589\u8a0e\u8ad6\u7248\u4e86\uff0c\u76f8\u4fe1\u6703\u7528\u5230\u9019\u672c\u624b\u518a\u7684\u61c9\u8a72\u90fd\u662f\u540c\u884c\uff0c\u61c9\u8a72\u53ef\u4ee5\u898b\u8ad2\u3002</p>"},{"location":"#_2","title":"\u6388\u6b0a","text":"<p>\u9019\u672c\u624b\u518a\u4f7f\u7528 MIT License \u91cb\u51fa\u3002</p>"},{"location":"#_3","title":"\u9023\u7d50","text":"<ul> <li>\u9019\u672c\u624b\u518a\u4f4d\u5728 https://zonble.github.io/understanding_audio_files/</li> <li>GitHub \u5c08\u6848\u4f4d\u7f6e\u5728 https://github.com/zonble/understanding_audio_files</li> <li>PDF \u7248\u672c</li> </ul>"},{"location":"#_4","title":"\u806f\u7d61\u65b9\u5f0f","text":"<ul> <li>g.dev/zonble</li> <li>Twitter @zonble</li> <li>GitHub @zonble</li> </ul>"},{"location":"#_5","title":"\u611f\u8b1d","text":"<p>\u5728\u767c\u5e03\u4e4b\u5f8c\uff0c\u611f\u8b1d\u4ee5\u4e0b\u670b\u53cb\u7684\u6307\u6b63</p> <ul> <li>iXerol</li> <li>kojirou1994</li> </ul>"},{"location":"#_6","title":"\u6211\u5de5\u4f5c\u4e0a\u66fe\u7d93\u9047\u904e\u7684\u97f3\u6a94","text":"<p>\u6211\u5728\u5de5\u4f5c\u4e0a\u66fe\u7d93\u9047\u904e</p> <ul> <li>PCM</li> <li>MP3</li> <li>AAC \uff08AAC-MP4 \u8207 AAC-ADTS\uff09</li> <li>FLAC</li> <li>HLS\uff08HTTP Live-Streaming\uff09</li> <li>MPEG-DASH</li> </ul> <p>\u5728\u63a5\u4e0b\u4f86\u7684\u7ae0\u7bc0\u4e2d\uff0c\u6703\u9010\u4e00\u8aaa\u660e\u3002</p>"},{"location":"aac/","title":"AAC \u8207 MP4 \u683c\u5f0f","text":"<p>AAC \u5168\u540d Advanced Audio Encoding\uff0c\u662f\u4e00\u7a2e\u5728\u4e0a\u500b\u4e16\u7d00\u4e5d\u96f6\u5e74\u4ee3\u5e95\u8a02\u51fa\u7684\u898f\u683c\u3002AAC \u662f\u4e00\u7a2e codec\uff0c\u4f46\u662f\u53ef\u4ee5\u88ab\u5305\u5728\u4e0d\u540c\u7a2e\u985e\u7684 container \u4e2d\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u901a\u5e38\u4e0d\u6703\u55ae\u7368\u7a31\u547c\u6709\u67d0\u7a2e\u6a94\u6848\u662f AAC \u6a94\u6848\uff0c\u800c\u662f\u5c07 AAC \u8207 container \u683c\u5f0f\u5408\u7a31\uff0c\u50cf\u662f AAC-MP4\u3001AAC-ADTS\u2026\u7b49\u3002</p>"},{"location":"aac/#aac-adts","title":"AAC-ADTS","text":"<p>AAC-ADTS \u683c\u5f0f\u8207 MP3 \u683c\u5f0f\u63a5\u8fd1\uff0c\u4e00\u6a23\u662f\u4e00\u6bb5 header \u4e4b\u5f8c\u63a5\u8457\u4e00\u500b packet\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u4e5f\u53ef\u4ee5\u770b\u5230\u4f7f\u7528 AAC \u683c\u5f0f\u7684\u7db2\u8def\u5ee3\u64ad\u96fb\u53f0\u3002\u6bcf\u500b packet \u4f7f\u7528 AAC codec \u58d3\u7e2e\uff0c\u6bcf\u500b packet \u4e2d\u5305\u542b 1024 \u500b frame\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u77e5\u9053\uff0c\u4f7f\u7528 AAC-ADTS \u7522\u751f\u51fa\u4f86\u7684\u97f3\u6a94\u7684\u9577\u5ea6\uff0c\u8207 MP3 \u662f\u4e0d\u540c\u7684\u3002</p> <p>AAC-ADTS \u4e5f\u6709\u81ea\u5df1\u7684 header \u683c\u5f0f\uff0c\u9577\u5ea6\u5728 7 \u5230 9 \u500b bytes \u4e4b\u9593\u3002\u4e00\u822c\u4f86\u8aaa\uff0c\u9644\u6a94\u540d\u662f <code>.aac</code> \u7684\u6a94\u6848\uff0c\u4fbf\u662f AAC-ADTS \u6a94\u6848\u3002</p> <p></p> <p>\u6253\u958b ADTS \u7684\u898f\u683c\uff0c\u6211\u5011\u53c8\u770b\u5230\u300cAAAAAAAA AAAABCCD EEFFFFGH HHIJKLMM MMMMMMMM MMMOOOOO OOOOOOPP (QQQQQQQQ QQQQQQQQ)\u300d\u9019\u7a2e\u6587\u5b57\uff0c\u6211\u5011\u65e2\u7136\u8655\u7406\u904e MP3\uff0c\u6211\u5011\u4e5f\u77e5\u9053\u600e\u9ebc\u8655\u7406\u9019\u7a2e header\u3002</p> <p>\u524d 12 \u500b bit \u662f syncword\uff0c\u6240\u4ee5\uff0c\u53ea\u8981\u9023\u7e8c\u8b80\u5230 12 \u500b 1\uff0c\u5c31\u53ef\u4ee5\u5224\u65b7\u662f header \u7684\u958b\u59cb\u3002\u5f9e\u7b2c 30 \u500b bit \u958b\u59cb\uff0c\u4e5f\u5c31\u662f M \u9019\u6bb5\uff0c\u88e1\u982d\u662f\u6574\u500b packet \u7684\u9577\u5ea6\u2014\u8acb\u6ce8\u610f\uff0c\u9019\u500b\u9577\u5ea6\u4e5f\u5305\u542b header \u7684\u90e8\u4efd\u2014\u53ea\u8981\u7e7c\u7e8c\u5f80\u4e0b\u8b80\uff0c\u5c31\u53ef\u4ee5\u8b80\u51fa packet\u3002</p> <p>AAC-ADTS \u683c\u5f0f\u4e5f\u53ef\u80fd\u5305\u542b ID3 \u6a94\u982d\u3002\u5728 iOS/macOS \u5e73\u53f0\u4e0a\uff0c\u9700\u8981\u6ce8\u610f\uff1aCore Audio API \u6240\u63d0\u4f9b\u7684 parser \u7121\u6cd5\u6b63\u78ba\u89e3\u6790\u6a94\u6848\u524d\u65b9\u6709\u9ad2\u6389\u7684\u8cc7\u6599\u7684 AAC-ADTS \u8cc7\u6599\uff0c\u6211\u5011\u9700\u8981\u81ea\u5df1\u5beb\u4e00\u500b parser\uff0c\u624b\u52d5\u628a Core Audio \u7121\u6cd5\u89e3\u6790\u7684\u90e8\u4efd\u6ffe\u6389\u2014\u4e5f\u5c31\u662f\u8aaa\uff0c\u6211\u5011\u8981\u81ea\u5df1\u60f3\u8fa6\u6cd5\u627e\u5230\u7b2c\u4e00\u500b syncword\u3002</p> <p>\u6211\u5011\u4e5f\u53ef\u4ee5\u6253\u958b Hex Editor \u770b\u770b\u3002\u4e00\u500b\u5305\u542b ID3 \u8cc7\u8a0a\u7684 AAC-ADTS \u6a94\u6848\uff0c\u53ef\u80fd\u6703\u662f\u50cf\u9019\u6a23\uff1a</p> <p></p>"},{"location":"aac/#aac-mp4_1","title":"AAC-MP4","text":"<p>AAC-MP4 \u683c\u5f0f\u7684\u6a94\u6848\uff0c\u901a\u5e38\u526f\u6a94\u540d\u662f <code>.mp4</code> \u6216 <code>.m4a</code>\u3002\u800c\u7576\u6211\u5011\u5728\u8a0e\u8ad6 HLS \u4ee5\u53ca MPEG Dash \u6642\uff0c\u4e5f\u9700\u8981\u77e5\u9053\uff1a\u9019\u4e9b\u683c\u5f0f\u4e5f\u5efa\u7acb\u5728 MP4 \u683c\u5f0f\u4e0a\uff0c\u50cf HLS \u88e1\u982d\u7684\u6bcf\u500b TS \u5f80\u5f80\u5c31\u662f MP4 \u6a94\u6848\uff0c\u800c MPEG Dash \u66f4\u662f\u76f8\u7576\u501a\u8cf4\u4e00\u7a2e\u53eb\u505a fMP4 \u7684\u683c\u5f0f\u3002</p> <p>MP4 \u683c\u5f0f\u6df5\u6e90\u81ea\u860b\u679c\u7684 QuickTime \u683c\u5f0f\uff0c\u6240\u4ee5 MP4 \u53ef\u8aaa\u8207 QuickTime \u4e92\u901a\u3002\u8ddf\u6211\u5011\u5728\u524d\u9762\u8b1b\u904e\u7684\u683c\u5f0f\u6bd4\u8f03\uff0cMP4 container \u6709\u5f88\u591a\u4e0d\u540c\uff1a</p> <ul> <li>MP4 \u4e0d\u53ea\u662f\u4e00\u7a2e\u97f3\u6a02\u683c\u5f0f\uff0c\u4e5f\u662f\u4e00\u7a2e\u5f71\u7247\u683c\u5f0f\u2014\u67d0\u65b9\u9762\u4f86\u8aaa\uff0c\u6211\u5011\u53ef\u4ee5\u628a MP4 container\uff0c\u60f3\u50cf\u6210\u662f\u4e00\u7a2e\u628a\u6240\u6709\u756b\u9762\u90fd\u62ff\u6389\u7684\u5f71\u7247</li> <li>MP4 \u662f\u4e00\u7a2e\u6a39\u72c0/\u5de2\u72c0\u7684\u7d50\u69cb</li> <li>MP4 \u683c\u5f0f\u672c\u8eab\u5c31\u6709 metadata \u7684\u5340\u6bb5</li> <li>MP4 \u5305\u542b\u5206\u958b\u4f86\u7684\u6642\u9593/\u8cc7\u6599\u5982\u4f55\u5c0d\u61c9\u7684\u5340\u6bb5</li> </ul> <p>\u6211\u5011\u4f86\u770b\u4e00\u4e0b\u6bcf\u500b MP4 \u6a94\u6848\u7684\u7d50\u69cb\u3002</p>"},{"location":"aac/#atoms","title":"Atoms","text":"<p>MP4 \u662f\u4ee5 atom \u6240\u69cb\u6210\u3002\u6bcf\u500b atom\uff0c\u90fd\u53ef\u4ee5\u60f3\u6210\u662f\u4e00\u500b\u6a39\u72c0\u7d50\u69cb\u7684\u7bc0\u9ede\uff0c\u5728\u6a39\u72c0\u7d50\u69cb\u7684\u6839\u90e8\u6709\u4e00\u4e9b\u57fa\u672c atom\uff0c\u5728\u9019\u4e9b\u57fa\u672c atom \u5e95\u4e0b\uff0c\u6bcf\u500b\u5b50 atom\uff08\u5373 sub atom\uff09\u662f\u88ab\u4e00\u500b\u4e0a\u5c64\u7bc0\u9ede\u6240\u5305\u570d\u3002\u6bcf\u500b atom \u90fd\u6709\u4e00\u6bb5 header\uff0cheader \u7576\u4e2d\u5305\u542b\u9019\u500b atom \u7684\u5404\u7a2e\u8cc7\u8a0a\uff0c\u5305\u62ec\u9019\u500b atom \u7684 header \u8207 body \u7684\u9577\u5ea6\u3001\u7a2e\u985e\u3001ID\u3001\u6709\u591a\u5c11\u5b50 atom\u2026\u7b49\uff08\u53c3\u898b\u860b\u679c\u6587\u4ef6QT Atoms and Atom Containers\uff0c\u9019\u4efd\u6587\u4ef6\u4e5f\u8aaa\u660e\u4e86 atom \u7684\u898f\u683c\uff0c\u5728\u9019\u908a\u4e0d\u8d05\u8ff0\uff09\uff0c\u64ad\u653e\u5668\u5728\u77e5\u9053\u67d0\u500b atom \u7684\u610f\u7fa9\u4e4b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u7e7c\u7e8c\u5f9e\u9019\u500b atom \u7684 Body \u5340\u6bb5\uff0c\u7e7c\u7e8c\u5c0b\u627e\u9019\u500b atom \u7684\u5b50 atom\u3002</p> <p>\u5728 MP4 \u898f\u683c\u4e2d\uff0c\u6700\u4e0a\u5c64\u7684 atom \u5305\u62ec\u662f <code>ftyp</code>\u3001<code>moov</code>\u3001<code>mdat</code> \u7b49\u6700\u91cd\u8981\u7684\u5340\u6bb5\uff0c\u6211\u5011\u53ef\u4ee5\u60f3\u50cf\u6210\u5728\u9023\u7e8c\u7684 Binary Data \u4e2d\uff0c\u5148\u88ab\u5206\u6210\u4e86\u9019\u5e7e\u6bb5\uff0c\u7136\u5f8c\u5728\u4e0b\u65b9\u9084\u6709\u5176\u4ed6 atom\u3002\u5047\u5982\u6211\u5011\u62ff MP4 Parse \u5de5\u5177\u88e1\u982d\u89e3\u6790\u4e00\u500b MP4 \u6a94\u6848\uff0c\u5c31\u61c9\u8a72\u53ef\u4ee5\u770b\u5230\u9019\u4e9b atom\uff1a</p> <p></p> <ul> <li><code>ftyp</code>\uff1a\u7528\u4f86\u6a19\u793a\u9019\u500b MP4 \u6a94\u6848\u7684\u985e\u578b\uff0c\u50cf\u662f\u9019\u500b\u6a94\u6848\u662f\u90e8\u5f71\u7247\uff0c\u6216\u662f\u53ea\u6709\u97f3\u6a02\u7684\u97f3\u6a94\u7b49</li> <li><code>moov</code>\uff1a\u9019\u500b\u6a94\u6848\u76f8\u95dc\u7684 metadata\uff0c\u50cf\u662f\u6b4c\u624b\u3001\u5c08\u8f2f\u3001\u6b4c\u66f2\u540d\u7a31\uff0c\u6216\u662f\u5c01\u9762\u5716\u7b49\u7b49\u3002 MP4 \u53ef\u4ee5\u6a19\u793a\u7684 metadata \u76f8\u5c0d\u4f86\u8aaa\u6bd4\u8f03\u8907\u96dc\uff0c\u6bd4\u65b9\u8aaa\uff0c\u4e00\u90e8\u5f71\u7247\u53ef\u80fd\u6709\u591a\u500b\u7ae0\u7bc0\uff0c\u90a3\u9ebc\uff0c<code>moov</code> \u4e2d\u5c31\u6703\u5305\u542b\u5404\u500b\u7ae0\u7bc0\u7684\u76f8\u95dc\u8cc7\u6599</li> <li><code>mdat</code>\uff1a\u97f3\u6a94\u8cc7\u6599\u5be6\u969b\u88ab\u5b58\u653e\u7684\u4f4d\u7f6e</li> <li>\u5176\u4ed6\uff1a\u5728 MP4 \u7684\u898f\u683c\u4e2d\uff0c\u4e5f\u5b9a\u7fa9\u4e86\u50cf\u662f <code>free</code>\u3001<code>skip</code>\u3001<code>wide</code> \u9019\u4e9b\u985e\u578b\u7684 atom\uff0c\u4ee3\u8868\u7684\u662f\u53ef\u4ee5\u8df3\u904e\u7684\u7a7a\u8cc7\u6599</li> </ul>"},{"location":"aac/#mp4-random-seek","title":"MP4 \u683c\u5f0f\u5982\u4f55\u9054\u6210\u5feb\u901f Random Seek","text":"<p>\u524d\u9762\u63d0\u5230\uff0c\u5728\u8655\u7406 MP3 \u6216\u662f AAC-ADTS \u683c\u5f0f\u7684\u6642\u5019\uff0c\u5fc5\u9808\u8981\u628a\u6574\u500b\u6a94\u6848\u5f9e\u982d\u5230\u5c3e\u8b80\u4e00\u904d\uff0c\u624d\u77e5\u9053\u6709\u591a\u5c11 packet\uff0c\u4ee5\u53ca packet \u7684\u6240\u5728\u4f4d\u7f6e\uff0c\u4e0d\u5229\u65bc\u5feb\u901f\u8a08\u7b97\u6b4c\u66f2\u7684\u7e3d\u9577\u5ea6\uff0c\u4ee5\u53ca\u5feb\u901f seek \u5230\u67d0\u500b\u4f4d\u7f6e\u64ad\u653e\u3002\u6211\u5011\u53ef\u4ee5\u770b\u4e00\u4e0b <code>moov</code> \u4ee5\u4e0b\u6709\u54ea\u4e9b atom\uff0c\u65b9\u4fbf\u89e3\u6c7a MP3 \u683c\u5f0f\u4ee5\u53ca ADTS \u683c\u5f0f\u7684\u554f\u984c\uff1a</p> <p></p> <p>\u4ee5\u4e0a\u5716\u7247\u4f86\u81ea\u860b\u679c\u958b\u767c\u8005\u7db2\u7ad9 QuickTime File Format Specification: Movie Atoms\u3002</p> <p>\u6211\u5011\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u5728 <code>moov</code> \u5e95\u4e0b\uff0c\u5305\u542b\u50cf\u662f <code>stsz</code>\u3001<code>stco</code> \u7b49 atom\uff0c<code>stsz</code> \u9019\u500b atom \u4e2d\u5305\u542b\u7684\u5c31\u662f packet \u7684\u6578\u91cf\uff0c<code>stco</code> \u5247\u662f\u6bcf\u500b packet \u5728 <code>mdat</code> atom \u4e2d\u7684 offset \u4f4d\u7f6e\u3002</p> <p>\u5728\u5e73\u53f0\u4e0a\u6240\u63d0\u4f9b\u7684\u5168\u529f\u80fd\u64ad\u653e\u5143\u4ef6\uff0c\u50cf\u662f iOS/macOS \u7684 AVPlayer\uff0c\u5728\u64ad\u653e\u4e00\u500b\u4f4d\u5728\u7dda\u4e0a\u7684 MP4 \u6a94\u6848\u7684\u6642\u5019\uff0c\u6703\u767c\u51fa\u591a\u689d\u9023\u7dda\uff0c\u5617\u8a66\u5728\u6a94\u6848\u7684\u6700\u524d\u65b9\u6216\u662f\u6700\u5f8c\u65b9\u627e\u5230 <code>moov</code> \u5340\u6bb5\uff0c\u7136\u5f8c\u5f9e <code>moov</code> \u5340\u6bb5\u4e2d\u627e\u5230 <code>stsz</code>\u3001<code>stco</code> \u7b49\u5340\u6bb5\uff0c\u6709\u4e86 <code>stsz</code>\uff0c\u5c31\u53ef\u4ee5\u756b\u51fa\u9032\u5ea6\u689d\uff0c\u63d0\u4f9b\u7528\u6236\u505a random seek \u7684 UI\uff0c\u7576\u7528\u6236 seek \u5230\u67d0\u500b\u5730\u65b9\u7684\u6642\u5019\uff0c\u5c31\u6839\u64da <code>stco</code>\uff0c\u767c\u9001\u5e36\u6709 Range Header \u7684 HTTP \u9023\u7dda\uff0c\u5f9e\u54ea\u500b\u5730\u65b9\u6293\u53d6\uff0c\u5982\u679c\u6c92\u6709 <code>stsz</code> \u4ee5\u53ca <code>stco</code>\uff0c\u624d\u53bb\u628a <code>mdat</code> \u8b80\u904e\u4e00\u904d\uff0c\u627e\u51fa packet \u4f4d\u7f6e\u3002\u5982\u679c\u662f\u4e00\u4efd\u88ab\u71d2\u9304\u5728 DVD \u6216\u662f\u85cd\u5149\u789f\u7247\u7684\u5927\u6a94\uff0c\u4e5f\u4e00\u6a23\u6703\u5617\u8a66\u5148\u5f9e\u6a94\u6848\u7684\u6700\u524d\u65b9\u6216\u662f\u6700\u5f8c\u65b9\uff0c\u627e\u5230 <code>moov</code> \u5340\u6bb5\u3002</p> <p>\u7531\u65bc\u64ad\u653e\u8edf\u9ad4\u5728\u8f09\u5165 MP4 \u6a94\u6848\u7684\u6642\u5019\uff0c\u4e0d\u662f\u76f4\u63a5\u8f09\u5165\u53ef\u4ee5\u64ad\u653e\u7684\u8cc7\u6599\uff0c\u800c\u662f\u5148\u53bb\u5c0b\u627e <code>moov</code> \u5340\u6bb5\uff0c\u6240\u4ee5\uff0c\u5728\u64ad\u653e MP4 \u7684\u6642\u5019\uff0c\u5176\u5be6\u53ef\u4ee5\u611f\u53d7\u5230\uff0c\u6703\u6709\u4e00\u6bb5\u524d\u7f6e\u8655\u7406\u7684\u6642\u9593\u3002\u50cf Chromecast \u4e0a\u7684 audio player\uff0c\u63a1\u53d6\u7684\u5c31\u662f\u9019\u6a23\u7684\u64ad\u653e\u884c\u70ba\uff0c\u6bcf\u6b21\u5c0d Chromecast \u547c\u53eb random seek\uff0c\u5f80\u5f80\u5c31\u6703\u89f8\u767c\u4e00\u500b\u5e36 Range header \u7684\u9023\u7dda\uff0c\u800c\u5982\u679c\u5df2\u7d93\u904e\u4e86\u4e00\u5206\u9418\u624d\u505a random seek\uff0c\u5c31\u6703\u56e0\u70ba\u97f3\u6a94\u5df2\u7d93\u4e0d\u5b58\u5728\u800c\u7121\u6cd5\u64ad\u653e\uff0c\u6240\u4ee5\uff0c\u6211\u5011\u5728\u7522\u54c1\u4e0a\uff0c\u5c31\u505a\u904e\u5728 Chromecast \u4e0a\u7121\u6cd5 random seek \u7684\u5947\u5999\u8a2d\u8a08\u3002</p> <p>\u53e6\u5916\u8981\u6ce8\u610f\uff1a\u5982\u679c\u6211\u5011\u4f7f\u7528 iOS/macOS \u4e0a\u7684 CoreAudio API \u7684 Audio Parser\uff0c\u50cf\u662f AudioFileStreamID\uff0c\u5c31\u53ea\u80fd\u5920\u89e3\u6790 <code>moov</code> \u653e\u5728 <code>mdat</code> \u524d\u65b9\u7684 MP4 \u6a94\u6848\uff0c\u4e0d\u7136\u5c31\u6703\u8df3\u51fa kAudioFileStreamError_NotOptimized \u932f\u8aa4\uff0c\u4ee3\u78bc\u7684\u610f\u601d\u662f\u300c\u9019\u500b\u6a94\u6848\u6c92\u6709\u505a\u904e\u6700\u4f73\u5316\u300d\uff0c\u610f\u601d\u5176\u5be6\u4e0d\u6e05\u4e0d\u695a\uff0c\u6211\u5011\u4e5f\u662f\u82b1\u4e86\u9ede\u6642\u9593\u624d\u4e86\u89e3\u860b\u679c\u7684\u610f\u601d\u3002\u5f88\u591a\u6642\u5019\uff0c\u6211\u5011\u5728 iOS/macOS \u4e0a\uff0c\u53ef\u4ee5\u7528 QuickTime \u6216\u662f AVPlayer \u64ad\u653e\u7684\u6a94\u6848\uff0c\u7528 CoreAudio API \u537b\u4e0d\u898b\u5f97\u6709\u8fa6\u6cd5\u64ad\u51fa\uff0c\u4e5f\u5c31\u662f\u8aaa\uff0c\u860b\u679c\u5728\u81ea\u5df1\u7522\u54c1\u4e0a\u4f7f\u7528\u7684 Parser\uff0c\u8ddf\u958b\u653e\u7d66\u5916\u90e8\u958b\u767c\u8005\u4f7f\u7528\u7684 API\uff0c\u5176\u5be6\u662f\u4e0d\u540c\u7684\u3002</p>"},{"location":"aac/#aac-mp4_2","title":"AAC-MP4 \u6a94\u6848","text":"<p>\u6211\u5011\u4e5f\u53ef\u4ee5\u62ff Hex Editor\uff0c\u6253\u958b\u4e00\u500b AAC-MP4 \u6a94\u6848\u770b\u770b\u3002\u53ef\u4ee5\u770b\u5230\u5728\u6700\u524d\u65b9\u662f <code>ftyp</code> \u6b04\u4f4d\uff0c\u6a19\u793a\u9019\u500b\u6a94\u6848\u662f M4A\uff0c\u7136\u5f8c\u5f9e\u7b2c 36 \u500b byte \u958b\u59cb\uff0c\u5c31\u662f <code>mdat</code> \u5340\u6bb5\u3002</p> <p></p> <p>\u9019\u500b\u6a94\u6848\u7684 <code>moov</code> \u5340\u6bb5\u4f4d\u5728\u5f8c\u65b9\uff1a</p> <p></p> <p>\u5728 <code>moov</code> \u7576\u4e2d\u5305\u542b <code>stco</code> \u9019\u6bb5\u7528\u4f86\u65b9\u4fbf\u505a random seek \u7684 atom\uff1a</p> <p></p> <p>\u53e6\u5916\uff0c\u5982\u679c\u60f3\u8981\u89e3\u6790 MP4 \u6a94\u6848\u7576\u4e2d\u7684 Atom\uff0c\u5728\u7db2\u8def\u4e0a\u5df2\u7d93\u6709\u4e0d\u5c11\u73fe\u6210\u7684\u5de5\u5177\uff0c\u5149\u662f\u7528 Google \u641c\u5c0b\u300cMP4 Atom Parser\u300d\uff0c\u5c31\u53ef\u4ee5\u627e\u5230\u4e0d\u5c11\u3002\u6211\u5011\u7c21\u55ae\u5217\u51fa\u5e7e\u500b\uff1a</p> <ul> <li>mp4parser.com</li> <li>onlinemp4parser.com</li> <li>mp4explorer\uff0c\u7528 C# \u5beb\u6210\u7684 Windows \u7a0b\u5f0f</li> </ul>"},{"location":"dash/","title":"MPEG-DASH \u8207 Widevine DRM","text":"<p>HLS \u8207\u860b\u679c\u751f\u614b\u7cfb\u7d81\u5f97\u975e\u5e38\u7dca\u5bc6\uff0c\u5728\u860b\u679c\u7684\u751f\u614b\u7cfb\u4e4b\u5916\uff0c\u5c31\u7d93\u5e38\u53ef\u4ee5\u770b\u5230\u4f7f\u7528 MPEG-DASH \u505a\u70ba\u7dda\u4e0a\u4e32\u6d41\u7684\u89e3\u6c7a\u65b9\u6848\u3002</p> <p>DASH \u662f Dynamic Adaptive Streaming over HTTP\uff0c\u5927\u6982\u53ef\u4ee5\u7ffb\u8b6f\u6210\u300c\u57fa\u65bc HTTP \u4e0a\u7684\u52d5\u614b\u9069\u61c9\u4e32\u6d41\u300d\uff08\u901a\u5e38\u4e0d\u592a\u6703\u6709\u4eba\u9019\u6a23\u7a31\u547c\uff09\uff0c\u8ddf HLS \u4e00\u6a23\uff0c\u53ef\u4ee5\u7528\u5728\u76f4\u64ad/\u5f71\u7247/\u97f3\u8a0a\u7b49\u5404\u7a2e\u5a92\u9ad4\u61c9\u7528\u4e0a\u3002DASH \u662f\u4e00\u5957 MPEG \u516c\u958b\u6a19\u6e96\uff0c\u4e26\u4e14\u8207\u8a31\u591a\u7684\u8edf\u786c\u9ad4\u5ee0\u5546\u7d44\u6210\u4e00\u500b\u806f\u76df\u2014DASH IF\uff08DASH Industry Forum\uff09\uff0c\u6210\u54e1\u5305\u62ec Google\u3001\u5fae\u8edf\u3001SONY\u3001Intel\u3001Akamai\u2026\u7b49\uff08\u53c3\u898b DASH IF \u7684\u9801\u9762\uff09\u3002</p> <p>DASH \u4e5f\u662f\u76ee\u524d Google \u4e3b\u8981\u63a8\u5ee3\u7684\u4e32\u6d41\u6280\u8853\uff0c\u6211\u5011\u53ef\u4ee5\u770b\u5230 Google \u70ba Dash \u683c\u5f0f\u505a\u4e86\u8a31\u591a\u64ad\u653e\u8edf\u9ad4\u4ee5\u53ca\u76f8\u95dc\u5de5\u5177\uff0c\u800c Widevine \u4fbf\u662f Google \u7528\u4f86\u4fdd\u8b77 Dash \u683c\u5f0f\u5305\u88dd\u7684\u5167\u5bb9\u7684 DRM \u6a5f\u5236\uff0c\u7528\u5728 Chrome \u700f\u89bd\u5668\u3001Android \u884c\u52d5\u88dd\u7f6e\u8207 Android TV \u4e0a\u3002</p> <p>\u5f9e\u540d\u7a31\u4e0a\u5c31\u53ef\u4ee5\u770b\u51fa\uff0cDash \u8207 HLS \u76f8\u8fd1\uff0c\u4e5f\u662f\u4e00\u5957\u5efa\u7acb\u5728 HTTP \u7684\u57fa\u790e\u4e0a\uff0c\u5229\u7528 HTTP server \u7684\u80fd\u529b\u627f\u53d7\u5927\u91cf\u9023\u7dda\u8207\u6d41\u91cf\u3002\u6240\u4ee5\uff0c\u5728 Dash \u8207 HLS \u4e4b\u9593\uff0c\u96d6\u7136\u662f\u4e0d\u540c\u7684\u683c\u5f0f\uff0c\u4f46\u662f\u6709\u4e00\u4e9b\u89c0\u5ff5\u53ef\u4ee5\u4e92\u901a\uff1a\u4f8b\u5982\uff0cHLS \u7684 playlist \u6a94\u6848\u662f <code>.m3u8</code> \u6a94\u6848\uff0c\u5728 Dash \u4e2d\u53ef\u4ee5\u5c0d\u61c9\u5230 MPD\uff0c\u5728 HLS \u4e2d\uff0c\u5be6\u969b\u7684\u5f71\u97f3\u8cc7\u6599\u662f\u653e\u5728 TS \u6a94\u6848\u4e2d\uff0c\u5728 Dash \u4e2d\u5247\u4f7f\u7528 fMP4\uff08Fragmented MP4\uff09\u683c\u5f0f\u3002</p>"},{"location":"dash/#mpd","title":"MPD","text":"<p>\u64ad\u653e HLS \u7684\u6642\u5019\uff0c\u64ad\u653e\u5668\u8981\u5148\u8f09\u5165 <code>.m3u8</code> \u6a94\u6848\uff0c\u5728\u64ad\u653e Dash \u7684\u6642\u5019\uff0c\u5247\u8981\u8b93\u64ad\u653e\u5668\u8f09\u5165 MPD\uff0c\u5168\u540d\u662f Media Presentation Description\u3002</p> <p>MPD \u7684\u683c\u5f0f\u8207 <code>.m3u8</code> \u6709\u4e9b\u4e0d\u540c\uff0c <code>.m3u8</code> \u6a94\u6848\u662f\u4e00\u884c\u4e00\u884c\u5beb\u4e0b\u4f86\u7684\u6587\u5b57\u683c\u5f0f\uff0cMPD \u5247\u662f XML \u683c\u5f0f\uff0c\u7576\u4e2d\u8a18\u9304\u4e86\u9019\u500b\u4e32\u6d41\uff08\u5f71\u7247\u6216\u8072\u97f3\uff09\u7684\u57fa\u672c\u8cc7\u6599\uff0c\u4ee5\u53ca\u5be6\u969b\u4e0a\u8981\u8f09\u5165\u7684\u5a92\u9ad4\u8cc7\u6599\u4f4d\u7f6e\u3002</p> <p>\u5728 DASH-IF \u7db2\u7ad9\u4e0a\uff0c\u6709\u4e00\u4e9b\u6e2c\u8a66\u7528\u7684 MPD\uff0c\u53ef\u4ee5\u8b93\u6211\u5011\u4e86\u89e3 Dash \u898f\u683c\u3002\u6211\u5011\u4f86\u6253\u958b\u5176\u4e2d\u4e00\u500b\u770b\u770b\uff0c 48K AAC LC Stereo Beeps \u662f\u4e00\u500b\u53ea\u6703\u9023\u7e8c\u767c\u51fa\u4e00\u500b\u5c0f\u6642\u55f6\u55f6\u8072\u7684\u7d14 audio \u4e32\u6d41\uff0c\u7576\u4e2d\u5167\u5bb9\u662f\u9019\u6a23\u7684\uff1a</p> <pre><code>&lt;MPD xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"urn:mpeg:dash:schema:mpd:2011\" xsi:schemaLocation=\"urn:mpeg:dash:schema:mpd:2011 DASH-MPD.xsd\" profiles=\"urn:mpeg:dash:profile:isoff-live:2011,http://dashif.org/guidelines/dash-if-simple\" maxSegmentDuration=\"PT2S\" minBufferTime=\"PT2S\" type=\"static\" mediaPresentationDuration=\"PT1H\"&gt;\n   &lt;ProgramInformation&gt;\n      &lt;Title&gt;Media Presentation Description for audio only from DASH-IF live simulator&lt;/Title&gt;\n   &lt;/ProgramInformation&gt;\n   &lt;Period id=\"precambrian\" start=\"PT0S\"&gt;\n      &lt;AdaptationSet contentType=\"audio\" mimeType=\"audio/mp4\" lang=\"eng\" segmentAlignment=\"true\" startWithSAP=\"1\"&gt;\n         &lt;Role schemeIdUri=\"urn:mpeg:dash:role:2011\" value=\"main\"/&gt;\n         &lt;SegmentTemplate startNumber=\"1\" initialization=\"$RepresentationID$/init.mp4\" duration=\"2\" media=\"$RepresentationID$/$Number$.m4s\"/&gt;\n         &lt;Representation id=\"A48\" codecs=\"mp4a.40.2\" bandwidth=\"48000\" audioSamplingRate=\"48000\"&gt;\n            &lt;AudioChannelConfiguration schemeIdUri=\"urn:mpeg:dash:23003:3:audio_channel_configuration:2011\" value=\"2\"/&gt;\n         &lt;/Representation&gt;\n      &lt;/AdaptationSet&gt;\n   &lt;/Period&gt;\n&lt;/MPD&gt;\n</code></pre> <p>\u5728\u6a94\u6848\u7684\u958b\u982d\uff0c\u6211\u5011\u5148\u770b\u5230\u4e00\u5806 XML \u5ba3\u544a\u3002\u9019\u500b XML \u7684 root node \u662f <code>MPD</code>\uff0c\u7136\u5f8c XML \u7684 scheme \u4f4d\u5728\u54ea\u500b\u4f4d\u7f6e\u2026\u3002\u63a5\u4e0b\u4f86 <code>ProgramInformation</code> \u662f\u95dc\u65bc\u5167\u5bb9\u7684\u63cf\u8ff0\uff0c\u6211\u5011\u77e5\u9053\u9019\u500b\u5f71\u7247\u7684\u6a19\u984c\u662f\u300cMedia Presentation Description for audio only from DASH-IF live simulator\u300d\u3002</p> <p>\u7136\u5f8c\u662f <code>Period</code> \u8207 <code>AdaptationSet</code>\u3002<code>Period</code> \u8868\u793a\u7684\u662f\u9019\u500b\u7bc0\u76ee\u6709\u54ea\u4e9b\u6642\u9593\u5340\u6bb5\uff0c\u6bd4\u65b9\u8aaa\uff0c\u5982\u679c\u9019\u500b MPD \u8868\u793a\u7684\u662f\u4e00\u5834\u6f14\u5531\u6703\uff0c\u90a3\u9ebc\uff0c\u6211\u5011\u5c31\u53ef\u80fd\u6703\u7528\u4e0a\u591a\u500b <code>Period</code>\uff0c\u8868\u793a\u6f14\u5531\u6703\u7576\u4e2d\u6bcf\u4e00\u9996\u6b4c\u7684\u6642\u9593\u5340\u9593\u3002\u5728\u9019\u6bb5\u6642\u9593\u5167\uff0c\u53ef\u4ee5\u6709\u591a\u7a2e\u4e0d\u540c\u54c1\u8cea\uff08\u97f3\u8cea\u6216\u756b\u8cea\uff09\u7684\u5a92\u9ad4\u53ef\u4ee5\u9078\u7528\u2014\u6bd4\u65b9\u8aaa\uff0c\u5982\u679c\u662f\u5f71\u7247\u7684\u8a71\uff0c\u5c31\u53ef\u80fd\u6709 360p\u3001480p\u2026\u7b49\u7b49\u4e0d\u540c\u7684\u89e3\u6790\u5ea6\u2014\u64ad\u653e\u5668\u6703\u6839\u64da\u76ee\u524d\u7684\u7db2\u8def\u72c0\u6cc1\u9078\u64c7\u6700\u9069\u5408\u7684\u3002</p> <p><code>AdaptationSet</code> \u5c31\u4ee3\u8868\u4e00\u7d44\u53ef\u7528\u7684\u756b\u8cea/\u97f3\u8cea\uff0c\u76f8\u95dc\u7684\u6a94\u6848\u4f4d\u7f6e\u8207 codec \u8cc7\u8a0a\u2026\u7b49\u3002\u5728\u9019\u500b\u6a94\u6848\u4e2d\uff0c\u7531\u65bc\u53ea\u6709\u4e00\u7a2e\u97f3\u8cea\u7684\u8cc7\u6599\uff0c\u6240\u4ee5\u4e5f\u5c31\u53ea\u6709\u4e00\u7d44 <code>AdaptationSet</code>\uff0c\u5728\u6709\u591a\u7a2e\u54c1\u8cea\u53ef\u4ee5\u6311\u9078\u7684 MPD \u4e2d\uff0c\u5c31\u6703\u770b\u5230\u591a\u7d44 <code>AdaptationSet</code>\u3002</p> <p>\u5f9e <code>SegmentTemplate</code> \u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u770b\u5230\u97f3\u6a94\u7684 URL \u7684\u7d44\u5408\u898f\u5247\uff1a</p> <pre><code>&lt;SegmentTemplate startNumber=\"1\" initialization=\"$RepresentationID$/init.mp4\" duration=\"2\" media=\"$RepresentationID$/$Number$.m4s\"/&gt;\n</code></pre> <p>\u9019\u4ee3\u8868\uff0c\u6839\u64da <code>initialization</code> \u7576\u4e2d\u7684\u8cc7\u6599\uff0c\u6211\u5011\u61c9\u8a72\u9996\u5148\u8f09\u5165 init.mp4\uff0c\u7136\u5f8c\u6839\u64da\u7de8\u865f\uff08$Number$ \u662f\u4e00\u500b\u8b8a\u6578\uff0c\u662f\u5f9e 1 \u958b\u59cb\u7684\u4e00\u9023\u4e32\u6578\u5b57\uff09\u9010\u4e00\u8f09\u5165\u5f8c\u9762\u7684 m4s \u6a94\u6848\u3002\u5728\u7d44\u6210 URL \u7684\u6642\u5019\uff0c\u9996\u5148\u6839\u64da MPD \u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u627e\u51fa\u9019\u4e9b\u6a94\u6848\u61c9\u8a72\u6240\u5728\u7684\u6839\u76ee\u9304\u8def\u5f91\u3002</p> <ul> <li>\u9019\u500b MPD \u4f4d\u5728 <code>https://livesim.dashif.org/dash/vod/testpic_2s/audio.mpd</code></li> <li>\u6240\u4ee5\u9019\u4e9b\u6a94\u6848\u61c9\u8a72\u4f4d\u5728 <code>https://livesim.dashif.org/dash/vod/testpic_2s/</code> \u4e4b\u4e0b</li> <li>\u6211\u5011\u8981\u586b\u5165 <code>RepresentationID</code>\uff0c\u5f9e MPD \u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u9019\u908a\u7684 ID \u662f <code>A48</code>\uff0c\u6240\u4ee5\u518d\u628a\u9019\u6bb5\u52a0\u5230 URL \u4e0a\uff1a   <code>https://livesim.dashif.org/dash/vod/testpic_2s/A48/</code></li> <li>init.mp4 \u5c31\u4f4d\u5728 <code>https://livesim.dashif.org/dash/vod/testpic_2s/A48/init.mp4</code></li> <li>\u5f8c\u9762\u7684\u6a94\u6848\u898f\u5247\u5c31\u662f <code>https://livesim.dashif.org/dash/vod/testpic_2s/A48/1.mps</code>\uff0c\u4f9d\u6b64\u985e\u63a8</li> </ul>"},{"location":"dash/#fmp4","title":"fMP4","text":"<p>\u6211\u5011\u5728\u8b1b\u89e3 AAC \u683c\u5f0f\u7684\u6642\u5019\u63d0\u5230 MP4 \u683c\u5f0f\uff0c\u4e5f\u8b1b\u5230\u4e00\u500b\u55ae\u7368\u7684 MP4 \u7684\u6a94\u6848\uff0c\u88e1\u982d\u9700\u8981 <code>ftyp</code>\u3001<code>moov</code>\u3001<code>mdat</code> \u9019\u4e9b\u57fa\u672c\u7684 atoms\u3002</p> <p>\u5728 DASH \u4e2d\uff0c\u6211\u5011\u628a\u9019\u4e9b atom \u62c6\u958b\uff1ainit.mp4 \u7576\u4e2d\u5b58\u653e <code>moov</code>\uff0c$Number$.m4s \u88e1\u982d\u5247\u5b58\u653e <code>mdat</code> \u8cc7\u6599\uff0c\u6bcf\u500b m4s \u6a94\u6848\u662f\u628a <code>mdat</code> \u4e2d\u7684\u5f71\u7247\u8cc7\u6599\u6839\u64da\u4e00\u6bb5\u5b9a\u7fa9\u597d\u7684\u6642\u9593\u9577\u5ea6\u5207\u51fa\u4f86\u7684\u5c0f\u6a94\uff0c\u9019\u6a23\u7684\u5c0f\u6a94\u53eb\u505a fragment\u3002\u5728\u64ad\u653e\u7684\u6642\u5019\uff0c\u64ad\u653e\u5668\u9996\u5148\u6293\u53d6 <code>moov</code>\uff0c\u7136\u5f8c\u4e00\u6b21\u53c8\u4e00\u6b21\u628a\u9019\u6bb5 <code>moov</code> \u8207\u5f8c\u9762\u5f9e M4S \u6a94\u6848\u4e2d\u62ff\u5230\u7684 <code>mdat</code> \u7d50\u5408\u8d77\u4f86\u64ad\u653e\u3002init.mp4 \u8207 m4s \u6a94\u6848\u4e2d\u9084\u6709\u4e00\u4e9b\u5176\u4ed6\u7684 atoms\uff0c\u59d1\u4e14\u4e0d\u8868\u3002</p> <p>\u5728 init.mp4 \u4e2d\u7684 <code>moov</code> \u8cc7\u8a0a\uff1a</p> <p></p> <p>\u5728 M4S \u7576\u4e2d\u7684 <code>mdat</code> \u8cc7\u8a0a\uff1a</p> <p></p> <p>\u6211\u5011\u5728\u524d\u9762\u770b\u5230\u4f7f\u7528 <code>SegmentTemplate</code> \u7684\u7bc4\u4f8b\uff0c\u53e6\u5916\u4e00\u7a2e\u5b9a\u7fa9 m4s \u6a94\u6848\u4f4d\u7f6e\u7684\u4f5c\u6cd5\uff0c\u5247\u662f\u76f4\u63a5\u5168\u90e8\u5217\u51fa\u4f86\u3002\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u53ef\u4ee5\u770b\u4e00\u500b\u4f86\u81ea Wowza \u7684\u7bc4\u4f8b\uff0c\u9019\u500b MPD \u4f4d\u5728 <code>https://wowzaec2demo.streamlock.net/vod/elephantsdream_1100kbps-enc-wv.mp4/manifest_mvlist.mpd</code>\uff0c\u5c31\u5beb\u6210\uff1a</p> <pre><code>&lt;SegmentList presentationTimeOffset=\"0\" timescale=\"90000\" duration=\"900000\" startNumber=\"1\"&gt;\n    &lt;Initialization sourceURL=\"chunk_ctvideo_ridp0va0br994339_cinit_w1146251977_mpd.m4s\"/&gt;\n    &lt;SegmentURL media=\"chunk_ctvideo_ridp0va0br994339_cn1_w1146251977_mpd.m4s\"/&gt;\n    &lt;SegmentURL media=\"chunk_ctvideo_ridp0va0br994339_cn2_w1146251977_mpd.m4s\"/&gt;\n    &lt;SegmentURL media=\"chunk_ctvideo_ridp0va0br994339_cn3_w1146251977_mpd.m4s\"/&gt;\n    ...\n&lt;/SegmentList&gt;\n</code></pre>"},{"location":"dash/#fmp4_1","title":"\u9023\u7e8c\u7684 fMP4","text":"<p>\u53e6\u5916\u4e00\u7a2e\u5e38\u898b\u7684\u4f5c\u6cd5\uff0c\u5247\u662f\u4f7f\u7528 fMP4 \u683c\u5f0f\u7684\u6a94\u6848\u63d0\u4f9b\u5f71\u97f3\u8cc7\u6599\u3002</p> <p>\u56e0\u70ba\u6211\u5011\u5df2\u7d93\u770b\u904e\u524d\u9762\u7528 init.mp4 \u52a0\u4e0a\u4e00\u5806 M4S \u6a94\u6848\u7684\u4f8b\u5b50\uff0c\u6211\u5011\u65bc\u662f\u6bd4\u8f03\u5bb9\u6613\u7406\u89e3 fMP4 \u683c\u5f0f\uff1afMP4 \u5c31\u662f\u628a\u9019\u4e9b\u6a94\u6848\u5408\u4f75\u6210\u4e00\u500b\u5927\u6a94\u6848\u3002\u7136\u5f8c\uff0cMPD \u7576\u4e2d\u6703\u6a19\u660e\u6bcf\u500b\u5c0d\u61c9\u5230\u4e00\u500b M4S \u683c\u5f0f\u7684 byte range\uff0c\u64ad\u653e\u5668\u5728\u8f09\u5165 MPD \u4e4b\u5f8c\uff0c\u5148\u6293\u53d6 fMP4 \u7684\u958b\u982d\u90e8\u5206\uff08\u5c0d\u61c9\u5230\u6211\u5011\u7684 init.mp4\uff09\uff0c\u7136\u5f8c\uff0c\u6839\u64da MPD \u4e2d\u5b9a\u7fa9\u7684 byte range\uff0c\u900f\u904e\u5e36\u6709 Range HTTP header \u7684\u9023\u7dda\uff0c\u53ea\u6293\u53d6 fMP4 \u6a94\u6848\u4e2d\u60f3\u8981\u7684\u90e8\u4efd\u3002</p> <p>\u9019\u500b\u6a94\u6848\u7684\u8cc7\u6599\u5927\u6982\u50cf\u9019\u6a23\uff1a</p> <p></p> <p>\u6211\u5011\u53ef\u4ee5\u4f86\u770b\u770b YouTube \u4f7f\u7528\u7684 DASH \u6a94\u6848\u3002\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u5728 YouTube \u4e0a\uff0c\u6253\u958b\u4e00\u500b\u6211\u5011\u81ea\u5df1\u4e0a\u50b3\u7684\u9801\u9762\uff08\u5728\u9019\u908a\u7528\u7684\u662f\u6211\u5728 2019 \u5e74\u5beb\u7684\u4e00\u9996\u6b4c\u300a\u5343\u5343\u842c\u842c\u300b\uff09\uff0c\u7136\u5f8c\u67e5\u770b\u9801\u9762\u7684 HTML \u539f\u59cb\u6a94\uff0c\u5c31\u53ef\u4ee5\u627e\u5230 dashManifestUrl \u9019\u6bb5\uff1a</p> <p></p> <p>\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u77e5\u9053\uff0c\u9019\u90e8\u5f71\u7247\u7684 MPD \u4f4d\u5728 <code>https://r5---sn-ipoxu-un5k.googlevideo.com/videoplayback/expire/1584618105/...</code> \u3002\u6211\u5011\u53ef\u4ee5\u6253\u958b\u4f86\u770b\u770b\uff08\u4e0d\u904e\uff0c\u9019\u500b URL \u6709\u6548\u671f\uff0c\u4f60\u73fe\u5728\u9ede\u4e0b\u53bb\u61c9\u8a72\u6c92\u7528\uff09\uff1a</p> <p></p> <p>\u6211\u5011\u65bc\u662f\u53ef\u4ee5\u627e\u5230\uff1a\u9996\u5148\uff0c\u9019\u90e8\u5f71\u7247\u6709\u4e00\u6bb5\u8cc7\u6599\u683c\u5f0f\u662f <code>audio/mp4</code> \u7684 <code>AdaptationSet</code>\uff0c\u4ee3\u8868 YouTube \u5e6b\u6211\u5011\u628a\u5f71\u7247\u7684\u5716\u7247\u8ddf\u97f3\u8ecc\u62c6\u958b\u4f86\u4e86\uff0c\u9019\u908a\u6709\u4e00\u6bb5\u7368\u7acb\u7684\u97f3\u8ecc\uff0cURL \u4e5f\u662f\u4f4d\u5728 <code>https://r5---sn-ipoxu-un5k.googlevideo.com/videoplayback/expire/1584618105/...</code> \u4e0b\u65b9\uff1a</p> <p>\u7136\u5f8c\u662f\u9019\u5169\u6bb5\uff1a</p> <pre><code>&lt;SegmentList startNumber=\"0\" timescale=\"1000\"&gt;&lt;SegmentTimeline&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"9985\"/&gt;&lt;S d=\"9984\"/&gt;&lt;S d=\"7941\"/&gt;&lt;/SegmentTimeline&gt;&lt;/SegmentList&gt;\n</code></pre> <pre><code>&lt;SegmentList&gt;&lt;Initialization sourceURL=\"range/0-640\"/&gt;&lt;SegmentURL media=\"range/961-62378\"/&gt;&lt;SegmentURL media=\"range/62379-123214\"/&gt;&lt;SegmentURL media=\"range/123215-184180\"/&gt;&lt;SegmentURL media=\"range/184181-245118\"/&gt;&lt;SegmentURL media=\"range/245119-305980\"/&gt;&lt;SegmentURL media=\"range/305981-366726\"/&gt;&lt;SegmentURL media=\"range/366727-427627\"/&gt;&lt;SegmentURL media=\"range/427628-488601\"/&gt;&lt;SegmentURL media=\"range/488602-549420\"/&gt;&lt;SegmentURL media=\"range/549421-610280\"/&gt;&lt;SegmentURL media=\"range/610281-671202\"/&gt;&lt;SegmentURL media=\"range/671203-732053\"/&gt;&lt;SegmentURL media=\"range/732054-792887\"/&gt;&lt;SegmentURL media=\"range/792888-853681\"/&gt;&lt;SegmentURL media=\"range/853682-914615\"/&gt;&lt;SegmentURL media=\"range/914616-975451\"/&gt;&lt;SegmentURL media=\"range/975452-1036483\"/&gt;&lt;SegmentURL media=\"range/1036484-1097267\"/&gt;&lt;SegmentURL media=\"range/1097268-1158216\"/&gt;&lt;SegmentURL media=\"range/1158217-1219017\"/&gt;&lt;SegmentURL media=\"range/1219018-1279927\"/&gt;&lt;SegmentURL media=\"range/1279928-1340738\"/&gt;&lt;SegmentURL media=\"range/1340739-1401680\"/&gt;&lt;SegmentURL media=\"range/1401681-1449774\"/&gt;&lt;/SegmentList&gt;\n</code></pre> <p>\u5728 <code>SegmentTimeline</code> \u7576\u4e2d\uff0c\u5217\u51fa\u4e86\u9019\u500b\u97f3\u8ecc\u7576\u4e2d\u7684\u6642\u9593\u8ef8\uff0c\u6574\u500b\u97f3\u8ecc\u88ab\u5207\u6210 24 \u7684\u7247\u6bb5\uff0c\u6bcf\u500b <code>S</code> \u4ee3\u8868\u4e00\u500b\u7247\u6bb5\uff0c\u88e1\u982d\u7684 <code>d</code> \u5247\u662f\u9019\u500b\u7247\u6bb5\u7684 duration\uff0c\u6642\u9593\u55ae\u4f4d\u5247\u6839\u64da <code>SegmentTimeline</code> \u7576\u4e2d\u7684 <code>timescale</code>\u3002\u4ee5\u7b2c\u4e00\u500b <code>S</code> \u70ba\u4f8b\uff0c\u4ee3\u8868\u7684\u662f\u9019\u9996\u6b4c\u7684\u7b2c\u4e00\u500b\u6642\u9593\u5340\u9593\uff0c<code>d</code> \u70ba 9985\uff0c<code>timescale</code> \u70ba 1000\uff0c\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u7b97\u51fa\u662f 9.985 \u79d2\uff0c\u6574\u90e8\u5f71\u7247\u5927\u6982\u662f\u4ee5\u5341\u79d2\u9418\u70ba\u4e00\u500b\u5340\u9593\u5207\u6210\u5c0f\u7247\uff0c\u6700\u5f8c\u4e00\u500b <code>S</code> \u5c07\u8fd1\u516b\u79d2\uff0c\u6240\u4ee5\u5168\u90e8\u5927\u6982\u6709 238 \u79d2\uff083 \u5206 58 \u79d2\uff09\u3002</p> <p>\u6bcf\u500b <code>S</code> \u6703\u5c0d\u61c9\u5230 <code>SegmentList</code> \u88e1\u982d\u7684 <code>SegmentURL</code>\u3002SegmentList \u7b2c\u4e00\u6bb5 <code>Initialization</code> \u5c31\u4ee3\u8868\u6211\u5011\u4e4b\u524d\u8b1b\u5230\u7684 init.mp4 \u7684\u89d2\u8272\uff0c\u88e1\u982d\u5305\u542b <code>ftyp</code> \u8207 <code>moov</code> \u7b49 atoms\uff0c\u9019\u6bb5\u5728\u7b2c 0 \u5230\u7b2c 640 \u500b byte \u7684\u4f4d\u7f6e\uff0c\u5f8c\u9762\u6bcf\u500b <code>SegmentURL</code>\uff0c\u4e5f\u90fd\u4ee3\u8868\u9019\u500b\u5340\u6bb5\u5728\u6a94\u6848\u4e2d\u7684\u54ea\u500b byte \u5230\u54ea\u500b byte \u7684\u5340\u9593\u3002</p> <p>\u6240\u4ee5\uff0c\u5047\u5982\u6211\u5011\u5728\u64ad\u653e\u9019\u500b\u6a94\u6848\u7684\u6642\u5019\uff0c\u4e00\u958b\u59cb\u5c31\u60f3\u5f9e\u7b2c 15 \u79d2\u958b\u59cb\u64ad\u653e\uff0c\u6211\u5011\u5c31\u53ef\u4ee5\u7b97\u51fa\uff0c\u7b2c 15 \u79d2\u4f4d\u5728\u7b2c\u4e8c\u500b <code>S</code> \u5b9a\u7fa9\u7684\u5340\u6bb5\uff0c\u9019\u6642\u5019\u5c31\u53ea\u8981\u767c\u51fa\u5e36 Range header \u7684 HTTP \u9023\u7dda\uff0c\u5148\u6293\u53d6 0-640 \u7684 <code>ftyp</code> \u8207 <code>moov</code> \u7b49\u8cc7\u8a0a\uff0c\u518d\u76f4\u63a5\u53bb\u627e\u7b2c\u4e8c\u500b <code>S</code> \u7684\u7bc4\u570d 62379-123214\uff0c\u5728\u8f09\u5165\u9019\u6bb5\u6a94\u6848\u5f8c\uff0c\u56e0\u70ba\u7b2c\u4e8c\u500b <code>S</code> \u662f\u5f9e\u7b2c 10 \u79d2\u958b\u59cb\uff0c\u53ea\u8981\u518d seek \u4e94\u79d2\u9418\uff0c\u5c31\u53ef\u4ee5\u6210\u529f\u9054\u6210\u300c\u5f9e\u7b2c 15 \u79d2\u958b\u59cb\u64ad\u653e\u300d\u3002</p> <p>\u6211\u5011\u53ef\u4ee5\u6253\u958b\u9019\u500b\u6a94\u6848\u770b\u770b\uff1a</p> <p>\u5f9e 0-640\uff0c\u53ef\u4ee5\u770b\u5230 <code>ftyp</code> \u8207 <code>moov</code>\u3002</p> <p></p> <p>\u5f9e 62379 \u7684\u4e00\u6bb5 <code>mdat</code> \u8cc7\u6599\uff1a</p> <p></p>"},{"location":"dash/#mpeg-dash","title":"\u64ad\u653e MPEG-DASH \u4e32\u6d41","text":"<p>\u64ad\u653e MPEG-DASH \u4e32\u6d41\u7684\u6d41\u7a0b\u5927\u6982\u662f\uff1a</p> <ul> <li>\u6293\u53d6 MPD\uff0c\u4e26\u4e14\u89e3\u6790\u88e1\u982d\u7684 XML</li> <li>\u5f9e MPD \u4e2d\u5224\u65b7\u6709\u54ea\u4e9b <code>Period</code> \u8207 <code>AdaptationSet</code></li> <li>\u5f9e <code>AdaptationSet</code> \u4e2d\u6311\u9078\u6700\u9069\u5408\u76ee\u524d\u983b\u5bec\u7684\u5f71\u7247/\u97f3\u8ecc\u7684\u7d44\u5408</li> <li>\u5f9e <code>AdaptationSet</code> \u4e2d\u7d44\u5408\u51fa\u5be6\u969b\u7684 URL \u64ad\u653e</li> </ul> <p>DASH IF \u672c\u8eab\u63d0\u4f9b\u4e00\u5957 JavaScript \u64b0\u5beb\u7684\u64ad\u653e\u8edf\u9ad4 dash.js\uff0cGoogle \u9019\u5e7e\u5e74\u5728 Android \u5e73\u53f0\u4e0a\u81f4\u529b\u63a8\u5ee3\u7684 ExoPlayer \u4e5f\u652f\u63f4 DASH \u683c\u5f0f\uff0c\u53e6\u5916\u4e5f\u6709\u4e00\u5957\u5728\u7db2\u9801\u4e0a\u64ad\u653e DASH \u7684 Shaka Player\uff0cGoogle \u5728 Widevine SDK \u7684\u6587\u4ef6\u4e2d\uff0c\u5c31\u5efa\u8b70\u4f7f\u7528\u9019\u5169\u500b Player \u5143\u4ef6\u3002\u6b64\u5916\uff0c\u9084\u6709\u5404\u7a2e\u652f\u63f4 MPEG DASH \u7684\u5be6\u4f5c\uff0c\u5728\u9019\u908a\u4e0d\u4e00\u4e00\u5217\u8209\u3002</p> <p>\u5728 iOS app \u4e2d\u64ad\u653e DASH \u4e32\u6d41\u7684\u65b9\u5f0f\u6709\u9ede\u8fc2\u8ff4\u3002\u5728 iOS \u4e0a\u6211\u5011\u770b\u5230\u7684\u4e0d\u662f\u53ef\u4ee5\u76f4\u63a5\u64ad\u653e DASH \u7684\u64ad\u653e\u5143\u4ef6\uff0c\u800c\u662f\u628a DASH \u8f49\u6210 HLS\uff0c\u7136\u5f8c\u7528 AVPlayer \u64ad\u653e\u3002</p> <p>Google \u6709\u4e00\u5957\u53eb\u505a Universal DASH Transmuxer\uff08\u7c21\u7a31 UDT\uff09\u7684\u8edf\u9ad4\uff0c\u662f\u4e00\u5957 Open Source \u7684\u51fd\u5f0f\u5eab\uff0c\u5728 GitHub \u4e0a\u53ef\u4ee5\u53d6\u5f97\u7a0b\u5f0f\u78bc\uff0c\u88e1\u982d\u5c31\u662f\u5c07 DASH \u8f49\u63db\u6210 HLS \u7684\u76f8\u95dc\u5be6\u4f5c\uff0c\u81f3\u65bc\u5be6\u969b\u600e\u9ebc\u7528\uff0c\u9084\u662f\u5f97\u770b Google \u7684 Widevine iOS SDK\uff0c\u4f46\u9019\u90e8\u4efd\u6c92\u6709 Open Source\u3002</p> <p>\u57fa\u672c\u539f\u7406\u662f\uff1a</p> <ul> <li>\u5148\u5728 app \u4e2d\uff0c\u958b\u555f\u4e00\u500b local \u7684 HTTP server</li> <li>\u9019\u500b local HTTP server \u5728\u80cc\u5f8c\u6293\u53d6\u4e00\u500b\u6307\u5b9a\u7684 MPD</li> <li>\u89e3\u6790 MPD\uff0c\u628a\u88e1\u982d\u7684 <code>AdaptationSet</code> \u62bd\u53d6\u51fa\u4f86\uff0c\u8f49\u63db\u6210 <code>.m3u8</code> \u683c\u5f0f\u7684 playlist\uff0c\u6293\u53d6 fMP4 \u7684\u521d\u59cb\u5340\u6bb5</li> <li>\u5982\u679c\u662f\u53d7\u4fdd\u8b77\u7684 DASH \u4e32\u6d41\uff0c\u9019\u6642\u5019\u6703\u53bb\u6293\u53d6 license</li> <li>\u7576\u6709 player \u6307\u5b9a\u8981\u64ad\u653e\u67d0\u4e00\u6bb5\u7684 TS \u6642\uff0clocal http server \u5728\u6536\u5230\u8981\u6c42\u4e4b\u5f8c\uff0c\u518d\u6839\u64da\u4e4b\u524d\u53d6\u5f97\u7684 MPD\uff0c\u628a\u5c0d\u61c9\u7684 M4S \u6a94\u6848\u6293\u4e0b\u4f86\uff0c\u4e26\u4e14\u8f49\u63db\u6210 TS \u683c\u5f0f\u56de\u61c9</li> <li>\u5982\u6b64\u4e0d\u65b7\u8f2a\u8ff4</li> </ul>"},{"location":"dash/#widevine","title":"Widevine","text":"<p>Widevine \u4fdd\u8b77\u5167\u5bb9\u7684\u65b9\u5f0f\uff0c\u662f\u5c0d <code>mdat</code> atom \u4e2d\u7684\u8cc7\u6599\u52a0\u5bc6\u3002\u4e00\u500b\u53d7\u5230 Widevine \u4fdd\u8b77\u7684\u6a94\u6848\uff0c\u5916\u89c0\u4e0a\u9084\u662f\u53ef\u4ee5\u770b\u51fa\u662f\u4e00\u500b MP4 \u6a94\u6848\uff0c\u9084\u662f\u53ef\u4ee5\u89e3\u6790\u51fa <code>ftyp</code>\u3001<code>moov</code>\u3001<code>mdat</code> \u9019\u4e9b atom\uff0c\u64ad\u653e\u5668\u9700\u8981\u5148\u89e3\u6790\u51fa <code>mdat</code> \u5340\u6bb5\u7684\u8cc7\u6599\uff0c\u518d\u900f\u904e\u4e00\u4efd license \u4ee5\u53ca Google \u7684\u6f14\u7b97\u6cd5\uff0c\u628a\u88e1\u982d\u7684\u8cc7\u6599\u89e3\u5bc6\u56de\u4f86\u3002</p> <p>\u4e00\u500b\u53d7\u5230 Widevine \u4fdd\u8b77\u4e32\u6d41\u4e2d\uff0c\u6703\u5728 MPD \u7576\u4e2d\uff0c\u6bcf\u4e00\u6bb5 <code>AdaptationSet</code> \u4e2d\uff0c\u5305\u542b\u4e00\u6bb5 PSSH\uff08Protection System Specific Header\uff09\u8cc7\u8a0a\u3002\u6211\u5011\u53ef\u4ee5\u770b\u4e00\u500b\u4f86\u81ea Wowza \u7684 MPD\uff0c\u5c31\u53ef\u4ee5\u770b\u5230\u9019\u6bb5\uff1a</p> <pre><code>&lt;AdaptationSet id=\"0\" group=\"1\" mimeType=\"video/mp4\" width=\"512\" height=\"288\" par=\"16:9\" frameRate=\"30\" segmentAlignment=\"true\" startWithSAP=\"1\" subsegmentAlignment=\"true\" subsegmentStartsWithSAP=\"1\"&gt;\n    &lt;ContentProtection schemeIdUri=\"urn:mpeg:dash:mp4protection:2011\" value=\"cenc\" cenc:default_KID=\"0294B959-9D75-5DE2-BBF0-FDCA3FA5EAB7\"/&gt;\n    &lt;ContentProtection schemeIdUri=\"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed\" value=\"Widevine\"&gt;\n        &lt;cenc:pssh&gt;AAAAW3Bzc2gAAAAA7e+LqXnWSs6jyCfc1R0h7QAAADsIARIQApS5WZ11XeK78P3KP6XqtxoNd2lkZXZpbmVfdGVzdCIQZmtqM2xqYVNkZmFsa3IzaioCU0QyAA==&lt;/cenc:pssh&gt;\n    &lt;/ContentProtection&gt;\n    &lt;SegmentTemplate ....&gt; ... &lt;/SegmentTemplate&gt;\n    &lt;Representation id=\"p0va0br676240\" codecs=\"avc1.42c015\" sar=\"1:1\" bandwidth=\"676240\" /&gt;\n&lt;/AdaptationSet&gt;\n</code></pre> <p>\u5728 <code>&lt;cenc:pssh&gt;</code> \u6b04\u4f4d\u4e2d\uff0c\u5c31\u662f\u6211\u5011\u6240\u8981\u7684 PSSH \u8cc7\u8a0a\uff0cPSSH \u63a5\u8fd1\u6211\u5011\u5728 HLS \u88e1\u982d\u7528\u5230\u7684 Asset ID\u2014\u5728 HLS \u88e1\u982d\uff0c\u6211\u5011\u7528 Asset ID \u8207\u860b\u679c\u7c3d\u767c\u7684 certificate \u7522\u751f SPC\uff0c\u5728 Widevine \u88e1\u982d\uff0c\u6211\u5011\u4e5f\u7528 PSSH \u8207 CDM \u7522\u751f\u51fa\u4f86\u7684\u8cc7\u8a0a\uff0c\u7522\u751f\u6388\u6b0a\u9700\u6c42\uff0c\u4e0a\u50b3\u5230 server \u4e0a\u7522\u751f\u3001\u53d6\u5f97\u89e3\u5bc6\u7528\u7684 license\u3002</p> <p>CDM \u5168\u540d Content Decryption Module\uff0c\u5728\u884c\u52d5\u5e73\u53f0\u4e0a\uff0cCDM \u662f\u4e00\u5957\u7528 C++ \u5beb\u6210\u7684 library\uff0c\u5728\u6bcf\u7a2e\u5e73\u53f0\u4e0a CDM \u7684\u5c08\u5c6c\u8edf\u9ad4\u53eb\u505a CDM host\uff0cGoogle \u53ea\u6709\u7d66\u7b2c\u4e09\u65b9\u5ee0\u5546\u7de8\u8b6f\u597d\u7684 binary \u4ee5\u53ca certificate\u3002</p> <p>\u6211\u5011\u9996\u5148\u7528\u4e00\u4e9b\u57fa\u672c\u7684\u88dd\u7f6e\u8cc7\u8a0a\uff0c\u5c0d CDM host \u9032\u884c\u521d\u59cb\u8a71\uff0c\u7136\u5f8c\uff0c\u5728\u6293\u5230 PSSH \u4e4b\u5f8c\uff0c\u6211\u5011\u628a PSSH \u9001\u5230 CDM host \u4e0a\uff0cCDM host \u518d callback \u56de\u4f86\uff0c\u56de\u50b3 CDM \u7d44\u5408\u597d\u7684\u6191\u8b49\u9700\u6c42\u7684\u8cc7\u6599\uff0cCDM \u6703\u628a\u9019\u6bb5\u8cc7\u6599\uff0c\u9001\u5230\u6211\u5011\u7684\u4e00\u6bb5\u4ee3\u7406\u4eba\u7a0b\u5f0f\uff0d\u8853\u8a9e\u662f\u767c\u9001\uff08send\uff09\u4e00\u6bb5\u8a0a\u606f\uff08message\uff09\u2014\u6211\u5011\u5c31\u53ef\u4ee5\u628a\u9019\u6bb5\u8cc7\u6599\u50b3\u5230 Google \u7684 License Proxy \u4e3b\u6a5f\u4e0a\uff08\u50cf <code>https://license.widevine.com/getlicense/&lt;provider&gt;</code> \u9019\u6a23\u7684\u7db2\u5740\uff0c\u53c3\u898b Google \u6587\u4ef6\uff09\uff0c\u53d6\u5f97 license\u3002</p> <p>Google \u63d0\u4f9b\u7684\u6d41\u7a0b\u5716\u5982\u4e0b\uff0c\u518d\u77e5\u9053\u4e00\u4e9b\u5c08\u6709\u540d\u8a5e\u7684\u610f\u7fa9\u5f8c\uff0c\u6703\u6bd4\u8f03\u597d\u61c2\u3002\u9019\u4e00\u6bb5\u662f\u50b3\u9001 PSSH \u53d6\u5f97 license \u7684\u6d41\u7a0b</p> <p></p> <p>\u5728 Android \u4e0a\uff0cExoPlayer \u652f\u63f4 Widevine DRM\uff0c\u8a73\u60c5\u53ef\u4ee5\u53c3\u8003 ExoPlayer \u7684\u6587\u4ef6 Digital rights management\uff0c\u4e3b\u8981\u662f\u900f\u904e Android \u672c\u8eab\u7684 MediaDrm API \u7ba1\u7406 DRM\u3002</p> <p>\u5728 iOS \u4e0a\uff0c\u62ff\u5230 license \u4e4b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u70ba\u64ad\u653e\u5668\u6e96\u5099 HLS \u683c\u5f0f\u7684\u4e32\u6d41\uff1a</p> <p></p> <p>Web \u4e0a\uff0c\u9019\u6574\u5957\u53d6\u5f97 license \u7684\u6d41\u7a0b\uff0c\u88ab\u5305\u5728 EME \u88e1\u982d\uff0cGoogle \u6709\u4e00\u7bc7\u6587\u4ef6\u5c08\u9580\u4ecb\u7d39 EME\uff1aWhat is EME?\u3002\u81f3\u65bc\u64ad\u653e\u8edf\u9ad4\u65b9\u9762\uff0cGoogle \u4e5f\u4e00\u6a23\u63a8\u85a6\u7528 Shaka Player \u64ad\u653e Winevine \u4fdd\u8b77\u7684 Dash \u4e32\u6d41\u3002</p>"},{"location":"dash/#_1","title":"\u96e2\u7dda\u4e0b\u8f09","text":"<p>Widevine \u4e5f\u652f\u63f4\u96e2\u7dda\u64ad\u653e\u3002\u57fa\u672c\u4e0a\uff0c\u8981\u4e0b\u8f09\u4e00\u500b DASH \u683c\u5f0f\u7684\u4e32\u6d41\uff0c\u5c31\u662f\u5148\u6253\u958b MPD\u3001\u89e3\u6790\u88e1\u982d\u7684\u5167\u5bb9\uff0c\u7136\u5f8c\u6839\u64da <code>SegmentTemplate</code> \u6216 <code>SegmentList</code> \u627e\u5230\u5c0d\u61c9\u7684\u6a94\u6848\uff0c\u628a\u6240\u6709\u6a94\u6848\u4ee5\u53ca MPD \u5168\u90e8\u4e0b\u8f09\u56de\u4f86\uff0c\u7136\u5f8c\u5728\u672c\u5730\u7aef\u7dad\u6301\u76f8\u540c\u7684\u76ee\u9304\u7d50\u69cb\u5373\u53ef\u3002</p> <p>\u5728\u64ad\u653e\u96e2\u7dda\u6a94\u6848\u4e4b\u524d\uff0c\u4e00\u6a23\u8981\u4e00\u4efd license\uff0c\u53d6\u5f97 license \u7684\u6d41\u7a0b\u8207\u7dda\u4e0a\u64ad\u653e\u7684\u6d41\u7a0b\u4e00\u6a21\u4e00\u6a23\uff0c\u4e0d\u904e\uff0c\u9700\u8981\u984d\u5916\u8ddf\u544a\u8a34 CDM \u6211\u5011\u8981\u7684\u662f\u96e2\u7dda\u7528\u7684 license\u3002\u53d6\u5f97 license \u4e4b\u5f8c\u8981\u81ea\u5df1\u5728\u672c\u6a5f\u5b58\u653e\u8d77\u4f86\uff0c\u4e26\u4e14\u6ce8\u610f\u9019\u4efd license \u7684\u671f\u9650\u662f\u5426\u904e\u671f\u2014CDM \u4e2d\u6709\u76f8\u95dc\u7684 function\uff0c\u53ef\u4ee5\u6aa2\u67e5 license \u7684\u5230\u671f\u6642\u9593\uff0c\u4e0d\u904e\u7528\u6236\u4f3c\u4e4e\u53ef\u4ee5\u628a\u7cfb\u7d71\u6642\u9593\u6539\u5230\u904e\u53bb\uff0c\u9019\u9ede\u6211\u5011\u9084\u6c92\u6709\u7814\u7a76\u5f97\u5f88\u6df1\u3002</p>"},{"location":"dash/#ios-widevine-dash","title":"\u5728 iOS \u4e0a\u64ad\u653e Widevine \u4fdd\u8b77\u7684 DASH \u4e32\u6d41","text":"<p>\u524d\u9762\u63d0\u5230\uff0c\u5728 iOS \u4e0a\u64ad\u653e Dash \u6642\uff0c\u6703\u5728\u4e2d\u9593\u900f\u904e UDT \u8f49\u63db\u6210 HLS \u64ad\u653e\uff0c\u800c\u5982\u679c\u7528 Widevine \u7684 iOS SDK \u64ad\u653e\uff0c\u8f49\u63db\u51fa\u7684 HLS\uff0c\u6703\u53e6\u5916\u91cd\u65b0\u52a0\u5bc6\u3002iOS \u7248\u672c\u7684 Widevine DRM \u88e1\u982d\u4e5f\u6709\u4e00\u4efd UDT\uff0c\u4f46\u9019\u4efd UDT \u8ddf\u958b\u653e\u539f\u59cb\u78bc\u7248\u672c\u7684 UDT \u4e0d\u540c\uff0c\u4e2d\u9593\u52a0\u4e0a\u4e86\u91cd\u65b0\u52a0\u5bc6\u9019\u6bb5\uff0c\u800c\u4e14 Google \u4e5f\u53ea\u6709\u63d0\u4f9b\u6211\u5011 binary \u7248\u672c\u3002</p>"},{"location":"flac/","title":"FLAC \u683c\u5f0f","text":"<p>FLAC \u5168\u540d\u70ba Free Loseless Audio Codec\uff0c\u662f\u7531 Xiph.org \u5f9e 2001 \u5e74\u767c\u5c55\u8fc4\u4eca\u7684\u958b\u653e\u7121\u640d\u97f3\u8a0a\u683c\u5f0f\u3002\u76f8\u5c0d\u65bc MP3 \u9019\u4e9b\u7834\u58de\u6027\u58d3\u7e2e\u683c\u5f0f\uff0c\u6240\u8b02\u7684\u7121\u640d\uff08loseless\uff09\uff0c\u5c31\u662f\u5728\u58d3\u7e2e\u7684\u904e\u7a0b\u4e2d\u4e26\u6c92\u6709\u7834\u58de\uff0c\u6211\u5011\u5c07 PCM \u683c\u5f0f\u8f49\u63db\u6210 FLAC \u683c\u5f0f\u4e4b\u5f8c\uff0c\u4ecd\u7136\u53ef\u4ee5\u5c07 FLAC \u8f49\u63db\u56de\u539f\u672c\u7684 PCM \u683c\u5f0f\u3002\u8a31\u591a\u5e73\u53f0\u4e0a\u90fd\u5167\u5efa\u4e86 FLAC codec\uff0c\u6b64\u5916\uff0c\u6211\u5011\u4e5f\u53ef\u4ee5\u5728\u7db2\u8def\u4e0a\uff0c\u627e\u5230 FLAC \u7684\u7a0b\u5f0f\u78bc\uff0c\u6574\u5408\u5230\u6211\u5011\u7684\u7522\u54c1\u4e2d\u3002</p> <p>FLAC \u9664\u4e86\u662f\u4e00\u7a2e codec \u4e4b\u5916\uff0c\u672c\u8eab\u6709\u4e00\u5957\u81ea\u5df1\u7684 container \u683c\u5f0f\uff0c\u4f7f\u7528\u9019\u7a2e\u683c\u5f0f\u7684 FLAC\uff0c\u53eb\u505a plain FLAC\uff0c\u901a\u5e38\u9644\u6a94\u540d\u662f <code>.flac</code> \u7684\u6a94\u6848\uff0c\u5c31\u662f\u9019\u7a2e\u3002\u53e6\u5916\uff0c\u4e5f\u5f88\u5e38\u898b\u5230\u5c07 FLAC \u8cc7\u6599\u5305\u88dd\u5230 OGG container \u4e2d\uff0c\u9019\u6a23\u7684\u6a94\u6848\u53eb\u505a Ogg FLAC\uff0cXiph.org \u4e5f\u63d0\u4f9b\u89e3\u6790\u3001\u64ad\u653e Ogg FLAC \u7684\u5de5\u5177\u3002</p> <p>\u5728 iOS/macOS \u4e0a\uff0ciOS 11 \u8207 macOS 10.13 \u958b\u59cb\u76f4\u63a5\u5167\u5efa FLAC codec\uff0c\u5982\u679c\u662f\u66f4\u65e9\u7684\u4f5c\u696d\u7cfb\u7d71\uff0c\u5c31\u5f97\u8981\u81ea\u5df1\u628a libFlac \u6253\u5305\u5230\u61c9\u7528\u7a0b\u5f0f\u4e2d\u3002</p>"},{"location":"flac/#plain-flac-container","title":"Plain FLAC Container","text":"<p>\u6839\u64da FLAC \u898f\u683c\uff0c\u4e00\u500b FLAC \u6a94\u6848\u662f\u7531\u4ee5\u4e0b\u6210\u5206\u6240\u7d44\u6210\uff1a</p> <ul> <li>FLAC \u6a94\u6848\u7684\u524d\u56db\u500b bytes\uff0c\u662f \"fLaC\" \u56db\u500b\u5b57\u5143\u3002</li> <li>\u5728 \"fLaC\" \u56db\u500b\u5b57\u5143\u4e4b\u5f8c\uff0c\u6703\u6709\u591a\u500b metadata block \u7d44\u6210\uff0c\u9019\u4e9b metadata block \u53ef\u4ee5\u4efb\u610f\u6539\u8b8a\u9806\u5e8f\uff0c\u4f46\u662f\u9700\u8981\u6a19\u793a\uff0c\u54ea\u4e00\u500b metadata block \u662f\u6700\u5f8c\u4e00\u500b block\u3002\u9019\u4e9b block \u7684\u7a2e\u985e\u5305\u62ec</li> <li>Stream info\uff1a\u5305\u62ec\u50cf\u662f sample rate \u7b49\u7528\u4f86\u8b93 player \u89e3\u6790\u5f8c\u9762 data frame block \u7684\u8cc7\u8a0a\uff0c\u4e00\u5b9a\u8981\u6709\u9019\u4e00\u6bb5\u3002\u4ee3\u865f 0\u3002</li> <li>Cue sheet\uff1a\u6f14\u51fa\u8868\uff0c\u5305\u62ec\u6b4c\u540d\u3001\u5c08\u8f2f\uff0c\u4ee5\u53ca\u6709\u54ea\u4e9b\u6b4c\u624b\u5728\u7576\u4e2d\u6f14\u51fa\u3002\u975e\u5fc5\u8981\u3002\u4ee3\u865f 5\u3002</li> <li>Vorbis comment\uff1a\u4e00\u4e9b\u8a3b\u89e3\u6b04\u4f4d\u3002\u975e\u5fc5\u8981\u3002\u4ee3\u865f 4\u3002</li> <li>Application\uff1a\u6a19\u793a\u9019\u500b FLAC \u6a94\u6848\u662f\u7531\u54ea\u500b\u61c9\u7528\u7a0b\u5f0f\u88fd\u4f5c\u7684\u3002\u975e\u5fc5\u8981\u3002\u4ee3\u865f 2\u3002</li> <li>Picture\uff1a\u5c01\u9762\u5716\u7247\u3002\u975e\u5fc5\u8981\u3002\u4ee3\u865f 6\u3002</li> <li>Seektable\uff1a\u5c31\u662f\u5728 frame block \u5340\u6bb5\u7684\u6bcf\u500b block \u7684 offset\uff0c\u65b9\u4fbf client \u627e\u5230 offset \u6642\uff0c\u53ef\u4ee5\u5feb\u901f seek \u5230\u6307\u5b9a\u5340\u6bb5\uff0c\u50cf\u662f\u6211\u5011\u5728\u4ecb\u7d39 MP4 \u683c\u5f0f\u6642\u8b1b\u5230\u7684 <code>stsz</code>\u3001<code>stco</code> \u7684\u7528\u9014\u3002\u975e\u5fc5\u8981\u3002\u4ee3\u865f 3\u3002</li> <li>Padding\uff1a\u4e00\u4e9b\u7528\u4f86\u88dc\u8db3\u9577\u5ea6\u7528\u7684\u7a7a\u8cc7\u6599\u3002\u975e\u5fc5\u8981\u3002\u4ee3\u865f 1\u3002</li> <li>Frame Block\uff1a\u57fa\u672c\u4e0a\uff0c\u96d6\u7136\u8aaa\u7528\u8a5e\u4e0d\u540c\uff0c\u4f46\u4e5f\u5c31\u662f\u6211\u5011\u5728\u524d\u9762\u6240\u8aaa\u7684 packet\u3002Frame block \u662f\u7531 frame header\u3001footer \u8207 subframe \u7d44\u6210\uff0c\u5728 frame header \u7684\u958b\u982d\u4e00\u6a23\u6709 syncword\uff0csyncword \u7e3d\u5171 14 \u7684 bit\uff0c\u70ba \"11111111111110\"\u3002\u6bcf\u500b FLAC \u6a94\u6848\u4e2d\u7684 frame block \u7684\u5927\u5c0f\u53ef\u80fd\u662f\u4e0d\u540c\u7684\uff0c\u8981\u6839\u64da Stream info \u7576\u4e2d\u7684\u5167\u5bb9\uff0c\u624d\u6709\u8fa6\u6cd5\u77e5\u9053\u9019\u500b\u6a94\u6848\u4e2d\u6bcf\u500b frame block \u7684\u5927\u5c0f\u70ba\u4f55\u3002</li> </ul> <p>\u6240\u4ee5\u4e00\u500b FLAC \u6a94\u6848\u4e2d\u7684\u8cc7\u6599\u5927\u6982\u5982\u4e0b\u5716\uff1a</p> <p></p>"},{"location":"flac/#flac_1","title":"\u5be6\u4f5c FLAC \u6a94\u6848\u7684\u5206\u6bb5\u8f09\u5165","text":"<p>\u56e0\u70ba FLAC \u683c\u5f0f\u4e00\u6a23\u662f\u7531\u9023\u7e8c\u7684 packet \u7d44\u6210\uff0c\u6240\u4ee5\u6211\u5011\u9084\u662f\u53ef\u4ee5\u5f9e\u4e00\u500b FLAC \u6a94\u6848\u7684\u4e2d\u9593\u958b\u59cb\u6293\u53d6\u3001\u64ad\u653e\uff0c\u6211\u5011\u4e5f\u53ef\u4ee5\u770b\u5230\u6709 FLAC \u683c\u5f0f\u7684\u9ad8\u97f3\u8cea\u7db2\u8def\u5ee3\u64ad\u96fb\u53f0\u3002\u4e0d\u904e\uff0c\u8981\u80fd\u5920\u64ad\u653e\u5c40\u90e8\u7684 FLAC \u8cc7\u6599\uff0c\u6211\u5011\u9084\u662f\u8981\u88dc\u4e0a\u6700\u524d\u65b9\u7684 \"fLaC\" \u56db\u500b\u5b57\u5143\uff0c\u4ee5\u53ca\u6700\u5c11\u4e00\u500b metadata block\uff1astream info\u3002</p> <p>\u60f3\u8981\u63d0\u4f9b\u7d66 player \u4e00\u6bb5 stream info\uff0c\u6211\u5011\u5927\u6982\u6709\u5e7e\u7a2e\u65b9\u5f0f\uff1a1. \u767c\u9001\u591a\u500b\u9023\u7dda\uff0c\u5148\u6293\u53d6 FLAC \u6a94\u6848\u6700\u524d\u65b9\u4e00\u5b9a\u6578\u91cf\u7684\u8cc7\u6599\uff0c\u7136\u5f8c\u4e1f\u7d66 player \u89e3\u6790\u3001\u64ad\u653e\uff0c\u4e0d\u904e\uff0c\u7531\u65bc metadata block \u4e26\u4e0d\u4fdd\u8b49\u9806\u5e8f\uff0c\u6240\u4ee5\u6211\u5011\u5176\u5be6\u7121\u6cd5\u6b63\u78ba\u9810\u671f stream info \u4e00\u5b9a\u4f4d\u5728\u6211\u5011\u6240\u6293\u53d6\u7684\u7bc4\u570d\u5167\u3002\uff1b2. \u81ea\u5df1\u7522\u751f stream info \u5340\u6bb5\u7684\u8cc7\u6599\uff0c\u4e0d\u904e\uff0c\u6211\u5011\u4e5f\u4e0d\u898b\u5f97\u53ef\u4ee5\u4fdd\u8b49\uff0c\u9019\u500b FLAC \u6a94\u6848\u7684\u683c\u5f0f\uff0c\u4e00\u5b9a\u53ef\u4ee5\u7b26\u5408\u6211\u5011\u7684\u9810\u671f\u3002</p> <p>\u5982\u679c\u6211\u5011\u60f3\u8981\u81ea\u5df1\u7522\u751f stream info\uff0c\u5c31\u5f97\u4f86\u4e86\u89e3\u9019\u6bb5\u8cc7\u6599\u7684\u683c\u5f0f\uff1astream info \u7684\u9577\u5ea6\u70ba 34 \u500b byte\uff0c\u88e1\u982d\u7684\u6578\u5b57\u4f7f\u7528 Big endian \u6574\u6578\u3002\u5305\u62ec\uff1a</p> <ul> <li>The minimum block siz (in samples) \uff0c16 bits\uff0c\u5fc5\u586b</li> <li>The maximum block size (in samples) \uff0c16 bits\uff0c\u5fc5\u586b</li> <li>The minimum frame size (in bytes) \uff0c24 bits\uff0c\u53ef\u586b\u96f6</li> <li>The maximum frame size (in bytes)\uff0c24 bits\uff0c\u53ef\u586b\u96f6</li> <li>Sample Rate\uff0c20 bits\uff0c\u5fc5\u586b</li> <li>\u8072\u9053\u6578 -1\uff0cFLAC \u6700\u591a\u53ef\u4ee5\u652f\u63f4 8 \u500b\u8072\u9053\uff0c3 bits\uff0c\u5fc5\u586b</li> <li>\u6bcf\u500b\u8072\u9053\u6240\u7528 bits \u6578 -1\uff0c\u53ef\u70ba 4-32\uff0c5 bits\uff0c\u5fc5\u586b</li> <li>\u6574\u500b\u6a94\u6848\u7684 Sample \u6578\u91cf\uff0c36 bits\uff0c\u53ef\u586b\u96f6</li> <li>MD5 checksum\uff0c128 bits\uff0c\u53ef\u586b\u96f6</li> </ul> <p>\u5728 34 \u500b bytes \u7684\u524d\u9762\uff0c\u6211\u5011\u9084\u8981\u7528\u4e00\u500b byte \u8868\u793a\u9019\u662f\u4e00\u500b metadata block\uff0c\u5176\u4e2d\u7b2c\u4e00\u500b bit \u8868\u793a\u9019\u662f\u4e0d\u662f\u6700\u5f8c\u4e00\u500b metadata block\uff0c\u65e2\u7136\u6211\u5011\u53ea\u60f3\u8981\u4e00\u500b metadata block\uff0c\u90a3\u5c31\u586b 1\uff0c\u5269\u4e0b\u4e03\u500b bits \u5247\u7528\u4f86\u8868\u793a metadata block \u7684\u7a2e\u985e\uff0cstream info \u7684\u4ee3\u865f\u70ba 0\uff0c\u6240\u4ee5\u6211\u5011\u5c31\u586b\u5165 \"10000000\"\u3002\u52a0\u4e0a \"fLaC\" \u56db\u500b bytes\uff0c\u6211\u5011\u7e3d\u5171\u8981\u7522\u751f 39 \u500b bytes \u7684\u8cc7\u6599\u3002</p> <p>\u6211\u5011\u53ef\u4ee5\u5be6\u969b\u6253\u958b\u4e00\u500b FLAC \u6a94\u6848\u770b\u770b\uff1a</p> <p></p> <p>\u6211\u5011\u53ef\u4ee5\u770b\u5230\uff0c\u6a94\u6848\u958b\u59cb\u7684\u524d 4 \u500b bytes\uff0c\u5c31\u662f \"fLaC\" \u56db\u500b\u5b57\uff0c\u7b2c\u4e94\u500b byte \u70ba 0\uff1a\u7b2c\u4e00\u500b bit \u662f 0\uff0c\u4ee3\u8868\u5f8c\u9762\u9084\u6709\u5176\u4ed6\u7684 metadata block\uff0c\u53e6\u5916 7 \u500b bits \u4e5f\u662f 0\uff0c\u4ee3\u8868\u9019\u6bb5\u662f stream info\uff0c\u7136\u5f8c\u5c31\u662f 34 \u500b bytes \u7684 stream info \u7684\u5167\u5bb9\uff08\u5716\u7247\u4e2d\u88ab\u9078\u53d6\u8d77\u4f86\u7684\u5730\u65b9\uff09\u2014\u4e0d\u904e\uff0c\u6211\u5011\u5c31\u5f97\u8981\u8b80\u51fa\u6bcf\u500b bits\uff0c\u624d\u80fd\u4e86\u89e3\u7576\u4e2d\u7684\u610f\u7fa9\u4e86\u3002\u81f3\u65bc stream info \u4e4b\u5f8c\uff0c\u662f\u7b2c\u4e8c\u500b metadata block\uff0c\u6211\u5011\u53ef\u4ee5\u5224\u65b7\u51fa\uff0c\u9019\u908a\u653e\u4e86\u4e00\u5f35\u5c01\u9762\u5716\u7247\u3002</p>"},{"location":"flac/#flac_2","title":"FLAC \u7db2\u8def\u5ee3\u64ad\u96fb\u53f0","text":"<p>\u524d\u9762\u63d0\u5230\uff0c\u7db2\u8def\u4e0a\u6709\u4f7f\u7528 MP3 \u683c\u5f0f\u7684\u7db2\u8def\u5ee3\u64ad\u96fb\u53f0\uff0c\u800c\u7528\u6236\u53ef\u4ee5\u96a8\u6642\u6293\u5230\u4e00\u6bb5\u8cc7\u6599\u5c31\u53ef\u4ee5\u958b\u59cb\u64ad\u653e\uff0c\u662f\u56e0\u70ba\u627e\u5230 syncword \u4e4b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u89e3\u6790\u51fa packet\uff0c\u800c AAC \u683c\u5f0f\u7684\u7db2\u8def\u5ee3\u64ad\u96fb\u53f0\uff0c\u5247\u662f\u4f7f\u7528 AAC ADTS container \u683c\u5f0f\u3002\u90a3\uff0cFLAC \u683c\u5f0f\u5462\uff1f</p> <p>FLAC \u683c\u5f0f\u7684\u9ad8\u97f3\u8cea\u7db2\u8def\u5ee3\u64ad\u96fb\u53f0\uff0c\u5176\u5be6\u4e26\u6c92\u6709\u7528\u5230\u6211\u5011\u524d\u9762\u63d0\u5230\u7684\u9019\u4e9b\u81ea\u5df1\u7522\u751f FLAC \u6a94\u982d\u7684\u76f8\u95dc\u5de5\u4f5c\u3002\u6211\u5011\u53ef\u4ee5\u770b\u5230\u7684 FLAC \u7db2\u8def\u5ee3\u64ad\uff0c\u5927\u6982\u90fd\u88ab\u5305\u88dd\u5728 OGG container \u88e1\u982d\uff0c\u800c\u9019\u7a2e\u7db2\u8def\u5ee3\u64ad\u7684 server \u8edf\u9ad4\uff0c\u50cf\u662f icecast\uff0c\u5728 client \u7aef\u9023\u4e0a\u6642\uff0c\u5c31\u6703\u56de\u61c9 OGG \u7684\u6a94\u982d\uff0c\u8b93 client \u7aef\u77e5\u9053\u5982\u4f55\u89e3\u6790\u63a5\u4e0b\u4f86\u62ff\u5230\u7684\u8cc7\u6599\u3002</p>"},{"location":"hls/","title":"HLS \u8207 FairPlay DRM","text":"<p>HLS \u5168\u540d\u662f HTTP Live Streaming\uff0c\u662f\u860b\u679c\u5728 2009 \u5e74\u6642\u6240\u63a8\u51fa\u7684\u7db2\u8def\u76f4\u64ad\u6280\u8853\u2014\u8ddf\u524d\u9762\u63d0\u5230\u7684 MP4 \u683c\u5f0f\u4e00\u6a23\uff0cHLS \u4e5f\u4e0d\u662f\u53ea\u7528\u5728\u8ddf\u8072\u97f3\u6709\u95dc\u7684\u61c9\u7528\uff0c\u6211\u5011\u4e0d\u592a\u61c9\u8a72\u628a HLS \u7576\u6210\u662f\u4e00\u7a2e\u97f3\u6a94\uff0c\u53ea\u662f HLS \u7684\u61c9\u7528\u7bc4\u570d\u4e5f\u5305\u62ec\u8072\u97f3\u7684\u4e32\u6d41\u3002</p> <p>HLS \u5728 21 \u4e16\u7d00\u7b2c\u4e00\u500b\u5341\u5e74\u5feb\u8981\u7d50\u675f\u7684\u6642\u5019\u63a8\u51fa\uff0c\u6700\u5927\u7684\u610f\u7fa9\u5c31\u662f\uff0cHLS \u6280\u8853\u4e00\u53e3\u6c23\u64f4\u5145\u4e86\u4e00\u5834\u7db2\u8def\u5f71\u7247\u76f4\u64ad\u7684\u540c\u6642\u4eba\u6578\u4e0a\u9650\u3002HLS \u4ee5\u53ca\u5f8c\u4f86\u6240\u63a8\u51fa\u7684\u5404\u7a2e\u65b0\u683c\u5f0f\uff0c\u50cf\u662f MPEG-DASH \u7b49\uff0c\u8b93\u6211\u5011\u73fe\u5728\u6240\u7fd2\u6163\u7684\u842c\u4eba\u540c\u6642\u89c0\u770b\u76f4\u64ad\uff0c\u6210\u70ba\u53ef\u80fd\u3002</p> <p>\u5728 HLS \u63a8\u51fa\u4e4b\u524d\uff0c\u5728\u4e8c\u5341\u4e00\u4e16\u7d00\u7684\u7b2c\u4e00\u500b\u5341\u5e74\uff0c\u4e3b\u6d41\u7684\u5f71\u7247\u76f4\u64ad\u6280\u8853\u5927\u6982\u662f Windows Media Server\u3001Adobe Media Server \u7b49\uff0c\u9019\u4e9b\u6280\u8853\u7684\u6700\u5927\u5171\u901a\u6027\uff0c\u662f\u8b93\u64ad\u653e\u5f71\u7247\u76f4\u64ad\u7684 client \u8207 server \u4e4b\u9593\u5efa\u7acb socket \u9023\u7dda\uff0c\u4e2d\u9593\u4f7f\u7528\u50cf\u662f MMS\u3001RTMP\u3001RTSP \u2026\u7b49\u5354\u5b9a\u6e9d\u901a\uff0cserver \u4e0d\u65b7\u628a\u6700\u65b0\u7684\u5f71\u97f3\u8cc7\u6599\u63a8\u9001\u5230\u5404\u500b client \u7aef\uff0c\u800c\u55ae\u4e00 server \u80fd\u5920\u63a5\u53d7\u7684\u7db2\u8def\u9023\u7dda\u662f\u6709\u9650\u7684\uff0c\u6240\u4ee5\uff0c\u4e00\u5834\u7db2\u8def\u5f71\u7247\u76f4\u64ad\uff0c\u6700\u591a\u5927\u6982\u4e0a\u767e\u4eba\u540c\u6642\u89c0\u770b\uff0c\u5c31\u5df2\u7d93\u5230\u9054\u6975\u9650\u3002</p> <p>HLS \u6539\u8b8a client/server \u4e4b\u9593\u5efa\u7acb socket \u9023\u7dda\u7684\u67b6\u69cb\uff0c\u5f9e HLS \u7684\u540d\u7a31\u5c31\u53ef\u4ee5\u770b\u51fa\uff0c\u5229\u7528 HTTP \u6280\u8853\u89e3\u6c7a\u4eba\u6578\u4e0a\u9650\u554f\u984c\u3002\u5728\u76f4\u64ad\u8a0a\u6e90\u8207\u773e\u591a\u89c0\u770b\u76f4\u64ad\u7684 client \u4e4b\u9593\uff0c\u591a\u4e86\u5e7e\u500b\u6b65\u9a5f\uff1a\u9996\u5148\u76f4\u64ad\u8a0a\u6e90\u6703\u5c07\u8cc7\u6599\u7de8\u78bc\u6210 fMP4 \uff08\u6211\u5011\u5728\u4e0b\u4e00\u7ae0\u8a0e\u8ad6\uff09\u683c\u5f0f\u4e4b\u5f8c\uff0c\u9001\u5230\u4e00\u53f0\u4e3b\u6a5f\u4e0a\uff0c\u9019\u53f0\u4e3b\u6a5f\u6703\u628a\u6bcf\u9694\u4e00\u6bb5\u6642\u9593\uff08\u6bd4\u65b9\u8aaa\uff0c\u6bcf\u9694 5 \u79d2\u300110 \u79d2\u2026\uff09\u7684\u5f71\u7247\uff0c\u8f49\u6210\u4e00\u500b\u5c0f\u6a94\u6848\u2014\u9019\u7a2e\u5c07\u9023\u7e8c\u7684\u8cc7\u6599\u8b8a\u6210\u4e00\u500b\u500b\u8cc7\u6599\u5207\u7247\u7684\u7a0b\u5f0f\uff0c\u6211\u5011\u53eb\u505a segmenter\uff0c\u6bcf\u500b\u88ab\u5207\u51fa\u4f86\u7684\u5c0f\u6a94\u6848\u53eb\u505a ts\uff08MPEG Transport Stream\uff0c\u4e5f\u662f\u4e00\u7a2e\u5c01\u88dd\u683c\u5f0f\uff0c\u56e0\u70ba\u6211\u5011\u4e0d\u592a\u6703\u53bb\u89e3\u6790\u9019\u5957\u683c\u5f0f\uff0c\u5c31\u4e0d\u89e3\u91cb\u4e86\uff09\uff0c\u9019\u4e9b\u88ab\u5207\u51fa\u4f86\u7684\u5c0f\u6a94\u6848\u6703\u88ab\u4f48\u7f72\u5230 CDN \u4e0a\uff0c\u53e6\u5916\u7522\u751f\u4e00\u500b\u6587\u5b57\u6a94\uff0c\u9644\u6a94\u540d\u662f <code>.m3u8</code>\uff0c\u662f\u9019\u4e9b\u5c0f\u6a94\u6848\u7684 playlist\uff0c\u6307\u793a client \u5982\u4f55\u64ad\u653e\u9019\u4e9b ts\uff0c\u800c\u7576\u6709\u65b0\u7684 ts \u88ab\u7522\u751f\u3001\u4f48\u7f72\uff0c\u9019\u500b <code>.m3u8</code> \u6a94\u6848\u4e5f\u6703\u96a8\u4e4b\u66f4\u65b0\u3002</p> <p>\u5728 HLS \u898f\u683c\u4e2d\uff0c\u9664\u4e86 TS \u4e4b\u5916\uff0cHLS \u7684\u5207\u7247\u4e5f\u652f\u63f4\u4f7f\u7528 fMP4 \u5c01\u88dd\u3002\u4f46\u4f7f\u7528 fMP4 \u6a94\u6848\u5c01\u88dd\u7684 HLS \u6d41\uff0c\u5728\u591a\u6578\u5e73\u53f0\u90fd\u4e0d\u88ab\u652f\u63f4\uff0c\u860b\u679c\u5e73\u53f0\u4e5f\u50c5\u5728 macOS 10.12, iOS 10, tvOS 10 \u4e4b\u5f8c\u7684\u7248\u672c\u624d\u652f\u63f4\u64ad\u653e\u3002\u672c\u7ae0\u7bc0\u5f8c\u7e8c\u5747\u57fa\u65bc TS \u5207\u7247\u63cf\u8ff0\uff0cfMP4 \u6a94\u5c07\u5728 MPEG-DASH \u7ae0\u7bc0\u4ecb\u7d39\u3002</p> <p>\u4ee5\u4e0b\u5716\u7247\u4f86\u81ea\u860b\u679c\u7684 HLS \u6280\u8853\u5b98\u65b9\u9801\u9762\uff1a</p> <p></p> <p>Client \u7aef\u5728\u64ad\u653e\u7684\u6642\u5019\uff0c\u9996\u5148\u6293\u53d6 <code>.m3u8</code> \u6a94\u6848\uff0c\u6aa2\u67e5\u7576\u4e2d\u6709\u54ea\u4e9b ts \u6a94\u6848\uff0c\u5728\u76f4\u64ad\u7684\u72c0\u6cc1\u4e0b\uff0c\u53ef\u80fd\u5728 <code>.m3u8</code> \u6a94\u6848\u4e2d\uff0c\u5c31\u7559\u4e86\u6700\u65b0\u7684\u4e09\u500b ts \u6a94\uff0cclient \u7aef\u5c31\u5f9e\u7b2c\u4e00\u500b ts \u6a94\u6848\u958b\u59cb\u8f2a\u6d41\u6293\u53d6\u3001\u64ad\u653e\uff0c\u5728\u5feb\u8981\u628a\u9019\u4e09\u500b ts \u6a94\u90fd\u5feb\u8981\u64ad\u5b8c\u7684\u6642\u5019\uff0c\u5c31\u518d\u53bb\u6aa2\u67e5\u4e00\u6b21 <code>.m3u8</code> \u6a94\u6848\uff0c\u67e5\u770b\u662f\u4e0d\u662f\u9084\u6709\u66f4\u65b0\u7684 ts \u6a94\u6848\uff0c\u5982\u679c\u6709\uff0c\u5c31\u7e7c\u7e8c\u6293\u53d6\u9019\u4e9b\u65b0\u7684 ts \u6a94\u3002\u9019\u500b\u6b65\u9a5f\u5c31\u4e0d\u65b7\u7684\u8f2a\u8ff4\uff0c\u76f4\u5230\u767c\u73fe\u6c92\u6709\u66f4\u65b0\u7684 ts \u6a94\u6848\uff0c\u4ee3\u8868\u76f4\u64ad\u5df2\u7d93\u7d50\u675f\u3002</p> <p>\u7531\u65bc\u6a94\u6848\u662f\u4f48\u7f72\u5728 CDN \u4e0a\uff0c\u7528\u6236\u4e5f\u662f\u5f9e\u8ddd\u96e2\u4ed6\u6700\u63a5\u8fd1\u7684 CDN \u6293\u53d6\u6a94\u6848\uff0c\u800c Web server \u6240\u80fd\u5920\u8ca0\u8f09\u7684\u9023\u7dda\uff0c\u9060\u5927\u65bc\u55ae\u4e00\u8b93\u773e\u591a client \u5efa\u7acb socket \u9023\u7dda\u7684 server \u3002\u96a8\u8457 21 \u4e16\u7d00\u7b2c\u4e8c\u500b\u5341\u5e74\u958b\u59cb\uff0c\u5e7e\u5927 CDN \u5ee0\u5546\u7684\u696d\u52d9\u898f\u6a21\u64f4\u5f35\uff0cCDN \u6280\u8853\u6108\u4f86\u6108\u666e\u53ca\uff0c\u50cf Akamai \u9019\u5bb6 CDN \u670d\u52d9\uff0c\u5927\u6982\u5728 HLS \u554f\u4e16\u6642\u63a8\u51fa\u670d\u52d9\uff0c\u96a8\u8457\u4e00\u8d77\u58ef\u5927\uff0cHLS \u4ee5\u53ca\u5f8c\u4f86\u7684\u65b0\u6280\u8853\uff0c\u4e5f\u6574\u500b\u4ee3\u66ff\u4e86\u4e4b\u524d\u7684\u5404\u7a2e\u5f71\u7247\u76f4\u64ad\u6280\u8853\uff0cHLS \u4e5f\u5728 2017 \u5e74\u6210\u70ba RFC 8216 \u898f\u683c\u3002\u76ee\u524d\u696d\u754c\u6240\u4f7f\u7528\u7684\u76f4\u64ad\u6280\u8853\uff0c\u5927\u6982\u90fd\u662f HLS \u4ee5\u53ca\u4e4b\u5f8c\u7684\u5176\u4ed6\u65b0\u6280\u8853\u3002</p> <p>HLS \u96d6\u7136\u6700\u65e9\u7528\u5728\u76f4\u64ad\uff0c\u4f46\u4e4b\u5f8c\u4e5f\u9678\u7e8c\u61c9\u7528\u5728\u5f71\u7247\u4ee5\u53ca\u97f3\u6a94\u7684\u7528\u9014\u4e0a\u3002\u5047\u5982\u4e00\u500b <code>.m3u8</code> \u6a94\u6848\u4e2d\u7684 ts \u4e0d\u6703\u96a8\u6642\u9593\u66f4\u65b0\uff0c\u800c\u662f\u975c\u614b\u7684\uff0c\u6211\u5011\u4e0d\u662f\u5c07\u76f4\u64ad\u8a0a\u865f\u5207\u6210\u5c0f\u6a94\uff0c\u800c\u662f\u5c07\u4e00\u90e8\u96fb\u5f71\u6216\u662f\u5f71\u7247\u7684\u5927\u6a94\u5207\u6210\u5c0f\u6a94\uff0c\u90a3\u9ebc\uff0c\u9019\u500b <code>.m3u8</code> \u4e32\u6d41\u5c31\u53ef\u4ee5\u662f\u4e00\u90e8\u96fb\u5f71\u6216\u662f\u96fb\u8996\u5287\u3002\u800c\u5982\u679c\u628a\u975c\u614b\u7684 <code>.m3u8</code> \u4e2d\u7684 ts\uff0c\u5f9e\u5f71\u7247\u518d\u63db\u6210\u97f3\u6a94\uff0c\u90a3\u4e5f\u5c31\u662f\u4e00\u500b\u88ab\u5207\u6210\u773e\u591a\u5c0f\u6a94\u6848\u7684\u6b4c\u66f2\u4e32\u6d41\u4e86\u3002</p>"},{"location":"hls/#_1","title":"\u76f4\u64ad\u7684\u5ef6\u9072","text":"<p>\u96d6\u7136\u8207\u6211\u5011\u8ddf\u97f3\u6a94\u7684\u76f8\u95dc\u8a0e\u8ad6\u6bd4\u8f03\u6c92\u6709\u95dc\u4fc2\uff0c\u4e0d\u904e\u6211\u5011\u53ef\u4ee5\u4f86\u804a\u4e00\u4e0b\uff0c\u5728\u76f4\u64ad\u904e\u7a0b\u4e2d\u6703\u767c\u751f\u7684\u5ef6\u9072\uff08latency\uff09\u3002\u7d30\u6578\u4e00\u4e0b\u5f9e\u8a0a\u6e90\u5230\u6700\u5f8c\u7684\u6536\u8996\u7aef\uff0c\u6211\u5011\u53ef\u4ee5\u767c\u73fe\uff0c\u6bcf\u4e00\u500b\u6b65\u9a5f\uff0c\u90fd\u9700\u8981\u8017\u8cbb\u6642\u9593\u8655\u7406\uff0c\u5c0e\u81f4\u89c0\u770b\u8005\u770b\u5230\u67d0\u500b\u4e8b\u4ef6\u6642\uff0c\u5df2\u7d93\u8207\u4e8b\u4ef6\u5be6\u969b\u767c\u751f\u7684\u6642\u9593\u4e4b\u9593\uff0c\u6709\u4e00\u6bb5\u6642\u9593\u5dee\uff1a</p> <ul> <li>\u8ca0\u8cac\u9304\u5f71/\u9304\u97f3\u7684\u8a2d\u5099\uff0c\u9700\u8981\u62cd\u651d\u4e00\u5b9a\u6578\u91cf\u7684\u5f71\u683c/\u8072\u97f3\uff08\u5176\u5be6\u82f1\u6587\u90fd\u662f frame\uff09\uff0c\u624d\u6709\u8fa6\u6cd5\u7d2f\u7a4d\u6210 packet\uff0c\u900f\u904e RTMP \u767c\u9001\u5230\u8ca0\u8cac\u5207\u6a94\u7684\u4e3b\u6a5f</li> <li>RTMP \u50b3\u9001\u8cc7\u6599\u5230\u4e3b\u6a5f\u4e0a\u7684\u50b3\u8f38\u6642\u9593</li> <li>\u4e3b\u6a5f\u9700\u8981\u7d2f\u7a4d\u4e00\u5b9a\u6578\u91cf\u7684 packet\uff0c\u624d\u80fd\u5920\u7522\u751f ts\u3002\u7531\u65bc HLS \u652f\u63f4\u591a\u7a2e\u4e0d\u540c\u54c1\u8cea\u7684\u5f71\u50cf/\u8072\u97f3\u7684 track\uff0c\u6240\u4ee5\u4e5f\u5f80\u5f80\u6703\u4e00\u6b21\u7522\u751f\u591a\u500b\u4e0d\u540c\u54c1\u8cea\u7684 ts</li> <li>\u5c07 ts \u4ee5\u53ca\u65b0\u7684 <code>.m3u8</code> \u6a94\u6848\u4f48\u7f72\u5230 CDN \u4e0a\u7684\u6642\u9593</li> <li>\u64ad\u653e\u7aef client \u6293\u53d6 <code>.m3u8</code> \u7684\u6642\u9593</li> <li>\u64ad\u653e\u7aef client \u6293\u53d6 ts \u6a94\u6848\uff0c\u5230\u6709\u8db3\u5920\u6578\u91cf\u7684 packet \u53ef\u4ee5\u64ad\u653e\u7684\u6642\u9593\uff0c\u9019\u6bb5\u6642\u9593\u4e5f\u8996\u7528\u6236\u7684\u983b\u5bec\u54c1\u8cea\u800c\u6709\u6240\u4e0d\u540c</li> <li>\u56e0\u70ba HTTP proxy \u7684 cache\uff0c\u7528\u6236\u4e5f\u53ef\u80fd\u6293\u5230\u6bd4\u8f03\u820a\u7684\u6a94\u6848</li> </ul> <p>\u6240\u4ee5\uff0c\u5f9e\u4e8b\u4ef6\u767c\u751f\uff0c\u5230\u7528\u6236\u5be6\u969b\u89c0\u770b\u5230\uff0c\u5f80\u5f80\u6703\u6709\u5927\u6982 15 \u79d2\u5230\u534a\u5206\u9418\u5de6\u53f3\u7684\u5ef6\u9072\u3002\u860b\u679c\u5728 2019 \u5e74 WWDC \u6642\u63a8\u51fa\u65b0\u7684 Low Latency HLS \u898f\u683c\uff0c\u9019\u500b\u65b0\u898f\u683c\u7528\u4e86\u4e00\u4e9b\u6280\u5de7\uff0c\u60f3\u8fa6\u6cd5\u6e1b\u5c11\u76f4\u64ad\u904e\u7a0b\u7576\u4e2d\u7684\u5ef6\u9072\uff0c\u5927\u6982\u5c31\u662f\u8b93\u7528\u6236\u76e1\u53ef\u80fd\u53bb\u6293\u53d6\u6700\u65b0\u7684 ts\uff0c\u7136\u5f8c\u5728 <code>.m3u8</code> \u6a94\u6848\u4e2d\u52a0\u4e0a\u6642\u9593\u76f8\u95dc\u8cc7\u8a0a\uff0c\u5728\u6293\u5230 ts \u4e4b\u5f8c\u76f4\u63a5\u8df3\u5230\u6700\u65b0\u7684\u6307\u5b9a\u79d2\u6578\uff0c\u4e26\u4e14\u76e1\u91cf\u4e0d\u8981\u88ab proxy cache \u6240\u5f71\u97ff\uff0c\u53ef\u4ee5\u53c3\u8003 WWDC 2019 \u5e74\u7684\u8aaa\u660e\u3002\u4f46\u9019\u6a23\u7684 HLS server \u7684\u5be6\u4f5c\u5728\u73fe\u5728\uff082020 \u5e74\u521d\uff09\u9084\u4e0d\u666e\u53ca\uff0c\u64ad\u653e\u7aef\u4e5f\u9700\u8981\u6700\u65b0\u7684\u4f5c\u696d\u7cfb\u7d71\u8207\u64ad\u653e\u8edf\u9ad4\u652f\u63f4\uff0c\u8981\u7b49\u5230\u666e\u53ca\uff0c\u76f8\u4fe1\u9084\u8981\u82b1\u4e0a\u4e00\u6bb5\u6642\u9593\u3002</p>"},{"location":"hls/#m3u8","title":".m3u8 \u6a94\u6848","text":"<p>\u6211\u5011\u53ef\u4ee5\u6253\u958b Akamai \u7684\u4e00\u500b\u7bc4\u4f8b m3u8 \u6a94\u6848\uff0c\u770b\u770b\u88e1\u982d\u7684\u5167\u5bb9\uff1a</p> <pre><code>#EXTM3U\n#EXT-X-VERSION:5\n\n#EXT-X-MEDIA:TYPE=AUDIO,GROUP-ID=\"audio\",NAME=\"English stereo\",LANGUAGE=\"en\",AUTOSELECT=YES,URI=\"f08e80da-bf1d-4e3d-8899-f0f6155f6efa_audio_1_stereo_128000.m3u8\"\n\n#EXT-X-STREAM-INF:BANDWIDTH=628000,CODECS=\"avc1.42c00d,mp4a.40.2\",RESOLUTION=320x180,AUDIO=\"audio\"\nf08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_180_250000.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=928000,CODECS=\"avc1.42c00d,mp4a.40.2\",RESOLUTION=480x270,AUDIO=\"audio\"\nf08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_270_400000.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=1728000,CODECS=\"avc1.42c00d,mp4a.40.2\",RESOLUTION=640x360,AUDIO=\"audio\"\nf08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_360_800000.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=2528000,CODECS=\"avc1.42c00d,mp4a.40.2\",RESOLUTION=960x540,AUDIO=\"audio\"\nf08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_540_1200000.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=4928000,CODECS=\"avc1.42c00d,mp4a.40.2\",RESOLUTION=1280x720,AUDIO=\"audio\"\nf08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_720_2400000.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=9728000,CODECS=\"avc1.42c00d,mp4a.40.2\",RESOLUTION=1920x1080,AUDIO=\"audio\"\nf08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_1080_4800000.m3u8\n</code></pre> <p>\u9019\u662f\u4e00\u90e8\u5f71\u7247\u7684 <code>.m3u8</code> \u6a94\u6848\u3002\u6bcf\u500b <code>.m3u8</code> \u6a94\u6848\u4ee5 <code>#EXTM3U</code> \u958b\u982d\uff0c\u7136\u5f8c\u63a5\u8457\u4e00\u4e9b\u57fa\u672c\u7684 metadata\uff0c\u50cf\uff0c\u9019\u90e8\u5f71\u7247\u88e1\u982d\u7528\u7684\u8a9e\u6587\u662f\u82f1\u6587\u3002</p> <p>\u5728\u9019\u88e1\uff0c\u6211\u5011\u53ef\u4ee5\u770b\u5230\uff0c\u9019\u4efd HLS \u4e32\u6d41\u652f\u63f4\u591a\u7a2e\u4e0d\u540c\u7684\u54c1\u8cea\uff0c\u5f71\u50cf\u89e3\u6790\u5ea6\u6700\u4f4e\u5230 320x180\u3001\u6700\u9ad8\u5230 1080p\uff081920x1080\uff09\u3002client \u7aef\u7684\u64ad\u653e\u5668\u53ef\u4ee5\u6839\u64da\u73fe\u5728\u7684\u983b\u5bec\u54c1\u8cea\uff0c\u5f9e\u591a\u500b\u4e0d\u540c\u54c1\u8cea\u7684\u4e32\u6d41\u4e2d\uff0c\u9078\u64c7\u76ee\u524d\u6700\u9069\u5408\u3001\u80fd\u5920\u9806\u66a2\u64ad\u64ad\u653e\u7684\u6700\u9ad8\u54c1\u8cea\uff0c\u800c\u7576\u983b\u5bec\u54c1\u8cea\u6539\u8b8a\u6642\uff0c\u4e5f\u6703\u5207\u63db\u5230\u53e6\u4e00\u500b\u6700\u9069\u5408\u7684\u4e32\u6d41\u3002\u9019\u7a2e\u53ef\u4ee5\u52d5\u614b\u4f7f\u7528\u6700\u9069\u5408\u54c1\u8cea\u7684\u4e32\u6d41\u64ad\u653e\u65b9\u5f0f\uff0c\u53eb\u505a Adaptive Streaming\u3002\u96d6\u7136\u6709\u591a\u7a2e\u4e0d\u540c\u7684\u5f71\u7247\u683c\u5f0f\uff0c\u5728\u8072\u97f3\u65b9\u9762\uff0c\u5247\u5171\u7528\u540c\u4e00\u500b 128k \u7684\u8072\u97f3 \"f08e80da-bf1d-4e3d-8899-f0f6155f6efa_audio_1_stereo_128000.m3u8\"\u3002</p> <p>\u7136\u5f8c\u6211\u5011\u53ef\u4ee5\u770b\u4e00\u4e0b f08e80da-bf1d-4e3d-8899-f0f6155f6efa_video_180_250000.m3u8 \u9019\u500b\u5f71\u7247\u76f8\u95dc\u7684 <code>.m3u8</code> \u6a94\u6848\u7576\u4e2d\u7684\u5167\u5bb9\uff1a</p> <pre><code>#EXTM3U\n\n#EXT-X-VERSION:3\n#EXT-X-MEDIA-SEQUENCE:0\n#EXT-X-TARGETDURATION:4\n\n#EXTINF:4.0\n../video/180_250000/hls/segment_0.ts\n#EXTINF:4.0\n../video/180_250000/hls/segment_1.ts\n#EXTINF:4.0\n../video/180_250000/hls/segment_2.ts\n#EXTINF:4.0\n../video/180_250000/hls/segment_3.ts\n#EXTINF:4.0\n../video/180_250000/hls/segment_4.ts\n#EXTINF:4.0\n../video/180_250000/hls/segment_5.ts\n.....\n</code></pre> <p>\u7576\u4e2d\u5c31\u662f\u4e00\u9023\u4e32\u7684 ts \u6a94\u6848\uff0c\u5728 <code>#EXTINF</code> \u4e2d\uff0c\u5247\u63cf\u8ff0\u4e86\u6bcf\u500b ts \u6a94\u6848\u7684\u9577\u5ea6\u662f 4.0 \u79d2\u3002</p> <p>\u860b\u679c\u5728 2016 \u5e74\u7684\u6642\u5019\u5ba3\u5e03\uff0c\u9664\u4e86\u53ef\u4ee5\u5c07\u6a94\u6848\u5207\u6210 ts \u4e4b\u5916\uff0c\u4e5f\u53ef\u4ee5\u652f\u63f4 fMP4 \u683c\u5f0f\u7684 byte range\uff0c\u5982\u6b64\u4e00\u4f86\uff0c\u6703\u8b93 HLS \u8207\u5f8c\u9762\u8981\u8b1b\u5230\u7684 MPEG Dash \u683c\u5f0f\u9032\u4e00\u6b65\u76f8\u5bb9\u3002\u4e0d\u904e\uff0c\u6211\u5011\u4e5f\u662f\u7559\u5728\u4e0b\u4e00\u7ae0\u8a0e\u8ad6\u3002</p>"},{"location":"hls/#hls","title":"\u64ad\u653e HLS","text":"<p>HLS \u683c\u5f0f\u662f\u958b\u653e\u7684\uff0c\u6240\u4ee5\uff0c\u9664\u4e86\u860b\u679c\u7684\u65b9\u6848\u4ee5\u5916\uff0c\u7b2c\u4e09\u65b9\u4e5f\u53ef\u4ee5\u81ea\u5df1\u5be6\u4f5c HLS \u7684 server\u3001segmenter \u8207 client \u7aef\u3002</p> <p>\u6211\u5011\u53ef\u4ee5\u770b\u5230\uff0c\u76ee\u524d\u6709\u8a31\u591a\u7684\u5f71\u97f3\u6258\u7ba1\u670d\u52d9\uff0c\u50cf\u662f Wowza \u7b49\uff0c\u53ef\u4ee5\u5e6b\u60f3\u8981\u64ad\u653e\u5167\u5bb9\u7684\u4f7f\u7528\u8005\u7522\u751f HLS \u4e32\u6d41\uff0c\u4e5f\u53ef\u4ee5\u540c\u6642\u7522\u751f MPEG Dash \u7b49\u5176\u4ed6\u683c\u5f0f\uff0c\u5982\u679c\u4e0a\u50b3\u7684\u662f\u8072\u97f3\u8a0a\u865f\uff0c\u4e5f\u53ef\u4ee5\u7522\u751f shoutcast\u3001icecast \u5f62\u5f0f\u7684\u7db2\u8def\u8072\u97f3\u5ee3\u64ad\u3002</p> <p>\u5728\u64ad\u653e\u8edf\u9ad4\u65b9\u9762\uff0c\u860b\u679c\u5b98\u65b9\u7684\u64ad\u653e\u5143\u4ef6\uff0c\u81ea\u7136\u662f AVPlayer\u3002\u6211\u5011\u4e5f\u53ef\u4ee5\u770b\u5230\u4e00\u4e9b\u7b2c\u4e09\u65b9\u7684\u5be6\u4f5c\uff0c\u50cf\u662f JWPlayer\u3001Kaltura Player \u7b49\u7b49\uff0c\u90fd\u53ef\u4ee5\u64ad\u653e HLS\u3002\u4f46\u662f\u80fd\u4e0d\u80fd\u5920\u64ad\u653e FairPlay \u4fdd\u8b77\u7684 HLS\uff0c\u5c31\u8981\u770b\u5404\u5bb6 Player \u7684\u652f\u63f4\u7a0b\u5ea6\u3002</p> <p>\u7531\u65bc HLS \u540c\u6642\u53ef\u4ee5\u7528\u5728\u76f4\u64ad\uff0c\u6216\u662f\u64ad\u653e\u7dda\u4e0a\u7684\u5f71\u7247\u6216\u662f\u97f3\u6a02\uff0c\u6240\u4ee5\u5c31\u6703\u6709\u5169\u7a2e\u64ad\u653e HLS \u7684\u6a21\u5f0f\uff1a\u5728\u64ad\u653e\u7dda\u4e0a\u7684\u5f71\u7247\u6216\u97f3\u6a02\u7684\u72c0\u614b\u4e0b\uff0c\u6211\u5011\u53ef\u4ee5\u4efb\u610f\u8df3\u5230\u5f71\u7247\u6216\u97f3\u6a02\u7684\u4efb\u4e00\u4f4d\u7f6e\uff0c\u800c\u64ad\u653e\u8edf\u9ad4\u5728\u8df3\u5230\u6307\u5b9a\u4f4d\u7f6e\u7684\u6642\u5019\uff0c\u4e5f\u53ea\u9700\u8981\u5f9e <code>.m3u8</code> \u6a94\u6848\u4e2d\uff0c\u627e\u5230\u7b26\u5408\u6642\u9593\u4f4d\u5740\u7684 ts \u8f09\u5165\uff1b\u81f3\u65bc\u5728\u76f4\u64ad\u7684\u6a21\u5f0f\u4e0b\uff0c\u7531\u65bc\u6211\u5011\u53ea\u6709\u5c11\u90e8\u5206\u7684 ts \u53ef\u4ee5\u4f7f\u7528\uff0c\u6240\u4ee5\uff0c\u64ad\u653e\u5668\u4ecb\u9762\u5c31\u5f80\u5f80\u5448\u73fe\u6210\u300c\u5f80\u524d\u5341\u79d2\u300d\u6216\u300c\u5f80\u5f8c\u5341\u79d2\u300d\u64ad\u653e\u3002</p> <p></p> <p>\u800c\u5728\u652f\u63f4\u7684\u97f3\u8a0a\u683c\u5f0f\u65b9\u9762\uff0cTS container \u4e26\u6c92\u6709\u9650\u5236\u7576\u4e2d\u7684\u8cc7\u6599\u683c\u5f0f\u3002\u6240\u4ee5\uff0c\u5982\u679c\u5c07 HLS \u7528\u5728\u97f3\u8a0a\u7684\u4e32\u6d41\u4e0a\uff0c\u5728 iOS/macOS \u4e0a\uff0c\u53ea\u8981\u662f Core Audio \u6240\u652f\u63f4\u7684\u683c\u5f0f\uff0c\u5305\u62ec MP3\u3001AAC\u3001FLAC\u2026\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528 HLS \u767c\u4f48\u3002</p>"},{"location":"hls/#fairplay-streaming","title":"FairPlay Streaming","text":"<p>FairPlay Streaming \u7c21\u7a31 FPS\uff0c\u662f\u860b\u679c\u7528\u4f86\u4fdd\u8b77 HLS \u4e32\u6d41\u7684\u5546\u7528 DRM \u6a5f\u5236\u3002\u6211\u5011\u8981\u89e3\u91cb\u4e00\u4e0b FairPlay \u8207 FairPlay Streaming \u9019\u5169\u500b\u540d\u8a5e\u7684\u5dee\u7570\uff0cFairPlay \u662f\u4e00\u5957\u860b\u679c\u7528\u5728\u5404\u7a2e\u7522\u54c1\u4e0a\u7684 DRM \u6280\u8853\uff0c\u50cf\u662f iTunes Store \u4e0a\u9762\u8cfc\u8cb7\u7684\u97f3\u6a02\u3001App Store \u4e0a\u8cfc\u8cb7\u7684 app\uff0c\u860b\u679c\u90fd\u4f7f\u7528 FairPlay \u4fdd\u8b77\uff0c\u4e0d\u904e\uff0c\u53ea\u6709\u7528\u4f86\u4fdd\u8b77 HLS \u7684 FPS\uff0c\u624d\u5f9e 2015 \u5e74\u8d77\u958b\u653e\u7d66\u5916\u90e8\u4f7f\u7528\u3002\u6240\u4ee5\uff0c\u7576\u6211\u5011\u5728\u860b\u679c\u5916\u90e8\u8b1b\u5230 FairPlay\uff0c\u8b1b\u7684\u5f80\u5f80\u662f FPS\u3002\u800c\u5373\u4f7f\u860b\u679c\u958b\u653e\u5916\u90e8\u4f7f\u7528\uff0c\u6211\u5011\u9084\u662f\u8981\u984d\u5916\u8ddf\u860b\u679c\u7533\u8acb\u4ee5\u53ca\u7c3d\u7d04\u3002</p> <p>\u5728\u4e00\u500b\u53d7\u5230 FPS \u4fdd\u8b77\u7684 HLS \u4e32\u6d41\u4e2d\uff0c\u6703\u628a\u6bcf\u500b ts \u6a94\u6848\u52a0\u4e0a AES \u52a0\u5bc6\uff0cclient \u7aef\u8981\u80fd\u5920\u64ad\u653e\uff0c\u5c31\u5fc5\u9808\u8981\u53d6\u5f97\u9019\u628a key\uff0cFPS \u7684\u91cd\u9ede\u5c31\u662f\u5982\u4f55\u4fdd\u8b49\u9019\u628a key \u5728\u50b3\u905e\u7684\u904e\u7a0b\u4e2d\u4e0d\u6703\u88ab\u5916\u90e8\u7834\u89e3\u3002\u56e0\u70ba\u662f\u88ab\u860b\u679c\u4fdd\u8b77\u8d77\u4f86\uff0c\u6240\u4ee5\u6211\u5011\u4e5f\u641e\u4e0d\u6e05\u695a\u5be6\u969b\u4e0a\u860b\u679c\u505a\u4e86\u4ec0\u9ebc\uff0c\u6839\u64da\u860b\u679c\u7684\u6587\u4ef6\uff0c\u6211\u5011\u53ea\u8981\u7167\u4ee5\u4e0b\u9019\u9ebc\u505a\u5c31\u5c0d\u4e86\uff1a</p> <p>\u627e\u5230 Asset ID\uff0c\u628a Asset ID \u8ddf Certificate \u7d50\u5408\u8d77\u4f86\u7522\u751f SPC\uff0c\u50b3\u5230 server \u4e0a\uff0c\u5982\u679c\u53ef\u4ee5\u5f9e server \u6210\u529f\u62ff\u5230 CKC\uff0c\u628a CKC \u585e\u9032\u64ad\u653e\u5143\u4ef6\uff0c\u5c31\u53ef\u4ee5\u64ad\u4e86\u3002</p> <p>\u2026\u9019\u4e00\u6bb5\u8a71\u88e1\u982d\u5145\u6eff\u4e86\u8a31\u591a\u5947\u5999\u7684\u95dc\u9375\u5b57\uff0c\u50cf\u662f SPC\u3001CKC\u2026\u4e00\u5b9a\u8981\u89e3\u91cb\u4e00\u4e0b\u624d\u6709\u8fa6\u6cd5\u7406\u89e3\u3002\u6211\u5011\u5728\u4e0b\u9762\u6703\u89e3\u91cb\u4e00\u4e0b\u5728 iOS/macOS app \u4e0a\u7684\u6d41\u7a0b\u3002\u7576\u4e2d\u4e0d\u6703\u8b1b\u89e3\u592a\u591a\u5be6\u969b\u5728\u5e73\u53f0\u4e0a\u6703\u547c\u53eb\u54ea\u4e9b API\uff0c\u4f46\u662f\u81f3\u5c11\u5f97\u89e3\u91cb\u50cf CKC\u3001SPC \u9019\u4e9b\u95dc\u9375\u5b57\uff0c\u624d\u6709\u8fa6\u6cd5\u4e86\u89e3 FPS\u3002</p>"},{"location":"hls/#fairplay-streaming_1","title":"\u8655\u7406 FairPlay Streaming \u7684\u6d41\u7a0b","text":""},{"location":"hls/#m3u8-asset-id","title":"\u5148\u5f9e .m3u8 \u4e2d\u89e3\u6790\u51fa asset ID","text":"<p>\u4e00\u500b\u88ab FairPlay \u4fdd\u8b77\u8d77\u4f86\u7684 .m3u8 \u6a94\u6848\uff0c\u88e1\u982d\u6703\u6709\u50cf\u9019\u6a23\u7684\u4e00\u6bb5\uff1a</p> <pre><code>#EXTM3U\n....\n#EXT-X-KEY:METHOD=SAMPLE-AES,URI=\"skd://f3c5e0361e6654b28f8049c778b23946+5c3de6de8c2bb1295712e8da387add37\",KEYFORMATVERSIONS=\"1\",KEYFORMAT=\"com.apple.streamingkeydelivery\"\n</code></pre> <p>\"f3c5e0361e6654b28f8049c778b23946+5c3de6de8c2bb1295712e8da387add37\" \u9019\u4e00\u6bb5\uff0c\u5c31\u662f\u4e00\u500b asset ID\uff0c\u662f FairPlay \u6a5f\u5236\u7576\u4e2d\u7528\u4f86\u8868\u793a\u4e00\u500b\u7279\u5b9a\u5a92\u9ad4\uff0c\u50cf\u662f\u7279\u5b9a\u5f71\u7247\u3001\u6b4c\u66f2\u7684\u65b9\u5f0f\u3002\u5728\u64ad\u653e\u4e00\u500b HLS \u4e32\u6d41\uff0c\u64ad\u653e\u5668\u5c31\u6703\u5617\u8a66\u53bb\u5c0b\u627e\u662f\u5426\u6709\u9019\u6bb5\u8cc7\u8a0a\uff0c\u5982\u679c\u6c92\u6709\uff0c\u5c31\u4ee3\u8868\u6c92\u6709\u52a0\u4e0a\u4fdd\u8b77\uff0c\u64ad\u653e\u5143\u4ef6\u5c31\u6703\u76f4\u63a5\u64ad\u653e\u9019\u500b HLS \u4e32\u6d41\u3002</p> <p>\u5728 iOS/macOS app \u4e2d\uff0c\u6211\u5011\u6703\u5148\u628a <code>.m3u8</code> \u4e32\u6d41\u653e\u5728\u4e00\u500b AVAsset \u4e2d\uff0c\u5728\u5617\u8a66\u8f09\u5165\u9019\u500b AVAsset \u7684\u6642\u5019\uff0c\u5982\u679c\u9047\u5230\u88ab\u4fdd\u8b77\u3001\u9700\u8981 Key \u7684 HLS\uff0c\u5c31\u6703\u89f8\u767c\u5c0d\u61c9\u7684 delegate method\u3002\u5728 Safari \u700f\u89bd\u5668\u4e2d\uff0c\u6211\u5011\u53ef\u4ee5\u5c0d video tag \u7684 \"webkitneedkey\" \u4e8b\u4ef6\u52a0\u4e0a listener\uff0c\u7136\u5f8c\uff0c\u9019\u500b video tag \u64ad\u653e\u7684\u5f71\u7247\u9700\u8981\u6709\u4e00\u628a Key \u6642\uff0c\u5c31\u6703\u89f8\u767c\u5f8c\u7e8c\u7684\u884c\u70ba\u3002</p>"},{"location":"hls/#spc-ckc","title":"\u7522\u751f\u3001\u4e0a\u50b3 SPC\uff0c\u53d6\u5f97 CKC","text":"<p>SPC \u5168\u540d\u53eb\u505a Server Playback Context\uff0c\u7c21\u55ae\u4f86\u8aaa\uff0c\u5c31\u662f\u7528\u5169\u7a2e\u4f86\u6e90\u7684\u8cc7\u6599\uff0c\u900f\u904e\u860b\u679c\u7684\u4e00\u5957\u88ab\u4fdd\u8b77\u8d77\u4f86\u7684\u6f14\u7b97\u6cd5\uff0c\u7522\u751f\u51fa\u4f86\u7684\u6388\u6b0a\u9700\u6c42\u8cc7\u6599\uff0c\u6211\u5011\u5f80 server \u4e0a\u50b3\u9019\u4efd\u8cc7\u6599\u4e4b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u62ff\u5230\u6700\u5f8c\u53ef\u4ee5\u7528\u4f86\u64ad\u653e\u7684 key\u2014\u4e0d\u904e\uff0c\u9019\u628a Key \u4e5f\u662f\u88ab\u4fdd\u8b77\u8d77\u4f86\u7684\uff0c\u9019\u500b\u628a Key \u5305\u8d77\u4f86\u7684\u8cc7\u6599\uff0c\u53eb\u505a CKC\uff0cContent Key Context\u3002</p> <p>\u6211\u5011\u5728\u901a\u904e\u860b\u679c\u7684\u5be9\u6838\uff0c\u53ef\u4ee5\u958b\u59cb\u4f7f\u7528 FairPlay \u4e4b\u5f8c\uff0c\u6211\u5011\u53ef\u4ee5\u5728\u860b\u679c\u7684\u958b\u767c\u8005\u5f8c\u53f0\u4e0a\u5efa\u7acb\u4e00\u4efd FPS \u4f7f\u7528\u7684 Certificate\uff0c\u56e0\u70ba\u6211\u5011\u53ef\u4ee5\u96a8\u6642\u66f4\u65b0\u9019\u4efd certificate\uff0c\u6240\u4ee5\u4e0d\u592a\u61c9\u8a72\u76f4\u63a5\u653e\u5728 client \u7aef\uff0c\u800c\u662f\u61c9\u8a72\u653e\u5728\u4e00\u500b Web API \u4e0a\uff0c\u8b93 client \u7aef\u5728\u6709\u9700\u8981\u7684\u6642\u5019\u6293\u53d6\u3002</p> <p>\u5728 iOS/macOS \u5e73\u53f0\u4e0a\uff0c\u6211\u5011\u63a5\u4e0b\u4f86\u8981\u547c\u53eb AVAssetResourceLoadingRequest \u7684 streamingContentKeyRequestData(forApp:contentIdentifier:options:)\uff0c\u9019\u908a <code>forApp:</code> \u8981\u50b3\u5165\u7684\uff0c\u5c31\u662f\u4e0a\u9762\u63d0\u5230\u7684 certificate\uff0ccontentIdentifier \u5247\u662f asset ID\uff1b\u9019\u500b API \u56de\u50b3\u7684\u8cc7\u6599\uff0c\u5c31\u662f SPC\u3002\u81f3\u65bc\u9019\u500b method \u5f8c\u9762\u505a\u4e86\u4ec0\u9ebc\u4e8b\u60c5\uff0c\u6c92\u6709\u4eba\u77e5\u9053\u3002</p> <p>\u5728 Safari \u700f\u89bd\u5668\u4e2d\uff0c\u5728 webkitneedkey \u88ab\u547c\u53eb\u7684\u6642\u5019\uff0c\u5247\u8981\u7d50\u5408 asset ID \u8207 certificate\uff0c\u547c\u53eb video tag \u7684webkitSetMediaKeys\uff0c\u4ee5\u53ca WebKitMediaKeys \u7684 createSession \u3002\u547c\u53eb\u65b9\u5f0f\uff0c\u53ef\u4ee5\u53c3\u8003 FPS SDK \uff08\u53ef\u4ee5\u5f9e\u860b\u679c\u5b98\u7db2\u4e0b\u8f09\uff09\u4e2d\u7684\u7bc4\u4f8b\u7a0b\u5f0f\uff1a</p> <p></p> <p>\u6211\u5011\u7684 Server \u9700\u8981\u6e96\u5099\u53e6\u5916\u4e00\u652f Web API\uff0c\u9019\u652f API \u5f8c\u9762\uff0c\u8981\u6a4b\u63a5\u860b\u679c\u5728 FairPlay SDK \u88e1\u982d\u7684 Key Server Module\uff0c\u62ff\u860b\u679c\u7684 library \u4f86\u8655\u7406 client \u7aef\u4e0a\u50b3\u7684 SPC\uff0c\u56de\u50b3\u7684\u7d50\u679c\uff0c\u5c31\u662f CKC\uff0c\u628a CKC \u585e\u5230 Player \u4e0a\uff08\u5728 iOS/macOS app \u4e2d\uff0c\u547c\u53eb AVAssetResourceLoadingDataRequest \u7684 respond(with:)\uff09\uff1b\u81f3\u65bc\u5728 Safari \u700f\u89bd\u5668\u4e2d\uff0c\u5247\u662f\u547c\u53eb WebKitMediaKeySession \u7684 update\u3002</p> <p>\u63db\u53e5\u8a71\u8aaa\uff0c\u4e00\u500b\u5b8c\u6574\u7684 FairPlay server \u61c9\u8a72\u8981\u6709\u5169\u500b API end point\uff1a1. \u4e0b\u8f09 certificate\u30012. \u9a57\u8b49 SPC \u4e26\u56de\u50b3 CKC\u3002</p>"},{"location":"hls/#fairplay-streaming_2","title":"FairPlay Streaming \u8fd1\u5e74\u7684\u6f14\u8b8a","text":"<p>\u860b\u679c\u5728 2015 \u5e74\u91cb\u51fa\u516c\u958b\u7248\u672c\u7684 FPS \u6642\uff0c\u53ea\u63d0\u4f9b\u5728\u64ad\u653e\u7684\u904e\u7a0b\u4e2d\u6293\u53d6 CKC \u7684\u6d41\u7a0b\uff0c\u4e4b\u5f8c\uff0c\u860b\u679c\u4e5f\u9678\u7e8c\u64f4\u5145 FPS\uff0c\u5728\u6bcf\u5e74\u7684 WWDC \u516c\u5e03\u66f4\u591a FPS \u7684\u65b0\u529f\u80fd\u3002\u9019\u4e9b\u65b0\u529f\u80fd\u90fd\u5728 ios/macOS \u7684 app \u7aef\uff0c\u5728 Web \u4e0a\uff0c</p>"},{"location":"hls/#wwdc-2016-offline-hls","title":"WWDC 2016 - Offline HLS","text":"<p>\u860b\u679c\u5728 2016 \u5e74\u63a8\u51fa Offline HLS\uff0c\u53ef\u4ee5\u8b93\u7b2c\u4e09\u65b9\u5ee0\u5546\u5728\u81ea\u5df1\u7684 app \u4e2d\uff0c\u5c07 HLS \u4e32\u6d41\u4e0b\u8f09\u5230\u672c\u5730\u7aef\u96e2\u7dda\u64ad\u653e\uff0c\u800c HLS \u7684 Key \u4e5f\u5206\u6210\u4e86\u5169\u7a2e\uff0c\u4e00\u7a2e\u662f\u64ad\u653e\u7528\u7684\uff08Streaming Key\uff09\u3001\u53e6\u5916\u4e00\u7a2e\u662f\u96e2\u7dda\u5132\u5b58\u7528\u7684\uff08Persistent Key\uff09\u3002\u8207 Offline HLS \u7684\u76f8\u95dc\u8cc7\u8a0a\u53c3\u898b What's New in HTTP Live Streaming\u3002</p>"},{"location":"hls/#wwdc-2017-content-key-session","title":"WWDC 2017 - Content Key Session","text":"<p>\u860b\u679c\u5728 2017 \u5e74\u63a8\u51fa Content Key Session\uff0c\u628a\u6293\u53d6 CKC \u7684\u6d41\u7a0b\uff0c\u8207\u64ad\u653e\u6d41\u7a0b\u5340\u5206\u958b\u4f86\u3002</p> <p>\u9019\u500b\u8a2d\u8a08\u5728\u65bc\u89e3\u6c7a\u5e7e\u500b\u554f\u984c\uff1a</p> <ul> <li>\u5982\u679c\u67d0\u500b\u76f4\u64ad\u6d3b\u52d5\u6703\u5728\u67d0\u500b\u6642\u9593\u958b\u64ad\uff0c\u7576\u76f4\u64ad\u958b\u59cb\u4e4b\u5f8c\uff0c\u5c31\u6703\u6709\u5927\u6279\u7684\u7528\u6236\u6e67\u5165\uff0c\u7576\u6240\u6709\u7528\u6236\u90fd\u540c\u6642\u8ddf server \u8981\u6c42 CKC \u7684\u6642\u5019\uff0c\u5c31\u6703\u7522\u751f\u5f88\u5927\u7684\u77ac\u9593\u6d41\u91cf\u3002\u6240\u4ee5\uff0c\u6211\u5011\u5c31\u5e0c\u671b\u53ef\u4ee5\u5728\u6d3b\u52d5\u958b\u64ad\u4e4b\u524d\uff0c\u7528\u6236\u5c31\u5b8c\u6210 DRM \u7684\u9a57\u8b49\u6d41\u7a0b\uff0c\u62ff\u5230 CKC\uff0c\u800c\u4e0d\u8981\u5230\u4e86\u958b\u64ad\u4e4b\u5f8c\u624d\u505a\u3002</li> <li>\u5728 2016 \u5e74\u63a8\u51fa Offline HLS \u4e4b\u5f8c\uff0c\u53ef\u4ee5\u8a2d\u5b9a\u4e00\u4efd Offline HLS \u5728\u56fa\u5b9a\u6642\u9593\u904e\u671f\uff0c\u4f46\u662f\u5728\u904e\u671f\u4e4b\u5f8c\uff0c\u539f\u672c\u7684\u6a5f\u5236\uff0c\u53ea\u80fd\u5920\u5728\u7528\u6236\u91cd\u65b0\u64ad\u653e\u7684\u6642\u5019\u66f4\u65b0\u96e2\u7dda\u6191\u8b49\uff0c\u4e0d\u80fd\u4e8b\u5148\u8b93\u7528\u6236\u77e5\u9053\u5df2\u7d93\u904e\u671f\uff0c\u4f7f\u7528\u9ad4\u9a57\u4e26\u4e0d\u53cb\u5584\u3002</li> </ul> <p>Content Key Session \u7368\u7acb\u65bc\u64ad\u653e\u5143\u4ef6\u4e4b\u5916\uff0c\u53ef\u4ee5\u8b93\u7b2c\u4e09\u65b9\u5ee0\u5546\uff0c\u53ef\u4ee5\u5728\u9069\u7576\u7684\u6642\u6a5f\uff0c\u5c31\u6293\u53d6\u3001\u66f4\u65b0 CKC\uff1b\u6b64\u5916\u860b\u679c\u589e\u52a0\u4e86 HEVC \u5f71\u50cf\u683c\u5f0f\u652f\u63f4\u3001IMSC1 \u5b57\u5e55\u3001\u65b0\u7684\u4e0b\u8f09\u7ba1\u7406\u54e1\u5143\u4ef6\u2026\u7b49\u3002\u53c3\u898b Advances in HTTP Live Streaming\u3002</p> <p>\u8ddf Content Key Session \u6709\u95dc\u7684\u90e8\u5206\uff0c\u4e5f\u53ef\u4ee5\u53c3\u898b WWDC 2018 \u7684 AVContentKeySession Best Practices</p>"},{"location":"hls/#wwdc-2019-low-latency-hls","title":"WWDC 2019 - Low Latency HLS","text":"<p>\u5982\u524d\u6240\u8ff0\uff0c\u860b\u679c\u63a8\u51fa Low Latency HLS \u898f\u683c\uff0c\u5617\u8a66\u964d\u4f4e HLS \u7684\u5ef6\u9072\u6642\u9593\u3002</p>"},{"location":"hls/#hlsfairplay-streaming","title":"\u4f7f\u7528 HLS/FairPlay Streaming \u7684\u512a\u7f3a\u9ede","text":"<p>HLS/FairPlay Streaming \u662f\u5728 iOS/macOS/tvOS \u7b49\u860b\u679c\u5e73\u53f0\uff0c\u4ee5\u53ca Safari \u700f\u89bd\u5668\u4e2d\u64ad\u653e\u76f4\u64ad\u4e32\u6d41\u2014\u5c24\u5176\u662f\u53d7\u4fdd\u8b77\u7684\u4e32\u6d41\u2014\u7684\u9996\u9078\uff0c\u6211\u5011\u76f4\u63a5\u4eab\u53d7\u5e73\u53f0\u5b98\u65b9\u7684\u5957\u4ef6\u4ee5\u53ca\u652f\u63f4\u670d\u52d9\u3002</p> <p>\u4f46\uff0c\u7528\u4f86\u64ad\u653e HLS \u7684\u5143\u4ef6\uff0c\u5176\u5be6\u662f\u8a2d\u8a08\u7d66\u5f71\u7247\uff0c\u800c\u4e0d\u662f\u8a2d\u8a08\u7d66\u97f3\u6a02\u670d\u52d9\u7528\u7684\u2014\u5982\u679c\u53ea\u662f HLS\uff0c\u6211\u5011\u9084\u6709\u4e00\u4e9b\u5176\u4ed6\u9078\u64c7\uff0c\u4f46\u5982\u679c\u8981\u64ad\u653e FairPlay DRM \u4fdd\u8b77\u7684\u5167\u5bb9\uff0c\u5c31\u53ea\u6709 AVPlayer \u7b49\u5b98\u65b9\u7684\u5143\u4ef6\u2014\u5f71\u7247\u64ad\u653e\u8edf\u9ad4\u4e26\u4e0d\u6703\u8003\u616e\u4e00\u4e9b\u97f3\u6a02\u64ad\u653e\u7684\u7279\u6b8a\u60c5\u5883\uff0c\u50cf\u662f\u4e00\u4e9b\u7279\u6b8a\u7684\u8ff4\u97f3\u3001\u7b49\u5316\u5668\u6548\u679c\uff0c\u6216\u662f\u6703\u8b93\u5169\u9996\u6b4c\u66f2\u91cd\u758a\u7684\u6de1\u5165\u6de1\u51fa\u6548\u679c\u2014\u6c92\u6709\u4eba\u6703\u628a\u5169\u90e8\u96fb\u5f71\u653e\u5728\u4e00\u8d77\u6df7\u97f3\u64ad\u653e\uff0c\u4f46\u662f\u5728\u97f3\u6a02\u4e0a\u537b\u662f\u975e\u5e38\u5e38\u898b\u7684\u60c5\u5883\u3002</p> <p>\u62ff HLS \u5be6\u4f5c\u97f3\u6a02\u64ad\u653e\uff0c\u5c31\u5f97\u540c\u6211\u5011\u8981\u6368\u68c4\u9019\u4e9b\u97f3\u8a0a\u6548\u679c\uff0c\u5982\u679c\u6211\u5011\u662f\u6253\u9020\u4e00\u5957\u5168\u65b0\u7684\u670d\u52d9\uff0c\u53ef\u80fd\u9084\u53ef\u4ee5\u5f9e\u4e00\u958b\u59cb\u5c31\u4e0d\u6253\u7b97\u652f\u63f4\uff1b\u4f46\u5982\u679c\u4e00\u5957\u7522\u54c1\u4e0a\u7dda\u5df2\u4e45\uff0c\u9019\u4e9b\u6548\u679c\uff0c\u662f\u5df2\u7d93\u5b58\u5728\u7684\u7522\u54c1\u529f\u80fd\uff0c\u90a3\u662f\u5426\u61c9\u8a72\u6539\u7528 AVPlayer \u4ee5\u53ca HLS \u9019\u4e00\u6574\u5957\u6280\u8853\uff0c\u5c31\u5f97\u8981\u505a\u5168\u76e4\u7684\u8a55\u4f30\u3002</p> <p>\u53e6\u5916\uff0c\u5c31\u662f Offline HLS \u7684\u96e2\u7dda\u64ad\u653e\u6388\u6b0a\u6191\u8b49\u66f4\u65b0\u6a5f\u5236\u3002\u6bcf\u90e8 HLS \u4e0b\u8f09\u4e4b\u5f8c\uff0c\u90fd\u6709\u5404\u81ea\u7684 CKC\uff0c\u5728\u66f4\u65b0\u6191\u8b49\u7684\u6642\u5019\uff0c\u4e5f\u8981\u4e00\u90e8\u4e00\u90e8\u5f71\u7247\u5404\u81ea\u66f4\u65b0\u3002\u7531\u65bc\u9019\u4e9b\u6a5f\u5236\u4e3b\u8981\u70ba\u4e86\u5f71\u7247\u800c\u8a2d\u8a08\uff0c\u7dda\u4e0a\u5f71\u8996\u670d\u52d9\u7684\u7528\u6236\uff0c\u5927\u6982\u53ea\u6703\u4e0b\u8f09\u4e00\u5b9a\u6578\u91cf\u7684\u5f71\u7247\uff0c\u800c\u4e14\u5f80\u5f80\u770b\u904e\u4e00\u6b21\u5c31\u522a\u9664\uff0c\u7528\u6236\u5f80\u5f80\u6703\u91cd\u8907\u64ad\u653e\u76f8\u540c\u7684\u97f3\u6a02\uff0c\u4f46\u5f88\u5c11\u91cd\u8907\u89c0\u770b\u76f8\u540c\u7684\u96fb\u5f71\u3002\u5982\u679c\u62ff Offline HLS \u505a\u97f3\u6a02\u670d\u52d9\u7684\u96e2\u7dda\u4e0b\u8f09\u529f\u80fd\uff0c\u6211\u5011\u4e5f\u53ef\u4ee5\u9810\u671f\uff0c\u5982\u679c\u7528\u6236\u4e0b\u8f09\u4e86\u5927\u91cf\u6b4c\u66f2\uff0c\u4f7f\u7528\u9ad4\u9a57\u53ef\u80fd\u4e26\u4e0d\u7406\u60f3\u3002</p> <p>\u800c\u9019\u6574\u5957\u6280\u8853\uff0c\u90fd\u8207\u860b\u679c\u7684\u751f\u614b\u7cfb\u7d81\u5f97\u975e\u5e38\u7dca\u5bc6\uff0c\u5982\u679c\u8981\u5728\u5176\u4ed6\u5e73\u53f0\u4e0a\u4f7f\u7528\u5546\u7528 DRM \u4fdd\u8b77\u5167\u5bb9\uff0c\u5f80\u5f80\u9084\u662f\u5f97\u6311\u9078\u5176\u4ed6\u7684\u65b9\u6848\u3002</p>"},{"location":"misc/","title":"\u9644\u8a3b","text":"<ul> <li>MP3 Parser \u7bc4\u4f8b</li> <li>AAC-ADTS Parser \u7bc4\u4f8b</li> <li>ID3 Parser \u7bc4\u4f8b</li> <li>FLAC Stream Info Encoder \u7bc4\u4f8b</li> <li>\u6587\u4ef6\u7248\u672c</li> </ul>"},{"location":"misc/aac_adts_parser/","title":"AAC-ADTS Parser \u7bc4\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Pyhton 2 \u64b0\u5beb\u7684 ID3 Parser \u7bc4\u4f8b\u3002\u4f5c\u8005\u70ba Oliver Huang\u3002</p> <pre><code>#!/usr/bin/env python\n# encoding: utf-8\n\nimport os\nimport sys\nimport time\n\nclass ADTSParser:\n    '''\n    Parse AAC-ADTS file to find first frame offset and check if there is invalid frame.\n    '''\n    ADTS_MINIMUM_HEADER_SIZE = 7\n\n    class ADTSHeader:\n        # AAAAAAAA AAAABCCD EEFFFFGH HHIJKLMM MMMMMMMM MMMOOOOO OOOOOOPP (QQQQQQQQ QQQQQQQQ)\n        # AAAAAAAA AAAA: syncword\n        # B: MPEG version\n        # CC: Layer\n        # FFFF: Sample rate\n        # HHH: Channel configuration\n        # MM MMMMMMMM MMM: Frame length\n        SampleRateTable = (96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350)\n        def __init__(self, data):\n            assert type(data) is bytearray\n            self.data = data\n\n        def isValid(self):\n            if len(self.data) &lt; ADTSParser.ADTS_MINIMUM_HEADER_SIZE:\n                return False\n            if self.syncword() != 0xfff0:\n                return False\n            if self.MPEGVersion() != 4:\n                return False\n            if self.layer() != 0:\n                return False\n            if self.sampleRate() != 44100:\n                return False\n            if self.channelConfig() != 2:\n                return False\n            return True\n\n        def syncword(self):\n            return (self.data[0] &lt;&lt; 8) | (self.data[1] &amp; 0xf0)\n\n        def MPEGVersion(self):\n            return 4 if (self.data[1] &amp; 0x08) == 0 else 2\n\n        def layer(self):\n            return (self.data[1] &amp; 0x06) &gt;&gt; 1\n\n        def sampleRate(self):\n            index = (self.data[2] &amp; 0x3c) &gt;&gt; 2\n            if index &gt;= len(self.SampleRateTable):\n                return 0\n            return self.SampleRateTable[index]\n\n        def channelConfig(self):\n            return ((self.data[2] &amp; 0x01) &lt;&lt; 2) | ((self.data[3] &amp; 0xc0) &gt;&gt; 6)\n\n        def frameLength(self):\n            if not self.isValid():\n                return 0\n            return ((self.data[3] &amp; 0x03) &lt;&lt; 11) | (self.data[4] &lt;&lt; 3) | ((self.data[5] &amp; 0xe0) &gt;&gt; 5)\n\n    @classmethod\n    def parseAACFile(self, inInputFilePath):\n        '''\n        Check if all frames are valid and get offset of first frame.\n\n        A valid frame will be MPEG-4, 2-channels and sample rate 44.1 KHz.\n\n        This function will find first two valid frames without bytes between it.\n\n        If we encounter frame that is not valid after first frame, we return False.\n\n        Otherwise, this function will return True.\n\n        :param inInputFilePath: the aac file path to check.\n        :type inInputFilePath: str\n        :returns: A tuple (first ADTS frame offset, whether all frames after offset are valid)\n        :rtype: 2-tuple\n\n        '''\n        inputFile = open(inInputFilePath, 'rb')\n        content = bytearray(inputFile.read())\n        inputFile.close()\n\n        return self.isAllFramesInDataValid(content)\n\n    @classmethod\n    def isAllFramesInDataValid(self, content):\n        '''\n        Check if all frames are valid in bytes.\n\n        :param content: audio content to check.\n        :type content: bytearray\n        :returns: A tuple (first ADTS frame offset, whether all frames after offset are valid)\n        :rtype: 2-tuple\n\n        '''\n        offset = 0\n        firstOffset = -1\n        length = len(content)\n        tStart = time.time()\n        tLast = tStart\n\n        while offset + self.ADTS_MINIMUM_HEADER_SIZE &lt; length:\n            tCurrect = time.time()\n            if tCurrect - tLast &gt; 1:\n                print 'Total file length: %d, current offset: %d, time elapsed: %.3f' % (length, offset, tCurrect - tStart)\n                tLast = tCurrect\n\n            frame = self.ADTSHeader(content[offset:offset + self.ADTS_MINIMUM_HEADER_SIZE])\n            if firstOffset == -1:\n                if frame.isValid() and frame.frameLength() &gt; 0:\n                    secondOffset = offset + frame.frameLength()\n                    if secondOffset + self.ADTS_MINIMUM_HEADER_SIZE &gt; length:\n                        return (-1, False)\n                    second = self.ADTSHeader(content[secondOffset:secondOffset + self.ADTS_MINIMUM_HEADER_SIZE])\n                    if second.isValid() and second.frameLength() &gt; 0:\n                        firstOffset = offset\n                        offset = secondOffset + second.frameLength()\n                        continue\n                offset += 1\n            elif not frame.isValid():\n                return (-1, False)\n            else:\n                offset += frame.frameLength()\n\n        return (firstOffset, firstOffset &gt;= 0)\n\ndef printUsage():\n    print '''Usage: python %s [AAC file]\nExample: python %s 24023614.aac\nIt will find first ADTS frame offset and parse all frames in aac file and return parse result as bool.''' % (sys.argv[0], sys.argv[0])\n\nif __name__ == '__main__':\n    if len(sys.argv) != 2:\n        printUsage()\n        exit()\n    filename = sys.argv[1]\n    if not os.path.exists(filename):\n        print 'File not found: %s' % (filename)\n        printUsage()\n        exit()\n    offset, isValid = ADTSParser.parseAACFile(filename)\n    print isValid\n    if isValid:\n        print \"First frame offset: %d\" % offset\n</code></pre>"},{"location":"misc/flac_streaminfo/","title":"FLAC Stream Info Encoder \u7bc4\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Pyhton 2 \u64b0\u5beb\u7684 FLAC Stream Info Encoder \u7bc4\u4f8b\u3002\u4f5c\u8005\u70ba zonble\u3002</p> <pre><code>#!/usr/bin/env python\n# encoding: utf-8\n\nclass BitWriter:\n    def __init__(self):\n        super().__init__()\n        self.out_data = bytearray()\n        self._out_byte = 0\n        self._out_count = 0\n\n    def write_bit(self, bit):\n        self._out_byte = (self._out_byte &lt;&lt; 1) | (1 if bit == True else 0)\n        self._out_count += 1\n        if self._out_count == 8:\n            self.out_data.append(self._out_byte)\n            self._out_byte = 0\n            self._out_count = 0\n\n    def flush(self):\n        if self._out_count == 0:\n            return\n        if self._out_count &lt; 8:\n            self._out_byte = self._out_byte &lt;&lt; (8 - self._out_count)\n        self.out_data.append(self._out_byte)\n        self._out_byte = 0\n        self._out_count = 0\n\n    def write_unsigned_int(self, number, bit_count):\n        for i in range(bit_count -1, -1, -1):\n            bit = (number &amp; (1&lt;&lt;i)) != 0\n            self.write_bit(bit)\n\nclass StreamInfo:\n    MIN_BLOCK_SIZE_LEN = 16\n    MAX_BLOCK_SIZE_LEN = 16\n    MIN_FRAME_SIZE_LEN = 24\n    MAX_FRAME_SIZE_LEN = 24\n    SAMPLE_RATE_LEN = 20\n    CHANNELS_LEN = 3\n    BITS_PER_SAMPLE_LEN = 5\n    TOTAL_SAMPLES_LEN = 36\n    MD5SUM_LEN = 128\n\n    def __init__(self, **kwargs):\n        super().__init__()\n        self.is_last_metadata_block = kwargs.get('is_last_metadata_block', True)\n        self.min_block_size = kwargs.get('min_block_size', 4608)\n        self.max_block_size = kwargs.get('max_block_size', 4608)\n        self.min_frame_size = kwargs.get('min_frame_size', 14)\n        self.max_frame_size = kwargs.get('max_frame_size', 15521)\n        self.sample_rate = kwargs.get('sample_rate', 48000)\n        self.n_channels = kwargs.get('n_channels', 2)\n        self.bits_per_channel = kwargs.get('bits_per_channel', 16)\n        self.n_samples = kwargs.get('n_samples', 0)\n        self.checksum = None\n\n    def data(self, withHeader = True):\n        writer = BitWriter()\n        if withHeader:\n            writer.write_unsigned_int(1 if self.is_last_metadata_block else 0, 1)\n            writer.write_unsigned_int(0, 7)\n            length = (StreamInfo.MIN_BLOCK_SIZE_LEN +\n                StreamInfo.MAX_BLOCK_SIZE_LEN +\n                StreamInfo.MIN_FRAME_SIZE_LEN +\n                StreamInfo.MAX_FRAME_SIZE_LEN +\n                StreamInfo.SAMPLE_RATE_LEN +\n                StreamInfo.CHANNELS_LEN +\n                StreamInfo.BITS_PER_SAMPLE_LEN +\n                StreamInfo.TOTAL_SAMPLES_LEN +\n                StreamInfo.MD5SUM_LEN) / 8\n            writer.write_unsigned_int(int(length), 24)\n        writer.write_unsigned_int(self.min_block_size, StreamInfo.MIN_BLOCK_SIZE_LEN)\n        writer.write_unsigned_int(self.max_block_size, StreamInfo.MAX_BLOCK_SIZE_LEN)\n        writer.write_unsigned_int(self.min_frame_size, StreamInfo.MIN_FRAME_SIZE_LEN)\n        writer.write_unsigned_int(self.max_frame_size, StreamInfo.MAX_FRAME_SIZE_LEN)\n        writer.write_unsigned_int(self.sample_rate, StreamInfo.SAMPLE_RATE_LEN)\n        writer.write_unsigned_int(self.n_channels -1, StreamInfo.CHANNELS_LEN)\n        writer.write_unsigned_int(self.bits_per_channel -1, StreamInfo.BITS_PER_SAMPLE_LEN)\n        writer.write_unsigned_int(self.n_samples, StreamInfo.TOTAL_SAMPLES_LEN)\n        data = writer.out_data\n        if self.checksum != None and len(self.checksum) == 16:\n            data += self.checksum\n        else:\n            writer.write_unsigned_int(0, StreamInfo.MD5SUM_LEN)\n            data = writer.out_data\n        return data\n</code></pre>"},{"location":"misc/id3_parser/","title":"ID3 Parser \u7bc4\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Pyhton 2 \u64b0\u5beb\u7684 ID3 Parser \u7bc4\u4f8b\u3002\u4f5c\u8005\u70ba zonble\u3002</p> <pre><code>#!/usr/bin/env python\n# encoding: utf-8\n\n'''\nThe :mod:`KKID3TagReader` module helps to read ID3 tags from an MP3 audio\nfile.\n'''\n\ndef _parseID3TagsFromFileStream(f):\n    '''\n    Parses ID3 tags from a file stream\n\n    :param f: path of the file.\n    :type f: file\n    :returns: ID3 tags\n    :rtype: list\n\n    .. note:: Not tested on IronPython.\n    '''\n    HEADER_LENGTH = 10\n    HEADER_BODY_LENGTH_INFO_OFFSET = 6\n    HEADER_BODY_LENGTH_INFO_LENGTH = 4\n    FRAME_HEADER_LENGTH = 10\n    FRAME_ID_LENGTH = 4\n    FRAME_BODY_LENGTH_INFO_LENGTH = 4\n\n    def _readUInt28(bytes):\n        MASK = lambda bits : ((1 &lt;&lt; (bits)) - 1)\n        BITSUSED = 7\n        val = 0\n        for byte in bytes: val =  (val &lt;&lt; BITSUSED) | (byte &amp; MASK(BITSUSED))\n        return min(val,  MASK(BITSUSED * 4))\n\n    bytes = bytearray(f.read())\n    ID3TagHeader = bytes[0:HEADER_LENGTH]\n    if not str(ID3TagHeader).startswith('ID3'): return {}\n\n    tags = {}\n    ID3TagBodyLength = _readUInt28(list(ID3TagHeader)[HEADER_BODY_LENGTH_INFO_OFFSET:HEADER_BODY_LENGTH_INFO_OFFSET+HEADER_BODY_LENGTH_INFO_LENGTH])\n    readHead = HEADER_LENGTH\n    while readHead &lt; ID3TagBodyLength:\n        frameHeader = bytes[readHead:readHead + FRAME_HEADER_LENGTH]\n        frameID = str(frameHeader[0:FRAME_ID_LENGTH])\n        frameBodyLength = _readUInt28(frameHeader[FRAME_ID_LENGTH:FRAME_ID_LENGTH + FRAME_BODY_LENGTH_INFO_LENGTH])\n\n        frameBody = bytes[readHead + FRAME_HEADER_LENGTH : readHead + FRAME_HEADER_LENGTH + frameBodyLength]\n        textEncodingType = int(frameBody[0])\n        frameContent = frameBody[1:]\n        frameContent = [\n            lambda x : str(x),\n            lambda x : x.decode('utf-16'),\n            lambda x : x.decode('utf-16-be'),\n            lambda x : x.decode('utf-8')\n            ][textEncodingType](frameContent) if textEncodingType &lt;= 3 \\\n                else str(frameContent)\n        if str(frameID).startswith('NORV') or str(frameID).startswith('T'):\n            tags[unicode(frameID)] = frameContent.strip()\n        readHead += FRAME_HEADER_LENGTH + frameBodyLength\n    return tags\n\ndef parseID3TagsFromFileStream(f):\n    try:\n        return _parseID3TagsFromFileStream(f)\n    except Exception, e:\n        raise(e)\n\ndef parseID3TagsFromFilepath(path):\n    '''\n    Parses ID3 tags from a specific MP3 audio file.\n\n    :param path: path of the file.\n    :type path: str\n    :returns: ID3 tags\n    :rtype: list\n    '''\n    return parseID3TagsFromFileStream(open(path, 'rb'))\n</code></pre>"},{"location":"misc/mp3_parser/","title":"MP3 Parser \u7bc4\u4f8b","text":"<p>\u4ee5\u4e0b\u662f\u4f7f\u7528 Pyhton 2 \u64b0\u5beb\u7684 MP3 \u4ee5\u53ca ID3 Parser \u7bc4\u4f8b\u3002\u4f5c\u8005\u70ba zonble\u3002</p> <pre><code>#!/usr/bin/env python\n# encoding: utf-8\n\nimport os\nimport sys\nimport struct\n\nclass MP3Parser:\n    '''\n    Parse mp3 file to check if there is invalid frame.\n    '''\n\n    class _Header:\n        '''\n        Represent the ID3 header in a tag.\n        '''\n        def __init__(self):\n            self.majorVersion = 0\n            self.revision = 0\n            self.flags = 0\n            self.size = 0\n            self.bUnsynchronized = False\n            self.bExperimental = False\n            self.bFooter = False\n\n        def __str__(self):\n            return str(self.__dict__)\n\n    @classmethod\n    def _getSyncSafeInt(self, bytes):\n        '''\n        Get integer from 4 bytes\n        '''\n        assert len(bytes) == 4\n        if type(bytes) == type(''):\n            bytes = [ ord(c) for c in bytes ]\n        return (bytes[0] &lt;&lt; 21) + (bytes[1] &lt;&lt; 14) + (bytes[2] &lt;&lt; 7) + bytes[3]\n\n    @classmethod\n    def isAllFramesValid(self, inInputFilePath):\n        '''\n        Check if all frames are valid.\n\n        If we encounter frame that is not MPEG version 1, layer 3,\n        sample rate 44.1 KHz, we return False.\n\n        Because MP3 File should be frame after frame, if we skip any\n        byte between frames, we return False.\n\n        Otherwise, this function will return True.\n\n        :param inInputFilePath: the mp3 file path to check.\n        :type inInputFilePath: str\n        :returns: whether all frames are valid.\n        :rtype: bool\n\n        '''\n        content = self.loadFile(inInputFilePath)\n        return self.isAllFramesInDataValid(content)\n\n    @classmethod\n    def isAllFramesInDataValid(self, content, offset = 0, shouldCheckID3Tag = True):\n        '''\n        Check if all frames are valid in bytes.\n\n        :param offset: offset into content.\n        :type offset: integer\n        :param shouldCheckID3Tag: whether we should check for id3 tag\n            or not.\n        :type shouldCheckID3Tag: bool\n\n        '''\n        if offset &gt; len(content):\n            return False\n        MP3BitrateLookup = [0, 32000, 40000, 48000, 56000, 64000, 80000, 96000, 112000, 128000, 160000, 192000, 224000, 256000, 320000, 0]\n\n        # The first 512 bytes are Internal Header, so we can skip them.\n        # Based on mac's code, it seems that we always will get ID3\n        # tag, so we can also just scan for ID3 tag.\n        i = offset\n        foundFirstFrame = False\n\n        # skip id3 tag\n        while i + 10 &lt; len(content) and shouldCheckID3Tag:\n            header = content[i:i+10]\n            hstuff = struct.unpack(\"!3sBBBBBBB\", str(header))\n            if hstuff[0] == \"ID3\":\n                header = self._Header()\n                header.majorVersion = hstuff[1]\n                header.revision = hstuff[2]\n                header.flags = hstuff[3]\n                header.size = self._getSyncSafeInt(hstuff[4:8])\n                hasFooter = not not (header.flags &amp; 0x40)\n                headerBodylength = header.size\n                headerLength = headerBodylength + (20 if hasFooter else 10)\n                i += headerLength\n                break\n            else:\n                i += 1\n\n        while i + 2 &lt; len(content):\n            frameSync = (content[i] &lt;&lt; 8) | (content[i + 1] &amp; (0x80 | 0x40 | 0x20))\n            if frameSync != 0xffe0:\n                if foundFirstFrame:\n                    # After founding first frame, we shouldn't skip\n                    # any byte, so if we execute to here, there is an\n                    # error.\n                    # print 'skipping byte at:' + repr(i)\n                    pass\n                i += 1\n                continue\n\n\n            # frame start\n            if not foundFirstFrame:\n                foundFirstFrame = True\n            # print i\n            # AAAAAAAA AAABBCCD EEEEFFGH IIJJKLMM\n            audioVersion = (content[i + 1] &gt;&gt; 3) &amp; 0x03;\n            layer = (content[i + 1] &gt;&gt; 1) &amp; 0x03\n            hasCRC = not(content[i + 1] &amp; 0x01)\n            bitrateIndex = content[i + 2] &gt;&gt; 4;\n            sampleRateIndex = content[i + 2] &gt;&gt; 2 &amp; 0x03;\n            # print 'audioVersion:%d, layer:%d, sampleRateIndex:%d' % (audioVersion, layer, sampleRateIndex)\n            if not(audioVersion == 0x03 and\n                   layer == 0x01 and\n                   sampleRateIndex == 0x00):\n                # we only support MPEG version 1, layer 3, sample rate\n                # 44.1 KHz--and we ignore the error altogether\n                print \"Unsupported MPEG audio version.\"\n                return False\n\n            bitrate = MP3BitrateLookup[bitrateIndex];\n            hasPadding = not(not((content[i + 2] &gt;&gt; 1) &amp; 0x01))\n            # print 'hasCRC:%d, hasPadding:%d' % (hasCRC, hasPadding)\n\n            frameLength = 144 * bitrate / 44100 + \\\n                          (1 if hasPadding else 0) + \\\n                          (2 if hasCRC else  0)\n            i += frameLength\n        if not foundFirstFrame:\n            return False\n        return True\n\n    @classmethod\n    def loadFile(self, inInputFilePath):\n        '''\n        Load file into bytearray\n\n        :param inInputFilePath: path of the input file.\n        :type inInputFilePath: str\n        '''\n        inputFile = open(inInputFilePath, 'rb')\n        data = bytearray(inputFile.read())\n        inputFile.close()\n        return data\n\ndef printUsage():\n    print '''Usage: python %s [MP3 file]\nExample: python %s 1311434.mp3\nIt will parse all frames in mp3 file and return parse result as bool.''' % (sys.argv[0], sys.argv[0])\n\nif __name__ == '__main__':\n    if len(sys.argv) != 2:\n        printUsage()\n        exit()\n    filename = str(sys.argv[1])\n    if not(os.path.exists(filename)):\n        print 'File not found: %s' % (filename)\n        printUsage()\n        exit()\n    result = MP3Parser.isAllFramesValid(filename)\n    print result\n</code></pre>"},{"location":"misc/version/","title":"\u6587\u4ef6\u7248\u672c","text":"<ul> <li>2022 \u5e74\u4e8c\u6708\u7b2c\u4e00\u6b21\u767c\u5e03\u516c\u958b\u7248\u672c</li> <li>2023 \u5e74\u56db\u6708\u8f49\u63db\u6210 MkDocs \u683c\u5f0f</li> </ul>"},{"location":"mp3/","title":"MP3 \u683c\u5f0f","text":"<p>Internet \u5728\u4e0a\u500b\u4e16\u7d00 90 \u5e74\u4ee3\u958b\u59cb\u666e\u53ca\u3002\u4e00\u9996\u9304\u88fd\u5728 CD \u4e0a\u7684\u4e09\u5206\u9418\u9577\u5ea6\u7684\u6b4c\u66f2\uff0c\u5927\u6982\u5c31\u8981 30mb\uff0c\u4ee5\u90a3\u500b\u6642\u4ee3\u7684\u983b\u5bec\u4f86\u8aaa\uff0c\u50b3\u905e\u9019\u6a23\u7684\u6a94\u6848\u662f\u975e\u5e38\u5403\u529b\u7684\u4e8b\u60c5\u3002</p> <p>\u4f46\u662f\uff0c\u5728 MP3 \u683c\u5f0f\u51fa\u73fe\u4e4b\u5f8c\uff0c\u4e00\u9996 30mb \u5927\u5c0f\u7684\u6b4c\u66f2\u8b8a\u6210\u4e86 3mb \u5927\u5c0f\uff0c\u8b8a\u6210\u53ef\u4ee5\u65b9\u4fbf\u5730\u5728\u7db2\u8def\u4e0a\u50b3\u4f48\uff0c\u65bc\u662f\uff0c\u7121\u8ad6\u662f\u7528\u6236\u5728\u975e\u6cd5 P2P \u8edf\u9ad4\u4e0a\u5927\u91cf\u6563\u4f48\u3001\u50b3\u905e MP3\uff0c\u6216\u662f\u5f8c\u4f86\u51fa\u73fe\u900f\u904e\u7db2\u8def\u8cfc\u8cb7\u97f3\u6a94\u7684\u97f3\u6a02\u5546\u5e97\uff0c\u751a\u81f3\u66f4\u5f8c\u4f86\u51fa\u73fe\u4e86\u6708\u8cbb\u5236\u97f3\u6a02\u670d\u52d9\u3001\u751a\u81f3\u662f Freemium \u5546\u696d\u6a21\u5f0f\uff0cMP3 \u90fd\u6574\u500b\u6539\u8b8a\u4e86\u97f3\u6a02\u7522\u696d\u4ee5\u53ca\u6574\u500b\u4e16\u754c\u3002</p> <p>\u6211\u5011\u5728\u9019\u908a\u7565\u904e MP3 \u7684\u6b77\u53f2\uff0cMP3 \u5982\u4f55\u6210\u70ba\u898f\u683c\uff0c\u4ee5\u53ca\u97f3\u6a02\u7522\u696d\u767c\u751f\u7684\u8b8a\u5316\uff0c\u53ea\u8a0e\u8ad6 MP3 \u662f\u600e\u6a23\u7684\u683c\u5f0f\uff0c\u4ee5\u53ca\u5de5\u7a0b\u5e2b\u53ef\u4ee5\u5982\u4f55\u8655\u7406 MP3 \u6a94\u6848\u3002</p> <p>MP3 \u662f\u4e00\u7a2e\u58d3\u7e2e\u683c\u5f0f\uff0c\u65bc\u662f\u8b93\u6a94\u6848\u8b8a\u5c0f\uff0c\u66f4\u7cbe\u78ba\u4f86\u8aaa\uff0c\u662f\u4e00\u7a2e\u7834\u58de\u5f0f\u58d3\u7e2e\u6a94\u6848\uff0c\u5728\u58d3\u7e2e\u5730\u904e\u7a0b\u4e2d\uff0c\u6703\u6368\u68c4\u6389\u4e00\u4e9b\u767c\u660e\u9019\u500b\u683c\u5f0f\u6642\u3001\u89ba\u5f97\u53ef\u4ee5\u6368\u68c4\u6389\u7684\u90e8\u4efd\uff0c\u5982\u679c\u6211\u5011\u628a CD \u4e0a\u7684\u6b4c\u66f2\u8f49\u6210 MP3\uff0c\u96d6\u7136\u9084\u662f\u6709\u8fa6\u6cd5\u53ef\u4ee5\u518d\u8f49\u63db\u56de CD \u683c\u5f0f\u7684 PCM \u6a94\u6848\uff0c\u4f46\u9019\u6a23\u7684\u6a94\u6848\u5df2\u7d93\u8ddf\u539f\u672c\u7684\u6a94\u6848\u4e0d\u540c\u4e86\u3002</p>"},{"location":"mp3/#bit-rate","title":"Bit Rate","text":"<p>Bit rate \u5728\u4e2d\u6587\u5f88\u591a\u6642\u5019\u53eb\u505a\u6bd4\u7279\u7387\uff0c\u63cf\u8ff0\u7684\u662f\u58d3\u7e2e\u97f3\u6a94\u88ab\u58d3\u7e2e\u5230\u4ec0\u9ebc\u7a0b\u5ea6\uff0c\u55ae\u4f4d\u662f bps\uff08bits per seconds\uff0c\u4e00\u79d2\u7684\u97f3\u8a0a\u9700\u8981\u591a\u5c11 bit\uff09\u3002</p> <p>\u6211\u5011\u5e38\u898b\u6240\u8b02 128k\u3001192k\u3001320k \u9019\u4e9b\u55ae\u4f4d\uff0c\u610f\u601d\u662f\uff0c\u4e00\u79d2\u9418\u7684\u58d3\u7e2e\u97f3\u6a94\uff0c\u6703\u9700\u8981\u7528\u5230\u591a\u5c11 bit \u7684\u8cc7\u6599\uff0c\u4ee5 128k \u4f86\u8aaa\uff0c\u5c31\u662f\u4e00\u79d2\u9418\u6709 128 k \u7684 bit\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u63db\u7b97\u6210 byte\uff0c\u5c31\u662f 128 * 1024 / 8\uff08\u4e00\u500b byte \u6709 8 \u500b bit\uff09\uff0c\u6211\u5011\u53ef\u4ee5\u5f97\u5230 16,384 bytes\uff0c\u56e0\u6b64\u6211\u5011\u53ef\u4ee5\u7b97\u51fa\uff0c\u5982\u679c\u662f\u4e00\u9996\u4e09\u5206\u9418\u7684\u6b4c\u66f2\uff0c\u5728\u56fa\u5b9a\u78bc\u7387\u7684\u72c0\u6cc1\uff0c\u6a94\u6848\u5927\u5c0f\u5c31\u5728 3mb \u5de6\u53f3\uff08128 * 1024 / 8 * 3 * 60 = 2949120\uff09\u3002</p> <p>\u5728\u58d3\u7e2e\u904e\u7a0b\u4e2d\uff0c\u9084\u6709\u6240\u8b02\u7684\u8b8a\u52d5\u78bc\u7387\uff08 VBR\uff0cVariable Bit Rate\uff09\u8207\u56fa\u5b9a\u78bc\u7387\uff08 CBR\uff0cConstant Bit Rate\uff09\u3002\u5982\u679c\u67d0\u500b packet \u7576\u4e2d\u51fa\u73fe\u7684\u6578\u5b57\u90fd\u975e\u5e38\u8fd1\u4f3c\uff0c\u50cf\u662f\u9019\u500b packet \u4e2d\u7684\u8072\u97f3\u90fd\u662f\u975c\u97f3\u7684\uff0c\u90a3\u9ebc\uff0c\u6211\u5011\u5c31\u6709\u6a5f\u6703\u53ef\u4ee5\u628a\u9019\u500b packet \u58d3\u7e2e\u5f97\u66f4\u5c0f\uff0c\u65bc\u662f\uff0c\u6211\u5011\u5c31\u53ef\u4ee5\u628a\u6574\u500b MP3 \u6a94\u6848\u58d3\u7e2e\u5f97\u66f4\u5c0f\uff0c\u800c\u6bcf\u500b packet \u7684\u5927\u5c0f\u5247\u4e0d\u4e00\uff0c\u9019\u5c31\u662f\u8b8a\u52d5\u78bc\u7387\u3002\u5982\u679c\u6211\u5011\u95dc\u9589\u9019\u7a2e\u884c\u70ba\uff0c\u8b93\u6bcf\u500b packet \u7684\u5927\u5c0f\u56fa\u5b9a\uff0c\u5c31\u662f\u56fa\u5b9a\u78bc\u7387\u3002</p>"},{"location":"mp3/#packet-mp3","title":"Packet\u3001\u4ee5\u53ca MP3 \u6a94\u6848\u7684\u9577\u5ea6","text":"<p>\u5728\u5c07 PCM \u7de8\u78bc\u6210 MP3 \u683c\u5f0f\u7684\u6642\u5019\uff0c\u6211\u5011\u4e26\u4e0d\u662f\u76f4\u63a5\u58d3\u7e2e\u6574\u500b\u6a94\u6848\uff0c\u800c\u662f\u5148\u5c07\u9023\u7e8c\u7684 Binary Data \u5207\u6210\u8a31\u591a\u5c0f\u584a\u7684\u8cc7\u6599\uff0c\u628a\u4e00\u5c0f\u584a\u3001\u4e00\u5c0f\u584a\u7684\u8cc7\u6599\u58d3\u7e2e\u8d77\u4f86\u4e4b\u5f8c\uff0c\u518d\u628a\u58d3\u7e2e\u5f8c\u7684\u8cc7\u6599\u9023\u63a5\u8d77\u4f86\u3002\u7528\u4f86\u5c0d\u9019\u6a23\u5c0f\u584a\u8cc7\u6599\u505a\u58d3\u7e2e/\u89e3\u58d3\u7e2e\u7684\u7a0b\u5f0f\uff0c\u53eb\u505a codec\uff0c\u6bcf\u4e00\u500b\u5c0f\u584a\u7684\u55ae\u4f4d\uff0c\u53eb\u505a packet\uff08\u901a\u5e38\u5728\u53f0\u7063\u7a31\u547c packet \u70ba\u5c01\u5305\uff09\u3002\u6216\u9019\u9ebc\u8aaa\uff1acodec \u5c31\u662f\u8ca0\u8cac\u58d3\u7e2e/\u89e3\u58d3\u7e2e packet \u7684\u7a0b\u5f0f\u3002</p> <p>\u5728 MP3 \u683c\u5f0f\u4e2d\uff0c\u6bcf\u500b packet \u7576\u4e2d\uff0c\u901a\u5e38\u6703\u6709 1152 \u500b\u63a1\u6a23\uff08\u5176\u5be6\u4e5f\u53ef\u80fd\u6703\u6709 384 \u6216 576 \u9019\u6a23\u7684\u63a1\u6a23\u6578\u5b57\uff0c\u4f46\u5be6\u5728\u5f88\u5c11\u7528\u5230\uff09\uff0c\u5982\u6b64\u4e00\u4f86\uff0c\u5c31\u5f80\u5f80\u6703\u9047\u5230\u5fc5\u9808\u8981\u5728\u6700\u5f8c\u4e00\u500b packet \u4e2d\uff0c\u900f\u904e\u586b\u5165 0 \u88dc\u8db3 packet \u9577\u5ea6\u7684\u60c5\u5f62\uff0c\u53e6\u5916\uff0c\u8a31\u591a\u7684 encoder \u4e5f\u6703\u5728\u6a94\u6848\u7684\u524d\u5f8c\u88dc\u4e0a\u4e00\u4e9b\u975c\u97f3\u7684\u63a1\u6a23\uff08\u50cf LAME \u9019\u500b encoder \u5c31\u662f\u5982\u6b64\uff0c\u53c3\u898b LAME \u7684\u8aaa\u660e\uff09\u3002\u56e0\u6b64\uff0c\u6211\u5011\u8981\u6709\u4e00\u500b\u91cd\u8981\u7684\u89c0\u5ff5\uff1a\u7576\u6211\u5011\u5728\u8f49\u63db\u97f3\u6a94\u683c\u5f0f\u7684\u6642\u5019\uff0c\u97f3\u6a94\u7684\u9577\u5ea6\u662f\u6703\u6539\u8b8a\u7684\u3002</p> <p>\u4ee5 CD \u97f3\u8cea\u4f86\u8aaa\uff0c\u7531\u65bc\u4e00\u79d2\u9418\u6709 44100 \u500b\u63a1\u6a23\uff0c\u4e5f\u5c31\u4ee3\u8868\uff0c\u9019\u500b\u6a94\u6848\u4e2d\u7684\u6700\u5c0f\u6642\u9593\u55ae\u4f4d\u662f 1/44100 \u79d2\uff0c\u800c MP3 \u683c\u5f0f\u7684\u6700\u5c0f\u6642\u9593\u55ae\u4f4d\u5247\u662f 1152/44100 \u79d2\uff1b\u5047\u4f7f\u6211\u5011\u73fe\u5728\u6709\u4e00\u500b\u525b\u597d\u4e00\u79d2\u9418\u7684 PCM \u6a94\u6848\uff0c\u60f3\u8981\u8f49\u63db\u6210 MP3 \u683c\u5f0f\uff0c44100/1152 \u662f 38.28125\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u5b8c\u6574\u5305\u542b\u9019\u4e00\u79d2\u7684\u8cc7\u6599\uff0cMP3 \u683c\u5f0f\u5c31\u5f97\u7528\u5230 39 \u500b packet\uff0c\u4f46\u662f\u7b2c 39 \u500b packet \u5f97\u5728\u5f8c\u9762\u88dc\u4e0a\u96f6\uff0c\u800c\u8f49\u51fa\u4f86\u7684 MP3 \u4e5f\u4e0d\u6703\u662f\u4e00\u79d2\u9418\uff0c\u800c\u662f 1.0187755102 \u79d2\u3002</p> <p>Client \u7aef\u7684 player \u5728\u64ad\u653e MP3 \u6642\uff0c\u4e0d\u7528\u628a\u9019\u500b\u6a94\u6848\u5168\u90e8\u6293\u4e0b\u4f86\uff0c\u53ea\u8981\u7d2f\u7a4d\u4e00\u5b9a\u9577\u5ea6\u7684\u8cc7\u6599\uff0c\u8a8d\u70ba\u9019\u500b\u9577\u5ea6\u8db3\u5920\u9806\u66a2\u64ad\u653e\uff0c\u5c31\u6703\u958b\u59cb\u64ad\u653e\u3002\u8a08\u7b97\u7684\u65b9\u5f0f\u5c31\u662f\u770b\u7d2f\u7a4d\u4e86\u591a\u5c11 packet\uff1a\u5f9e\u4e0a\u9762\u90a3\u500b\u4f8b\u5b50\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\uff0c\u5982\u679c Player \u627e\u5230\u4e86 39 \u500b packet\uff0c\u5c31\u53ef\u4ee5\u7b97\u51fa\uff0c\u9019\u500b\u6a94\u6848\u6709\u5927\u6982\u4e00\u79d2\u5de6\u53f3\u7684\u8cc7\u6599\uff1b\u5982\u679c client \u7aef\u89ba\u5f97\uff0c\u6709\u4e86\u4e94\u79d2\u9418\u5de6\u53f3\u7684\u8cc7\u6599\uff0c\u5c31\u53ef\u4ee5\u64ad\u653e\uff0c\u90a3\u5c31\u53ef\u4ee5\u958b\u59cb\u5c07 MP3 \u8f49\u63db\u6210 PCM \u64ad\u653e\u3002\u5982\u679c\u7db2\u8def\u6709\u9ede\u5361\u9813\uff0c\u9020\u6210\u67d0\u6bb5\u8cc7\u6599\u64ad\u653e\u5b8c\u7562\uff0c\u4f46\u662f\u7b49\u4e0d\u5230\u63a5\u4e0b\u4f86\u7684\u8cc7\u6599\uff0c\u9019\u6642\u5019 player \u5c31\u6703\u9032\u5165\u6240\u8b02 stall \u7684\u72c0\u614b\uff1aplayer \u6703\u5148\u66ab\u505c\uff0c\u7b49\u5230\u7e7c\u7e8c\u7d2f\u7a4d\u5230\u5920\u591a\u7684 packet\uff0c\u624d\u63a5\u7e8c\u64ad\u653e\u3002</p> <p>\u800c\u60f3\u8981\u77e5\u9053\u4e00\u9996 MP3 \u6b4c\u66f2\u6709\u591a\u9577\uff0c\u5c31\u662f\u628a\u9019\u500b\u6a94\u6848\u8b80\u904e\u4e00\u6b21\uff0c\u627e\u51fa\u9019\u500b\u6a94\u6848\u6709\u591a\u5c11 packet\uff0c\u7136\u5f8c\u7528 packet \u7684\u6578\u91cf\u7b97\u51fa\u6642\u9593\u3002</p> <p>\u6240\u4ee5\uff0c\u539f\u672c\u662f\u540c\u4e00\u9996\u6b4c\u66f2\uff0c\u7d93\u904e\u8f49\u6a94\u4e4b\u5f8c\uff0c\u5728\u4e0d\u540c\u683c\u5f0f\u4e0b\u7684\u9577\u5ea6\u662f\u4e0d\u540c\u7684\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u5728\u7d93\u71df\u97f3\u6a02\u670d\u52d9\uff0c\u60f3\u8981\u7d71\u8a08\u7528\u6236\u5c0d\u4e00\u9996\u6b4c\u66f2\u5230\u5e95\u64ad\u653e\u4e86\u591a\u5c11\u6642\u9593\uff0c\u4e5f\u5fc5\u9808\u628a\u9019\u4e9b\u5dee\u7570\u8003\u616e\u9032\u53bb\uff0c\u5373\u4f7f\u7528\u6236\u64ad\u653e\u7684\u662f\u540c\u4e00\u9996\u6b4c\u66f2\uff0c\u4f46\u56e0\u70ba\u9078\u64c7\u4e86\u4e0d\u540c\u7684\u683c\u5f0f\uff0c\u6700\u5f8c\u56de\u5831\u7684\u64ad\u653e\u9577\u5ea6\uff0c\u4e5f\u9084\u662f\u6703\u6709\u6beb\u79d2\u7b49\u7d1a\u7684\u5dee\u5225\u3002\u6bd4\u65b9\u8aaa\uff0c\u5982\u679c\u4f60\u540c\u6642\u63d0\u4f9b\u4e00\u9996\u6b4c\u66f2\u7684 MP3 \u8207 AAC \u7248\u672c\uff0c\u5728 AAC \u683c\u5f0f\u4e2d\uff0c\u4e00\u500b packet \u7684\u5927\u5c0f\u662f 1024\uff0c\u6240\u4ee5\uff0cMP3 \u8207 AAC \u683c\u5f0f\u7684\u9577\u5ea6\u5c31\u662f\u4e0d\u540c\u7684\u3002</p> <p>\u4ee5\u5716\u5f62\u8868\u793a MP3 \u683c\u5f0f\uff0c\u5927\u6982\u6703\u50cf\u9019\u6a23\uff1a</p> <p></p>"},{"location":"mp3/#mp3-frame-header","title":"MP3 Frame Header","text":"<p>\u4e00\u500b MP3 \u6a94\u6848\u4e2d\uff0c\u6240\u5305\u542b\u7684\u662f\u9023\u7e8c\u7684 Binary Data\uff0c\u4e0d\u904e\uff0c\u5728\u6211\u5011\u7de8\u88fd MP3 \u6a94\u6848\u7684\u6642\u5019\uff0c\u6703\u5728\u6bcf\u500b packet \u524d\u65b9\u52a0\u4e0a\u4e00\u5c0f\u6bb5 header\uff0c\u7531\u65bc\u9019\u7a2e header \u6709\u660e\u986f\u7684\u7279\u5fb5\uff0cPlayer \u53ea\u8981\u627e\u5230 header\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053\u54ea\u88e1\u662f packet \u7684\u958b\u982d\u8207\u7d50\u5c3e\uff0c\u628a packet \u8cc7\u6599\u62bd\u51fa\u4f86\uff0c\u4ea4\u7d66 codec \u89e3\u58d3\u7e2e\uff0c\u8f49\u6210 PCM \u683c\u5f0f\uff0c\u4e4b\u5f8c\u5c31\u53ef\u4ee5\u4ea4\u7d66\u4f5c\u696d\u7cfb\u7d71\u7684\u97f3\u8a0a API \u64ad\u653e\u3002</p> <p>\u6bcf\u500b header \u7684\u9577\u5ea6\u70ba 4 \u500b bytes\uff0c\u6700\u5927\u7684\u7279\u8272\u662f\u524d 11 \u500b bit \u90fd\u662f 1\uff0c\u9019\u4e00\u6bb5\u53eb\u505a Syncword\u3002\u627e\u5230 syncword \u4e4b\u5f8c\uff0c\u5c31\u53ef\u4ee5\u7e7c\u7e8c\u628a\u5f8c\u9762\u7684 bit \u90fd\u8b80\u5b8c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 Mpeg Audio \u7248\u672c\uff08\u5728 MP3 \u4e4b\u524d\u9084\u6709 MP1\u3001MP2 \u5169\u7a2e\u683c\u5f0f\uff0c\u4f46\u662f\u4e26\u4e0d\u6d41\u884c\uff0c\u4f46\u662f MP3 Header \u9084\u662f\u628a\u9019\u500b\u7248\u672c\u5217\u5165\u898f\u683c\u4e2d\uff09\u3001\u58d3\u7e2e\u5f8c\u7684 bitrate\u2026\u7b49\u7b49\u8cc7\u8a0a\u3002</p> <p></p> <p>\u5982\u679c\u6211\u5011\u6253\u958b MP3 header \u7684\u898f\u683c\u66f8\uff0c\u6703\u770b\u5230\u4e00\u4e32\u300cAAAAAAAA AAABBCCD EEEEFFGH IIJJKLMM\u300d\u50cf\u662f\u5929\u66f8\u7684\u6587\u5b57\uff0c\u6211\u5011\u4e0d\u8981\u88ab\u5687\u5230\uff0c\u9019\u4e32\u6587\u5b57\u4ee3\u8868\u7684\u662f\u9019 4 \u500b bytes\u300132 \u500b bit \u4e2d\u3001\u6bcf\u500b bit \u7684\u7528\u9014\u3002\u50cf\u662f\u4e00\u958b\u982d\u7684 11 \u7684 A\uff0c\u5c31\u662f\u6211\u5011\u4e0a\u9762\u8b1b\u5230\u7684 syncword\u3002</p> <p>\u7528\u4f86\u5c07 header\u3001packet \u5f9e\u9023\u7e8c\u7684 Binary Data \u627e\u51fa\u4f86\u7684\u7a0b\u5f0f\uff0c\u53eb\u505a Parser\u3002\u5c0d\u65bc\u6709\u8655\u7406\u904e Binary Data \u7684\u5de5\u7a0b\u5e2b\u4f86\u8aaa\uff0c\u90fd\u6709\u8fa6\u6cd5\u53ef\u4ee5\u81ea\u5df1\u64b0\u5beb\u51fa MP3 Parser\uff0c\u81f3\u65bc MP3 codec \u5247\u5f88\u9577\u6642\u9593\u53d7\u5230\u6b0a\u5229\u4fdd\u8b77\uff0c\u4e00\u822c\u5de5\u7a0b\u5e2b\u4e5f\u6c92\u4ec0\u9ebc\u6a5f\u6703\u76f4\u63a5\u63a5\u89f8 codec\u3002\u800c\u5728\u50cf\u662f macOS \u6216 iOS \u7b49\u860b\u679c\u7684\u5e73\u53f0\u4e0a\uff0c\u860b\u679c\u53ea\u63d0\u4f9b\u6211\u5011 decode MP3 \u7684 codec\uff0c\u800c\u6c92\u6709 encode MP3 \u7684 codec\u3002</p>"},{"location":"mp3/#id3","title":"ID3","text":"<p>MP3 \u683c\u5f0f\u672c\u8eab\u53ea\u6709\u5b9a\u7fa9\u8072\u97f3\u8cc7\u6599\u7684\u90e8\u4efd\uff0c\u4f46\u5f88\u591a\u6642\u5019\uff0c\u6211\u5011\u9700\u8981\u4e00\u4e9b\u95dc\u65bc\u97f3\u6a94\u7684\u984d\u5916\u63cf\u8ff0\u8cc7\u6599\uff0c\u50cf\u662f\u9019\u7a2e\u6b4c\u7684\u6b4c\u540d\uff0c\u6b4c\u624b\u662f\u8ab0\u3001\u51fa\u81ea\u54ea\u5f35\u5c08\u8f2f\u3001\u5c6c\u65bc\u54ea\u7a2e\u6a02\u98a8\u2026\u4e5f\u5c31\u662f\u82f1\u6587\u6240\u7a31\u7684 metadata\uff0c\u4e26\u6c92\u6709\u5305\u542b\u5728 MP3 \u683c\u5f0f\u7684\u898f\u7bc4\u88e1\u3002\u6211\u5011\u6240\u4f7f\u7528\u7684\u97f3\u6a94\u64ad\u653e\u8edf\u9ad4\uff0c\u50cf\u662f iTunes\uff08\u5728 macOS 10.15 \u4e4b\u5f8c\u6539\u540d Music\uff09\u3001VLC \u7b49\u7b49\uff0c\u4e4b\u6240\u4ee5\u53ef\u4ee5\u5f9e\u6a94\u6848\u4e2d\u77e5\u9053\u9019\u4e9b\u8cc7\u8a0a\uff0c\u5247\u662f\u900f\u904e ID3 \u683c\u5f0f\u3002</p> <p></p> <p>ID3 metadata \u4e5f\u662f\u4e00\u9023\u4e32\u7684 binary data\uff0c\u76ee\u524d\u6bd4\u8f03\u901a\u884c\u7684\u662f\u7b2c\u4e8c\u7248\u7684 ID3v2\uff0c\u6703\u51fa\u73fe\u5728\u6574\u500b MP3 \u6a94\u6848\u6700\u524d\u9762\u7684\u4f4d\u7f6e\u3002ID3 \u8cc7\u6599\u7684\u524d\u4e09\u500b bytes \u5c31\u662f \"ID3\" \u9019\u4e09\u500b\u5b57\u5143\u7684 ASCII code\u3002\u5728\u8b80\u53d6 MP3 \u6a94\u6848\u7684\u6642\u5019\uff0c\u53ea\u8981\u4e00\u958b\u59cb\u5c31\u8b80\u5230\u9019\u4e09\u500b\u5b57\uff0c\u5c31\u53ef\u4ee5\u5224\u65b7\u9019\u500b\u6a94\u6848\u6709 ID3 \u8cc7\u8a0a\uff1b\u63a5\u8457\uff0c\u6211\u5011\u5c31\u4f86\u8655\u7406\u6b63\u6bb5\u8cc7\u6599\u7684\u524d 10 \u500b bytes\uff0c\u5728\u9019 10 \u500b bytes \u4e2d\uff0c\u9664\u4e86 \"ID3\" \u9019\u4e09\u500b\u5b57\u4e4b\u5916\uff0c\u9084\u5305\u542b\u4e86\u9019\u662f\u90a3\u500b\u7248\u672c\u7684 ID3\uff0c\u4ee5\u53ca\u6574\u6bb5 ID3 \u8cc7\u6599\u5340\u6bb5\u7684\u9577\u5ea6\u6709\u591a\u5c11\u7b49\u8cc7\u8a0a\u2026\u6211\u5011\u5c31\u4e00\u76f4\u8b80\u5230\u9019\u500b\u9577\u5ea6\u7bc4\u570d\u3002</p> <p>\u6709\u4e00\u9ede\u9700\u8981\u6ce8\u610f\uff0cID3 \u683c\u5f0f\u4e2d\uff0c\u662f\u7528 28 \u4f4d\u5143\u4e0d\u5e36\u6b63\u8ca0\u865f\u6574\u6578\uff08UInt28\uff09\uff0c\u63cf\u8ff0 ID3 \u8cc7\u6599\u7684\u9577\u5ea6\u300228 \u4f4d\u5143\u6574\u6578\u9019\u500b\u898f\u683c\u6709\u9ede\u5947\u5999\uff0c\u7e3d\u9577\u5ea6\u5176\u5be6\u4e5f\u662f 4 \u500b bytes\uff0c\u4f46\u662f\u6bcf\u500b byte \u7684\u7b2c\u4e00\u500b bit \u8981\u6368\u68c4\u6389\uff0c\u7136\u5f8c\uff0c\u7528\u9019\u56db\u500b bytes \u7684\u5269\u4e0b 7 \u500b bit\uff0c\u7d44\u5408\u51fa\u4e00\u500b\u6574\u6578\u3002</p> <p>\u5f9e\u7b2c 11 \u500b byte \u958b\u59cb\uff0c\u6211\u5011\u5c31\u53ef\u4ee5\u8b80\u51fa\u4e00\u500b\u500b\u7684 ID3 frame\uff0c\u6bcf\u500b ID3 frame \u4e5f\u662f\u7531 header \u8207 body \u7d44\u6210\uff0c\u5728 header \u4e2d\u53ef\u4ee5\u8b80\u51fa\u9019\u500b frame \u4ee3\u8868\u4ec0\u9ebc\u3001\u4ee5\u53ca body \u7684\u9577\u5ea6\uff0cbody \u5247\u662f\u5be6\u969b\u7684\u5167\u5bb9\uff0c\u50cf\u662f\u6b4c\u540d\u3001\u6b4c\u624b\u2026\u7b49\uff1a</p> <ul> <li>\u6bcf\u6b21\u5148\u8b80 10 \u500b bytes</li> <li>\u524d 4 \u500b bytes \u662f Tag ID\uff0c\u50cf <code>TALB</code> \u5c31\u662f\u5c08\u8f2f\u540d\u7a31\u3001<code>TCOM</code> \u662f\u4f5c\u66f2\u8005\u2026</li> <li>5-8 \u9019 4 \u500b bytes \u662f frame body \u7684\u9577\u5ea6\uff0c\u4e5f\u662f 28 \u4f4d\u5143\u7121\u6b63\u8ca0\u865f\u6574\u6578</li> <li>2 \u500b bytes \u7684 padding</li> <li>\u7136\u5f8c\u6839\u64da header \u4e2d\u7684 frame body \u9577\u5ea6\uff0c\u5f80\u4e0b\u8b80\u53d6</li> <li>frame body \u7684\u7b2c\u4e00\u500b byte\uff0c\u4ee3\u8868\u7684\u662f\u9019\u500b\u8cc7\u8a0a\u4f7f\u7528\u7684\u5b57\u5143\u7de8\u78bc\u65b9\u5f0f<ul> <li>0\uff1aASCII</li> <li>1\uff1aUTF-16-LE</li> <li>2\uff1aUTF-18-BE</li> <li>3\uff1aUTF-8</li> </ul> </li> </ul> <p>\u6bcf\u6bb5\u8cc7\u6599\u7684\u9577\u5ea6\u5982\u4e0b\u5716\uff1a</p> <p></p> <p>\u6211\u5011\u4e5f\u53ef\u4ee5\u53c3\u8003 ID3 \u7db2\u7ad9\u4e0a\u7684\u898f\u683c\u3002</p> <p>\u6211\u5011\u53ef\u4ee5\u7528 Hex Editor \u6253\u958b\u4e00\u500b MP3 \u6a94\u6848\uff0c\u5c31\u53ef\u4ee5\u767c\u73fe\u6211\u5011\u6240\u8b1b\u5230\u7684\u91cd\u9ede\uff1a</p> <p></p> <ul> <li>\u6211\u5011\u53ef\u4ee5\u770b\u5230\uff0c\u9019\u500b MP3 \u6a94\u6848\u7684\u958b\u982d\u662f \"ID3\"\uff0c\u4ee3\u8868\u5305\u542b\u4e86 ID3 \u8cc7\u8a0a</li> <li>\u7531\u65bc syncword \u662f\u9023\u7e8c 11 \u500b 1\uff0c\u6240\u4ee5\u6211\u5011\u53bb\u627e \"FFFB\"\uff0c\u5c31\u53ef\u4ee5\u627e\u5230 packet \u7684\u958b\u982d</li> <li>\u9019\u88e1\u7684\u7b2c\u4e00\u500b packet\uff0c\u5176\u5be6\u662f LAME \u52a0\u4e0a\u53bb\u7684\u975c\u97f3 packet</li> </ul>"},{"location":"mp3/#mp3_1","title":"MP3 \u683c\u5f0f\u7684\u512a\u7f3a\u9ede","text":"<p>\u6bcf\u500b packet \u524d\u9762\u90fd\u6709\u4e00\u500b\u6a94\u982d\uff0c\u540c\u6642\u662f MP3 \u683c\u5f0f\u7684\u512a\u9ede\u8207\u7f3a\u9ede\u3002\u597d\u8655\u662f\uff0c\u5982\u679c\u64ad\u653e\u8edf\u9ad4\u900f\u904e\u7db2\u8def\uff0c\u63a5\u53d7\u5230\u4e86\u4e00\u6bb5\u9023\u7e8c\u7684 MP3 \u8cc7\u6599\uff0c\u53ea\u8981\u64ad\u653e\u5668\u5f9e\u8cc7\u6599\u4e2d\u767c\u73fe\u4e00\u500b syncword\uff0c\u5c31\u53ef\u4ee5\u627e\u5230 packet \u4e26\u4e14\u958b\u59cb\u64ad\u653e\uff0c\u800c\u5982\u679c\u56e0\u70ba\u7db2\u8def\u50b3\u8f38\u554f\u984c\uff0c\u9020\u6210\u67d0\u4e00\u8cc7\u6599\u907a\u5931\uff0c\u90a3\u9ebc\uff0c\u4e00\u6a23\u53ea\u8981\u7e7c\u7e8c\u5f80\u4e0b\u8b80\u53d6\uff0c\u627e\u5230 syncword\uff0c\u5c31\u53ef\u4ee5\u6062\u5fa9\u64ad\u653e\u3002</p> <p>MP3 \u683c\u5f0f\u7684\u9019\u7a2e\u7279\u6027\uff0c\u5728 90 \u5e74\u4ee3\u9020\u5c31\u4e86\u50cf\u662f shoutcast \u9019\u6a23\u7684\u7db2\u8def\u5ee3\u64ad\u96fb\u53f0\u3002Shoutcast \u6280\u8853\u8b93 client \u8207 server \u4e4b\u9593\u5efa\u7acb socket \u9023\u7dda\uff0cserver \u4e0d\u65b7\u5411 client \u7aef\u50b3\u9001\u9023\u7e8c\u7684 MP3 \u8cc7\u6599\uff0cclient \u7aef\u4e00\u958b\u59cb\u9023\u4e0a\u6642\uff0c\u4e26\u4e0d\u8a8d\u5f97\u6700\u524d\u9762\u7684\u4e00\u4e9b bytes\uff0c\u4f46\u53ea\u8981\u8b80\u5230\u7b2c\u4e00\u500b syncword\uff0c\u5c31\u53ef\u4ee5\u8b93\u7528\u6236\u958b\u59cb\u4eab\u53d7\u7db2\u8def\u5ee3\u64ad\u3002</p> <p>\u4f46\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u77e5\u9053\u4e00\u500b MP3 \u97f3\u6a94\u7684\u5be6\u969b\u9577\u5ea6\uff0c\u4ee5\u53ca\u50cf\u662f\u64ad\u653e\u4f4d\u7f6e\u4e00\u5206\u96f6\u4e09\u79d2\u6703\u5c0d\u61c9\u5230\u6a94\u6848\u7684\u54ea\u500b\u4f4d\u7f6e\uff0cMP3 \u5c31\u4e0d\u662f\u5f88\u6709\u6548\u7387\u7684\u683c\u5f0f\u3002\u6211\u5011\u60f3\u8981\u77e5\u9053\u7e3d\u9577\u5ea6\uff0c\u5c31\u5f97\u628a\u6574\u500b\u6a94\u6848\u8b80\u53d6\u4e00\u6b21\uff0c\u624d\u6709\u8fa6\u6cd5\u77e5\u9053\u7e3d\u5171\u6709\u591a\u5c11 packet\uff0c\u6211\u5011\u4e5f\u5f97\u8b80\u53d6\u4e86\u4e00\u5206\u96f6\u4e09\u79d2\u7684\u8cc7\u6599\uff0c\u624d\u6709\u8fa6\u6cd5\u8981\u6c42\u64ad\u653e\u8edf\u9ad4 seek \u5230\u4e00\u5206\u96f6\u4e09\u79d2\u64ad\u653e\u3002</p> <p>\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u6709\u4e00\u500b\u653e\u5728 web server \u4e0a\u7684 MP3 \u97f3\u6a94\uff0c\u6211\u5011\u60f3\u8981\u5728\u64ad\u653e\u9019\u500b\u6a94\u6848\u7684\u6642\u5019\uff0c\u76f4\u63a5\u5f9e\u4e00\u5206\u96f6\u4e09\u79d2\u958b\u59cb\u64ad\u653e\uff0c\u66f4\u6709\u6548\u7387\u7684\u65b9\u5f0f\u662f\uff0c\u5982\u679c\u6211\u5011\u53ef\u4ee5\u4e00\u958b\u59cb\u5c31\u77e5\u9053\u4e00\u5206\u96f6\u4e09\u79d2\u662f\u6574\u500b\u6a94\u6848\u7684\u7b2c\u5e7e\u500b byte\uff0c\u6211\u5011\u5c31\u76f4\u63a5\u5e36\u4e86 Range HTTP Header \u7684 HTTP \u9023\u7dda\uff0c\u76f4\u63a5\u5f9e\u90a3\u500b\u4f4d\u7f6e\u958b\u59cb\u6293\u6a94\uff0cServer \u5c31\u6703\u56de\u61c9 HTTP status code \u70ba 206 \u7684\u56de\u61c9\uff0c\u53ea\u7d66\u6211\u5011\u90a3\u4e00\u6bb5\u8cc7\u6599\uff0c\u7701\u53bb\u8f09\u5165\u524d\u4e00\u5206\u591a\u9418\u7684\u6642\u9593\u3002</p> <p>\u90a3\u9ebc\uff0c\u6211\u5011\u6709\u4ec0\u9ebc\u8fa6\u6cd5\u53ef\u4ee5\u77e5\u9053\u4e00\u5206\u96f6\u4e09\u79d2\u5230\u5e95\u5728\u6a94\u6848\u7684\u54ea\u88e1\uff1f\u5982\u679c\u662f\u56fa\u5b9a\u78bc\u7387\u7684\u6a94\u6848\uff0c\u6211\u5011\u5927\u6982\u9084\u6709\u8fa6\u6cd5\u63a8\u7b97\uff0c\u4f46\u5982\u679c\u662f\u8b8a\u52d5\u78bc\u7387\u5462\uff1f</p> <p>\u65bc\u662f\uff0c\u6211\u5011\u767c\u73fe\uff0c\u5728 MP3 \u4e4b\u5f8c\u7684\u8a31\u591a\u6a94\u6848\u683c\u5f0f\uff0c\u662f\u8b93 codec \u8207 container \uff08\u4e2d\u6587\u901a\u5e38\u53eb\u300c\u5bb9\u5668\u300d\uff0c\u4f46\u7fd2\u6163\u4e0a\u9084\u662f\u76f4\u63a5\u8b1b\u82f1\u6587\uff09\u5206\u5bb6\u7684\u3002codec \u8ca0\u8cac\u7684\u662f packet \u7684\u58d3\u7e2e/\u89e3\u58d3\u7e2e\uff0c\u800c container \u5247\u8ca0\u8cac\u5b89\u6392 packet \u8207 packet \u7684 header \u7684\u64fa\u653e\u65b9\u5f0f\uff0c\u50cf AAC \u97f3\u6a94\u5c31\u6709\u591a\u7a2e\u4e0d\u540c\u7684 container \u683c\u5f0f\u3002\u5728\u860b\u679c\u7684\u5e73\u53f0\u4e0a\uff0c\u901a\u5e38\u628a codec \u683c\u5f0f\u53eb\u505a audio format\u3001\u628a container \u53eb\u505a file format\u3002</p>"},{"location":"mp3/#bit-rate-sample-rate","title":"\u6539\u8b8a Bit Rate \u6703\u6539\u8b8a Sample Rate \u55ce\uff1f","text":"<p>\u4e4b\u524d\u6709\u500b\u540c\u4e8b\u6709\u9ede\u628a Bit Rate \u8207 Sample Rate \u641e\u6df7\u4e86\uff0c\u6240\u4ee5\u554f\u6211\uff0cMP3 \u660e\u660e\u5c31\u6703\u628a\u6a94\u6848\u58d3\u5c0f\uff0c\u70ba\u4ec0\u9ebc\u58d3\u7e2e\u4e4b\u5f8c\uff0cSample Rate \u4e26\u6c92\u6709\u6539\u8b8a\uff1f\u6211\u5c31\u8209\u4e86\u4e00\u500b\u5716\u6a94\u7684\u4f8b\u5b50\u3002</p> <p>\u5982\u679c\u4f60\u6709\u4e00\u5f35 1920 x 1080 \u89e3\u6790\u5ea6\u7684\u5716\u6a94\uff0c\u5728\u5132\u5b58\u6210 JPEG \u5716\u5f62\u7684\u6642\u5019\uff0c\u5404\u7a2e\u4fee\u5716\u8edf\u9ad4\u6216\u662f\u8f49\u6a94\u8edf\u9ad4\uff0c\u6703\u8a62\u554f\u4f60\u8981\u600e\u6a23\u7684\u6bd4\u4f8b\uff0c\u5982\u679c\u4f60\u60f3\u8981\u628a\u5716\u6a94\u58d3\u7e2e\u5f97\u8d8a\u5c0f\uff0c\u90a3\u9ebc\u58d3\u7e2e\u4e4b\u5f8c\u7684\u5716\u7247\u5c31\u6703\u8d8a\u5931\u771f\uff0c\u4f46\u4e0d\u7ba1\u4f60\u600e\u9ebc\u58d3\u7e2e\uff0c\u4f60\u91cd\u65b0\u6253\u958b\u9019\u4e00\u5f35\u5716\u6a94\uff0c\u89e3\u6790\u5ea6\u4ecd\u7136\u662f 1920 x 1080\u3002\u97f3\u6a94\u4e5f\u662f\u540c\u6a23\u7684\u9053\u7406\uff0c\u5c0d\u65bc MP3 \u9019\u4e9b\u683c\u5f0f\u4f86\u8aaa\uff0c\u4e0d\u7ba1\u4f60\u628a\u97f3\u6a94\u58d3\u7e2e\u5f97\u591a\u5c0f\uff0c\u6700\u5f8c codec \u628a\u58d3\u7e2e\u97f3\u6a94\u9084\u539f\u6210\u539f\u59cb PCM \u683c\u5f0f\u7684\u6642\u5019\uff0c\u9084\u662f\u4e00\u6a23\u7684 Sample Rate\u3002</p> <p>\u800c\u6539\u8b8a Sample Rate \u9019\u4ef6\u4e8b\u60c5\uff0c\u4e5f\u6bd4\u8f03\u50cf\u662f\u4f60\u628a\u4e00\u5f35 1920 x 1080 \u7684\u5716\u7247\u8f49\u6210 1280 x 720 \u7684\u5716\u6a94\u3002</p>"},{"location":"pcm/","title":"PCM \u683c\u5f0f","text":""},{"location":"pcm/#_1","title":"\u6578\u4f4d\u8207\u985e\u6bd4","text":"<p>\u8072\u97f3\u662f\u4eba\u8033\u53ef\u4ee5\u611f\u53d7\u5230\u7684\u3001\u7a7a\u6c23\u4e2d\u8207\u6c34\u4e2d\u7684\u9707\u52d5\uff0c\u662f\u4e00\u7a2e\u985e\u6bd4\uff08Analog\uff09\u8a0a\u865f\uff0c\u97f3\u6a94\u5247\u662f\u7528\u6578\u4f4d\uff08Digital\uff09\u7684\u65b9\u5f0f\u5c07\u9019\u4e9b\u9707\u52d5\u8a18\u9304\u4e0b\u4f86\u3002</p> <p>\u4eba\u9ad4\u53ef\u4ee5\u5f9e\u5927\u81ea\u7136\u4e2d\u611f\u53d7\u5230\u7684\u8a0a\u865f\uff0c\u90fd\u662f\u985e\u6bd4\u8a0a\u865f\u2014\u6240\u8b02\u985e\u6bd4\u8a0a\u865f\uff0c\u662f\u5728\u8a0a\u865f\u4e2d\u5b58\u5728\u8457\u76f8\u5c0d\u7684\u5f37\u5f31\u7684\u4f4d\u6bd4\uff0c\u800c\u6578\u4f4d\u8a0a\u865f\u5247\u662f\u7531\u4f4d\u5143\u7d44\u6210\uff0c\u662f\u7d55\u5c0d\u7684 0 \u8207 1\uff0c\u7528 0 \u8207 1 \u6240\u7d44\u6210\u7684\u6578\u5b57\uff0c\u76e1\u53ef\u80fd\u5730\u63cf\u8ff0\u8207\u9084\u539f\u66fe\u7d93\u767c\u751f\u5728\u5927\u81ea\u7136\u4e2d\u7684\u985e\u6bd4\u8a0a\u865f\u3002</p> <p>\u4ee5\u984f\u8272\u4f86\u8aaa\uff0c\u5927\u81ea\u7136\u4e2d\u4e26\u4e0d\u6703\u6709\u7d55\u5c0d\u7684\u767d\u3001\u4e5f\u4e0d\u6703\u6709\u7d55\u5c0d\u7684\u9ed1\uff0c\u4e0d\u6703\u6709\u5b8c\u5168\u7121\u5149\u6216\u662f\u5149\u7dda\u6578\u91cf\u7684\u6975\u9650\u72c0\u614b\uff0c\u4ee5\u8072\u97f3\u4f86\u8aaa\uff0c\u4e5f\u4e0d\u6703\u6709\u5b8c\u5168\u7684\u7121\u8072\uff0c\u6216\u662f\u8072\u97f3\u7684\u6975\u9650\u72c0\u614b\u3002</p> <p>\u4f46\u56e0\u70ba\u96fb\u8166\u7684\u5bb9\u91cf\u8207\u7b97\u529b\u7684\u95dc\u4fc2\uff0c\u5728\u96fb\u8166\u4e0a\uff0c\u6211\u5011\u5fc5\u9808\u8a02\u51fa\u4e00\u500b\u6578\u503c\u7684\u4e0a\u9650\u8207\u4e0b\u9650\u3002\u5728\u5927\u81ea\u7136\u7576\u4e2d\u6709\u7121\u6578\u7a2e\u8272\u5f69\uff0c\u4f46\u662f\u6211\u5011\u5728\u96fb\u8166\u4e0a\uff0c\u4ee5 RGB \u4f86\u8aaa\uff0c\u5c31\u662f 256 * 256 * 256 \u6240\u7d44\u6210\u7684\u3001\u5c07\u8fd1\u4e00\u516d\u4e03\u4e03\u842c\u7a2e\u984f\u8272\u3002</p> <p>\u7576\u6211\u5011\u60f3\u8981\u628a\u5927\u81ea\u7136\u7576\u4e2d\u7684\u985e\u6bd4\u8a0a\u865f\u8f49\u63db\u6210\u6578\u4f4d\u8a0a\u865f\u7684\u6642\u5019\uff0c\u6211\u5011\u5c31\u53ea\u80fd\u5920\u8a18\u9304\u5be6\u969b\u767c\u751f\u5728\u5927\u81ea\u7136\u7576\u4e2d\u7684\u90e8\u4efd\u8a0a\u865f\uff0c\u800c\u6211\u5011\u8a18\u9304\u7684\u662f\u4eba\u9ad4\u7684\u611f\u5b98\u6240\u80fd\u5920\u611f\u53d7\u5230\u7684\u7bc4\u570d\u3002</p> <p>\u985e\u6bd4\u4fe1\u865f\u624d\u662f\u4eba\u985e\u6700\u5f8c\u53ef\u4ee5\u611f\u53d7\u5230\u7684\u4fe1\u865f\uff0c\u5373\u4f7f\u6211\u5011\u8f49\u63db\u4e86\u6578\u4f4d\u97f3\u6a94\uff0c\u9084\u662f\u5fc5\u9808\u900f\u904e\u8033\u6a5f\u6216\u662f\u5587\u53ed\u7b49\u786c\u9ad4\u64ad\u653e\u51fa\u4f86\u3002\u6211\u5011\u9700\u8981\u6578\u4f4d\u97f3\u6a94\u7684\u539f\u56e0\u662f\u2014\u985e\u6bd4\u8a0a\u865f\u5f80\u5f80\u7121\u6cd5\u50b3\u905e\u5230\u9060\u65b9\uff0c\u4eba\u8072\u5f80\u5f80\u50b3\u905e\u4e0d\u904e\u5e7e\u5341\u5230\u5e7e\u767e\u516c\u5c3a\uff0c\u4f46\u6211\u5011\u5e0c\u671b\u53ef\u4ee5\u5c07\u8072\u97f3\u50b3\u9001\u5230\u66f4\u9060\u7684\u5730\u65b9\uff1b\u8072\u97f3\u6703\u7d93\u904e\u4e00\u6bb5\u6642\u9593\u4e4b\u5f8c\u6d88\u5931\uff0c\u4f46\u6211\u5011\u5e0c\u671b\u53ef\u4ee5\u5728\u4e8b\u4ef6\u767c\u751f\u4e4b\u5f8c\uff0c\u4ecd\u7136\u53ef\u4ee5\u91cd\u73fe\u7576\u6642\u7684\u8a0a\u865f\u3002\u4f46\uff0c\u8a18\u9304\u7684\u904e\u7a0b\uff0c\u4e5f\u540c\u6642\u662f\u5931\u771f\u7684\u904e\u7a0b\u2014\u4e00\u5b9a\u6703\u6709\u4e9b\u7247\u6bb5\u6216\u4e8b\u7269\uff0c\u5728\u8f49\u63db\u3001\u50b3\u905e\u7684\u904e\u7a0b\u7576\u4e2d\u907a\u5931\u3002</p>"},{"location":"pcm/#_2","title":"\u63a1\u6a23","text":"<p>\u7528\u4f86\u5075\u6e2c\u7a7a\u6c23\u4e2d\u7684\u9707\u52d5\u7684\u88dd\u7f6e\uff0c\u6211\u5011\u90fd\u77e5\u9053\uff0c\u90a3\u5c31\u662f\u9ea5\u514b\u98a8\u3002\u90a3\u9ebc\uff0c\u5728\u96fb\u8166\u4e0a\uff0c\u6703\u88ab\u4ee5\u4ec0\u9ebc\u65b9\u5f0f\u8a18\u9304\uff1f</p> <p>\u8072\u97f3\u662f\u6ce2\uff0c\u5728\u6578\u5b78\u4e0a\uff0c\u5982\u679c\u6211\u5011\u60f3\u8981\u63cf\u8ff0\u4e00\u500b\u6ce2\uff0c\u6703\u4f7f\u7528\u4e8c\u5143\u65b9\u7a0b\u5f0f\u8868\u9054\uff0c\u4ee5 X \u8ef8\u4ee3\u8868\u6642\u9593\uff0c\u4ee5 Y \u8ef8\u4ee3\u8868\u8072\u6ce2\u7684\u9707\u52d5\uff0c\u7406\u8ad6\u4e0a\u6211\u5011\u53ef\u4ee5\u5c07\u6642\u9593\u5206\u5272\u6210\u7121\u9650\u5c0f\uff0c\u800c\u73fe\u5be6\u4e2d\uff0c\u7269\u7406\u4e0a\u6642\u9593\u9084\u662f\u6703\u6709\u4e00\u500b\u6700\u5c0f\u7684\u55ae\u4f4d\uff0c\u800c\u6211\u5011\u5728\u96fb\u8166\u4e0a\uff0c\u4e5f\u6c92\u8fa6\u6cd5\u5c07\u6642\u9593\u5206\u5272\u5230\u975e\u5e38\u5c0f\u7684\u55ae\u4f4d\uff0c\u6240\u4ee5\u6578\u4f4d\u97f3\u6a94\u52e2\u5fc5\u8981\u5c07\u9019\u500b\u9023\u7e8c\u7684\u6ce2\u578b\uff0c\u6839\u64da\u4e00\u500b\u5408\u7406\u7684\u6642\u9593\u523b\u5ea6\uff0c\u5728\u9019\u500b\u6642\u9593\u523b\u5ea6\u4e0a\uff0c\u6a19\u4e0a\u4e00\u9023\u4e32\u3001\u4e00\u500b\u53c8\u4e00\u500b\u7684\u6578\u5b57\u3002</p> <p></p> <p>\u5c07\u9023\u7e8c\u7684\u6ce2\u578b\u8b8a\u6210\u4e00\u9023\u4e32\u7684\u6578\u5b57\uff0c\u9019\u500b\u904e\u7a0b\u53eb\u505a\u63a1\u6a23\uff08Sampling\uff0c\u4e5f\u7a31\u4f5c\u53d6\u6a23\uff0c\u53ef\u4ee5\u53c3\u898b Wikipedia \u4e0a\u7684\u8aaa\u660e\uff09\uff0c\u6bcf\u4e00\u500b\u88ab\u63a1\u96c6\u51fa\u4f86\u7684\u6578\u5b57\uff0c\u5728\u4e2d\u6587\u4e5f\u53eb\u505a\u63a1\u6a23\uff08Sample\uff09\u2014\u82f1\u6587\u4e2d\u5f88\u591a\u55ae\u5b57\u7684\u52d5\u8a5e\u8207\u540d\u8a5e\u662f\u5169\u500b\u5b57\uff0c\u4f46\u662f\u5728\u4e2d\u6587\u5f80\u5f80\u6703\u8b8a\u6210\u540c\u4e00\u500b\u8a5e\uff0c\u5728\u53f0\u7063\uff0c\u4e5f\u6bd4\u8f03\u5e38\u76f4\u63a5\u8b1b\u82f1\u6587\u3002</p> <p>\u4e00\u500b\u6ce2\u578b\uff0c\u6709\u632f\u5e45\u8207\u983b\u7387\u9019\u5169\u7a2e\u6027\u8cea\uff0c\u5728\u63a1\u6a23\u7684\u904e\u7a0b\u4e2d\uff0c\u6211\u5011\u53ea\u64f7\u53d6\u4e00\u5b9a\u7bc4\u570d\u7684\u632f\u5e45\u8207\u983b\u7387\u4e4b\u9593\u7684\u8072\u97f3\u3002\u63a1\u6a23\u7684\u904e\u7a0b\uff0c\u5176\u5be6\u4e5f\u5c31\u662f\u4e00\u7a2e\u6368\u68c4\u7684\u904e\u7a0b\uff1a</p> <ul> <li>\u4e00\u500b\u8072\u6ce2\u7684\u4e0a\u4e0b\u8d77\u4f0f\uff0c\u4ee3\u8868\u7684\u662f\u8072\u97f3\u7684\u97f3\u91cf\u5927\u5c0f\uff0c\u6ce2\u578b\u7684\u5bc6\u96c6\u7a0b\u5ea6\uff0c\u5247\u4ee3\u8868\u8072\u97f3\u7684\u97f3\u9ad8\uff0c\u5982\u679c\u6ce2\u578b\u8d8a\u5bc6\u96c6\u5c31\u4ee3\u8868\u9019\u500b\u8072\u97f3\u6108\u9ad8\uff0c\u53cd\u4e4b\u5247\u6108\u4f4e\u3002\u97f3\u91cf\u7684\u55ae\u4f4d\u662f\u5206\u8c9d\uff08dB\uff09\uff0c\u4eba\u8033\u53ef\u4ee5\u807d\u5230\u7684\u97f3\u91cf\u5728\u65bc 0 \u5230 100 \u5206\u8c9d\u4e4b\u9593\uff0c\u8d85\u904e 100 \u5206\u8c9d\uff0c\u5c31\u6703\u8d85\u904e\u4eba\u8033\u53ef\u4ee5\u5fcd\u53d7\u7684\u7a0b\u5ea6\uff0c\u8d85\u904e 100 \u5206\u8c9d\u7684\u8072\u97f3\uff0c\u5728\u63a1\u6a23\u904e\u7a0b\u4e2d\uff0c\u5c31\u6703\u88ab\u7576\u6210 100 \u5206\u8c9d\u8655\u7406\u3002</li> <li>\u4eba\u8033\u5927\u6982\u53ef\u4ee5\u807d\u5230\u983b\u7387\u70ba 22050 Hz \uff08\u610f\u601d\u662f\u5728 1/22050 \u79d2\u4e2d\u7522\u751f\u7684\u6ce2\u578b\uff09\uff0c\u800c\u5982\u679c\u5c07\u983b\u7387\u4e58\u4e0a\u5169\u500d\uff0c\u8b8a\u6210 44100\uff0c\u6839\u64da\u63a1\u6a23\u5b9a\u7406\uff0c\u4eba\u8033\u5c31\u807d\u4e0d\u51fa\u5dee\u7570\u3002\u4e0d\u904e\uff0c\u8fd1\u5e7e\u5e74\u7684\u9ad8\u97f3\u8cea\u97f3\u6a94\u3001\u4ee5\u53ca\u6240\u8b02\u7684 DVD \u97f3\u8cea\uff0c\u4e5f\u7528\u5230\u4e86\u50cf\u662f 48000\u300196000 \u9019\u6a23\u7684\u983b\u7387\u3002</li> </ul> <p>\u6211\u5011\u6240\u8b02\u7684 \u63a1\u6a23\u7387\uff08Sample Rate\uff0c\u4e5f\u7a31\u63a1\u6a23\u6bd4\u3001\u53d6\u6a23\u7387\u2026\u7b49\uff09\uff1a\u5c31\u662f\u5728\u4e00\u79d2\u9418\u7576\u4e2d\uff0c\u6211\u5011\u63a1\u96c6\u4e86\u591a\u5c11\u500b\u6578\u5b57\uff0c\u6240\u8b02 44100 \u7684\u63a1\u6a23\u7387\uff0c\u5c31\u662f\u4e00\u79d2\u9418\u63a1\u96c6 44100 \u500b\u6578\u5b57\u3002</p> <p>\u6211\u5011\u5f80\u5f80\u6703\u63a1\u96c6\u5de6\u53f3\u5169\u500b\u8072\u9053\uff08Channel\uff09\uff0c\u4ee5\u5275\u9020\u7acb\u9ad4\u8072\u7684\u6548\u679c\u3002\u6240\u4ee5\u5728\u4e00\u7d44\u7acb\u9ad4\u8072\u7684\u63a1\u6a23\u4e2d\uff0c\u6703\u6709\u5169\u500b\u6578\u5b57\uff0c\u5169\u500b\u8072\u9053\u7684\u6578\u5b57\u6703\u7528 LRLR\u2026\u9019\u6a23\u7684\u5de6\u53f3\u4e26\u6392\u65b9\u5f0f\u6392\u5217\uff0c\u9019\u7a2e\u4e00\u5de6\u4e00\u53f3\u6392\u5217\u63a1\u6a23\u7684\u65b9\u5f0f\uff0c\u6211\u5011\u53eb\u505a Interleave\u3002\u7576\u6211\u5011\u5728\u8a08\u7b97\u6a94\u6848\u5927\u5c0f\u7684\u6642\u5019\uff0c\u9084\u9700\u8981\u5f9e Sample Rate \u518d\u4e58\u4e0a 2\uff0c\u628a\u5de6\u53f3\u8072\u9053\u5169\u500b Sample \u5408\u4f75\u5728\u4e00\u8d77\uff0c\u5c31\u662f\u4e00\u500b frame\u3002</p> <p>\u5728\u67d0\u4e9b\u683c\u5f0f\u4e2d\uff0c\u53ef\u4ee5\u5141\u8a31\u66f4\u591a\u7684\u8072\u9053\uff0c\u50cf FLAC \u5c31\u652f\u63f4\u5230\u516b\u8072\u9053\uff0c\u800c\u50cf\u6240\u8b02 5.1 \u8072\u9053\u30017.1 \u8072\u9053\u2026\u90fd\u4e0d\u53ea 2 \u8072\u9053\u3002</p> <p>\u96fb\u8166\u6709\u5404\u7a2e\u8868\u9054\u6578\u5b57\u7684\u65b9\u5f0f\uff0c\u800c\u7531\u65bc\u8072\u6ce2\u6703\u4e0a\u4e0b\u9707\u76ea\uff0c\u6240\u4ee5\u6211\u5011\u9700\u8981\u7528\u5e36\u6b63\u8ca0\u865f\u7684\u6578\u5b57\u4f86\u8868\u9054\u5f80\u4e0a\u8207\u5f80\u4e0b\u7684\u8d77\u4f0f\uff0c\u5e38\u7528\u5230\u7684\u6578\u5b57\u683c\u5f0f\u5305\u62ec 16 \u4f4d\u5143\u6574\u6578\uff08singed int 16\uff09\u300132 \u4f4d\u5143\u6574\u6578\uff08signed int 32\uff09\u300132 \u4f4d\u5143\u6d6e\u9ede\u6578\uff08float 32\uff09\u2026\u7b49\u3002\u5c0d\u8a31\u591a\u81ea\u5df2\u900f\u904e\u6578\u5b78\u7522\u751f\u96fb\u8166\u6ce2\u578b\u7684\u5de5\u7a0b\u5e2b\u4f86\u8aaa\uff0c\u5f80\u5f80\u6703\u4f7f\u7528 32 \u4f4d\u5143\u6d6e\u9ede\u6578\uff08\u63a1\u6a23\u6578\u5b57\u4ecb\u65bc 1.0 \u5230 -1.0\uff09\uff0c\u64b0\u5beb\u5404\u7a2e\u8072\u97f3\u8655\u7406\u7684\u6f14\u7b97\u6cd5\uff0c\u5728 CD \u4e0a\u662f\u4f7f\u7528 16 \u4f4d\u5143\u6574\u6578\uff08\u63a1\u6a23\u6578\u5b57\u4ecb\u65bc\u6b63\u8ca0 2 \u7684 15 \u6b21\u65b9\uff09\uff0c\u7528\u5169\u500b byte \u5132\u5b58\u4e00\u500b\u63a1\u6a23\u3002</p> <p>\u81f3\u65bc\u76ee\u524d\u8a31\u591a\u9ad8\u97f3\u8cea\u683c\u5f0f\u7528\u7684\u662f 24 bit\uff0c\u4ee3\u8868\u7528 3 \u500b bytes \u5132\u5b58\u4e00\u500b\u6578\u5b57\uff0c\u4e0d\u904e\uff0c\u4e00\u822c\u5beb\u7a0b\u5f0f\u901a\u5e38\u4e0d\u6703\u7528\u5230\u9019\u7a2e\u6578\u5b57\uff0c\u6240\u4ee5\u5be6\u969b\u4f7f\u7528\u4e0a\uff0c\u6703\u628a 24 bit \u6574\u6578\u518d\u8f49\u63db\u6210 32 bit \u6574\u6578\u6216\u662f\u6d6e\u9ede\u6578\u3002</p>"},{"location":"pcm/#pcm_1","title":"PCM \u683c\u5f0f\u2014\u6240\u8b02\u7684\u539f\u59cb\u97f3\u6a94","text":"<p>\u9019\u7a2e\u4ee5\u4e00\u9023\u4e32\u6578\u5b57\u63cf\u8ff0\u8072\u97f3\u7684\u683c\u5f0f\uff0c\u6211\u5011\u5f80\u5f80\u53eb\u505a\u539f\u59cb\u97f3\u6a94\uff0c\u800c\u8853\u8a9e\u53eb\u505a PCM \u683c\u5f0f\uff08Pulse-code modulation\uff0c\u4e2d\u6587\u53eb\u505a\u300c\u8108\u885d\u7de8\u78bc\u8abf\u8b8a\u300d\uff0c\u4f46\u662f\u5f88\u5c11\u4eba\u53ef\u4ee5\u8a18\u4f4f\u9019\u500b\u4e2d\u6587\u540d\u7a31\uff0c\u901a\u5e38\u5c31\u6163\u7a31 PCM\uff09\u3002\u50cf\u5fae\u8edf Windows \u4e0a\u7684 WAV \u6a94\u6848\uff08\u7528\u300c\u9304\u97f3\u6a5f\u300d\u8edf\u9ad4\u9304\u88fd\u51fa\u4f86\u7684\u8072\u97f3\u6a94\u6848\uff09\u3001\u860b\u679c\u5e73\u53f0\u4e0a\u7684 AIFF \u6a94\u6848\uff0c\u90fd\u5c6c\u65bc\u9019\u7a2e\u683c\u5f0f\uff0c\u53ea\u662f\u901a\u5e38\u90fd\u9084\u6703\u5728\u6700\u524d\u65b9\u52a0\u500b\u6a94\u982d\u3002\u800c\u5f9e\u4e0a\u9762\u7684\u63cf\u8ff0\uff0c\u6211\u5011\u4e5f\u53ef\u4ee5\u77e5\u9053\uff0c\u96d6\u7136\u540c\u6a23\u53eb\u505a PCM \u683c\u5f0f\uff0c\u4f46\u662f\u53ef\u80fd\u6703\u6709\u4e0d\u540c\u7684 Sample Rate\u3001\u6216\u662f\u7528\u4e0d\u540c\u7684\u6578\u5b57\u683c\u5f0f\u63cf\u8ff0\u6ce2\u578b\uff0c\u800c WAV\u3001AIFF \u6a94\u6848\u7684\u6a94\u982d\uff0c\u7528\u662f\u7528\u4f86\u544a\u8a34\u64ad\u653e\u8edf\u9ad4\u61c9\u8a72\u600e\u9ebc\u89e3\u6790\u6a94\u982d\u4e4b\u5f8c\u7684\u8cc7\u6599\u3002</p> <p>\u73fe\u5728\u7528\u6236\u901a\u5e38\u5f88\u5c11\u6703\u76f4\u63a5\u64ad\u653e PCM \u6a94\u6848\uff0c\u5728\u7db2\u8def\u4e0a\u6d41\u901a\u7684\u97f3\u6a94\uff0c\u4e5f\u5f88\u5c11\u6703\u662f PCM \u683c\u5f0f\uff0c\u4f46\u7121\u8ad6\u662f\u54ea\u7a2e\u683c\u5f0f\uff0c\u5728 client \u7aef\u6700\u5f8c\u90fd\u5f97\u8981\u8f49\u63db\u6210 PCM \u683c\u5f0f\uff0c\u624d\u80fd\u5920\u518d\u4ea4\u7d66 client \u7aef\u7684\u786c\u9ad4\u64ad\u653e\uff1a\u6709\u53ef\u80fd\u662f\u900f\u904e\u5e73\u53f0\u672c\u8eab\u5df2\u7d93\u5305\u597d\u7684\u64ad\u653e\u5668\u5143\u4ef6\uff0c\u50cf iOS/macOS \u5e73\u53f0\u4e0a\u6709\u9ad8\u968e\u7684\u64ad\u653e\u5668 AVPlayer\uff0c\u4e5f\u53ef\u80fd\u662f\u8981\u4f7f\u7528\u66f4\u4f4e\u968e\u7684 Audio API\uff0c\u81ea\u5df1\u60f3\u8fa6\u6cd5\u547c\u53eb codec\uff0c\u5c07\u5404\u7a2e\u683c\u5f0f\u8f49\u63db\u6210 PCM \u683c\u5f0f\u3002</p> <p>\u800c\u5982\u679c\u60f3\u8981\u7528\u4e00\u4e9b\u8072\u97f3\u526a\u8f2f\u6216\u7de8\u8f2f\u8edf\u9ad4\uff0c\u50cf Audacity\uff0c\u8655\u7406\u4e00\u6bb5\u9304\u597d\u7684\u8072\u97f3\uff0c\u4e5f\u9700\u8981\u8f49\u63db\u6210 PCM\u3002\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u60f3\u8981\u7de8\u8f2f\u4e00\u500b MP3 \u6a94\u6848\uff0cAudacity \u6703\u5148\u8f49\u6210 PCM \u683c\u5f0f\u8b93\u6211\u5011\u7de8\u8f2f\uff0c\u5728\u5b58\u6a94\u7684\u6642\u5019\uff0c\u518d\u628a PCM \u8f49\u56de MP3\u3002\u53e6\u5916\uff0c\u5728\u4f7f\u7528 Audacity \u7684\u6642\u5019\uff0c\u53ef\u4ee5\u6ce8\u610f\u5230\u6709\u4e00\u9805 \"Import-&gt;Raw Data\" \u7684\u529f\u80fd\uff0c\u5c31\u662f\u7528\u4f86\u532f\u5165\u6c92\u6709\u6a94\u982d\u7684 PCM \u8cc7\u6599\uff0c\u800c\u7531\u65bc\u6c92\u6709\u6a94\u982d\uff0c\u5c31\u5fc5\u9808\u624b\u52d5\u586b\u5165\u8072\u9053\u6578\u91cf\u3001sample rate \u7b49\u2026\u3002</p>"},{"location":"pcm/#_3","title":"\u97f3\u8a0a\u8655\u7406","text":"<p>\u4e00\u822c\u5728\u8b1b\u6578\u4f4d\u97f3\u8a0a\u8655\u7406\u7684\u66f8\u7c4d\u6216\u6587\u4ef6\uff0c\u63a5\u4e0b\u4f86\u5f80\u5f80\u6703\u8b1b\u600e\u6a23\u88fd\u4f5c\u5404\u7a2e\u8072\u97f3\u6548\u679c\uff0c\u50cf\u662f\u600e\u6a23\u5c0d\u8072\u97f3\u8a0a\u865f\u505a\u5085\u7acb\u8449\u8f49\u63db\uff08Fourier Transform\uff09\uff0c\u4ee5\u53ca\u600e\u6a23\u7528\u7a0b\u5f0f\u7522\u751f\u6ce2\u578b\uff0c\u50cf\u662f sine wave\u3001sawtooth wave\u2026\u9032\u800c\u6253\u9020\u5c6c\u65bc\u81ea\u5df1\u7684\u6578\u4f4d\u6a02\u5668\uff0c\u7b49\u7b49\u3002</p> <p>\u5728\u9019\u908a\uff0c\u6211\u5011\u4e3b\u8981\u8b1b\u89e3\u5404\u7a2e\u683c\u5f0f\u7684\u6a94\u6848\uff0c\u6240\u4ee5\u4e26\u4e0d\u8a0e\u8ad6\u9019\u90e8\u4efd\uff08\u5176\u5be6\u6211\u81ea\u5df1\u5c0d\u9019\u65b9\u9762\u4e5f\u4e0d\u600e\u9ebc\u4e86\u89e3\uff09\uff0c\u4e0d\u904e\uff0c\u6211\u5011\u9700\u8981\u77e5\u9053\uff1a\u5982\u679c\u8981\u7522\u751f\u6539\u8b8a\u8072\u97f3\u672c\u8eab\u7684\u5404\u7a2e\u6548\u679c\uff0c\u50cf\u662f EQ \u7b49\u5316\u5668\u3001\u8ff4\u97f3\u3001\u6b98\u97ff\u6216\u7acb\u9ad4\u8072\u6548\u679c\u7b49\uff0c\u90fd\u662f\u900f\u904e\u6539\u8b8a\u6ce2\u578b\u9054\u6210\u7684\uff0c\u800c\u5982\u679c\u6211\u5011\u60f3\u8981\u5728 UI \u4e0a\u986f\u793a\u983b\u8b5c\u5716\uff0c\u4e5f\u662f\u5148\u8b80\u53d6 PCM \u8a0a\u865f\uff0c\u7136\u5f8c\u7e6a\u88fd\u51fa\u8f49\u63db\u5f8c\u7684\u7d50\u679c\u3002</p> <p>\u4e5f\u5c31\u662f\u8aaa\uff0c\u5982\u679c\u6211\u5011\u9078\u64c7\u4e86\u67d0\u7a2e\u97f3\u6a94\u683c\u5f0f\uff0c\u9019\u7a2e\u683c\u5f0f\u53ea\u80fd\u5920\u7528\u7279\u5b9a\u7684\u64ad\u653e\u5668\u64ad\u653e\uff0c\u8b93\u6211\u5011\u7121\u6cd5\u76f4\u63a5\u78b0\u89f8\u5230 PCM \u683c\u5f0f\u7684\u8cc7\u6599\uff0c\u6211\u5011\u5c31\u7121\u6cd5\u9054\u5230\u4e0a\u8ff0\u7684\u9019\u4e9b\u6548\u679c\u3002\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u6253\u7b97\u4f7f\u7528\u4e00\u4e9b\u7d93\u904e\u5546\u7528 DRM \u4fdd\u8b77\u7684\u683c\u5f0f\uff0c\u50cf\u662f\u7d93\u904e\u860b\u679c FairPlay \u4fdd\u8b77\u7684 HLS\u3001\u6216\u662f Google \u7684 Widevine \u4fdd\u8b77\u7684 Dash \u4e32\u6d41\uff0c\u9019\u4e9b\u4e32\u6d41\u683c\u5f0f\u5c31\u53ea\u80fd\u5920\u7528\u7279\u5b9a\u64ad\u653e\u5668\u64ad\u653e\uff0c\u5982\u679c\u9084\u60f3\u8981\u52a0\u4e0a DTS \u7acb\u9ad4\u8072\u6548\u679c\uff0c\u5c31\u662f\u5b8c\u5168\u885d\u7a81\u7684\u3002\u6216\u8a31\u67d0\u4e9b\u64ad\u653e\u5143\u4ef6\u63d0\u4f9b\u7d66\u6211\u5011\u4e00\u4e9b\u9078\u9805\uff0c\u4f46\u53ea\u8981\u4e0d\u80fd\u5920\u78b0\u5230 PCM \u683c\u5f0f\u7684\u8cc7\u6599\uff0c\u6211\u5011\u80fd\u5920\u5c0d\u8072\u97f3\u6548\u679c\u7684\u5ba2\u88fd\u90fd\u662f\u6709\u9650\u7684\u3002</p>"},{"location":"pcm/#cd-hi-res-audio","title":"CD \u97f3\u8cea\u3001Hi-Res Audio","text":"<p>\u6211\u5011\u6240\u8b02\u7684 CD \u97f3\u8cea\uff0c\u5c31\u662f\u7528 44100 \u7684\u63a1\u6a23\u7387\u3001\u6709\u5de6\u53f3\u8072\u9053\u7684 16 \u4f4d\u5143\u6574\u6578\uff08Sint16\uff09\uff0c\u6240\u4ee5\u6211\u5011\u53ef\u4ee5\u9810\u4f30\uff0c\u4e00\u79d2\u9418\u7684\u8cc7\u6599\u91cf\u5c31\u662f 44100 * 2 * 2 = 176400 \uff0c\u4e00\u5206\u9418\u5c31\u9700\u8981 10mb \u5de6\u53f3\uff0c\u4e00\u5f35 CD \u6709 640mb \u7684\u5bb9\u91cf\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u7b97\u51fa\u4e00\u5f35 CD \u53ef\u4ee5\u5bb9\u7d0d\u5927\u7d04 63 \u5206\u9418\u7684\u8072\u97f3\u8cc7\u6599\uff08640 * 1024 * 1024) / (44100 * 2 * 2 * 60) \uff0c\u5927\u7d04 63.4\uff09\u3002\u9019\u4e5f\u662f\u9577\u4e45\u4ee5\u4f86\u6578\u4f4d\u97f3\u6a02\u7684\u6a19\u6e96\u3002</p> <p>\u6211\u5011\u5e38\u5e38\u8aaa\u665a\u8fd1\u4e00\u4e9b\u8a02\u95b1\u5236\u97f3\u6a02\u670d\u52d9\u662f\u300c\u6578\u4f4d\u97f3\u6a02\u300d\uff0c\u4e0d\u904e\uff0cCD \u5c31\u5df2\u7d93\u662f\u6578\u4f4d\u97f3\u6a02\u4e86\uff0cCD \u4e5f\u5275\u9020\u4e86\u4e00\u500b\u8f1d\u714c\u7684\u5531\u7247\u92b7\u552e\u6642\u4ee3\u3002</p> <p>\u6b64\u5916\u9084\u6709\u4ee5\u4e0b\u5e38\u898b\u7684\u97f3\u8cea\u6a19\u6e96</p> <ul> <li>\u96fb\u8a71\u97f3\u8cea\uff1a11,025 Hz, 8bits, \u55ae\u8072\u9053</li> <li>\u6536\u97f3\u6a5f\u97f3\u8cea\uff1a22,050 Hz, 8bits, \u55ae\u8072\u9053</li> <li>DVD \u97f3\u8cea\uff1a96,000 Hz, 24bits \u96d9\u8072\u9053</li> </ul> <p>\u81f3\u65bc\u6240\u8b02\u7684 Hi Res Audio\uff0c\u5176\u5be6\u5b9a\u7fa9\u5f88\u6df7\u4e82\uff0c\u57fa\u672c\u4e0a\u610f\u7fa9\u5c31\u662f CD \u97f3\u8cea\u4ee5\u4e0a\u7684\u6a94\u6848\uff0c\u901a\u5e38\u662f\u6307 96k \u6216 192k Hz \u63a1\u6a23\u6bd4\u7684\u97f3\u6a94\u3002</p> <p>\u66f4\u9ad8\u7684\u63a1\u6a23\u6bd4\u610f\u5473\u8457\u97f3\u8cea\u7684\u63d0\u5347\uff0c\u4e0d\u904e\uff0c\u4f46\u5c0d\u65bc\u5f88\u591a\u7528\u6236\u4f86\u8aaa\uff0c\u5982\u679c\u53ea\u662f\u4f7f\u7528\u4e00\u822c\u7684\u8033\u6a5f\u8a2d\u5099\uff0c\u5176\u5be6\u807d\u4e0d\u51fa\u66f4\u9ad8\u63a1\u6a23\u6bd4\u6709\u4ec0\u9ebc\u5dee\u5225\uff0c\u800c\u4e14\u5f88\u591a\u73fe\u5728\u6d41\u884c\u7684\u85cd\u82bd\u7121\u7dda\u8033\u6a5f\uff08\u5982\u860b\u679c\u7684 Air Pod\uff09\uff0c\u5728\u900f\u904e\u85cd\u82bd\u50b3\u905e\u97f3\u8a0a\u6642\uff0c\u70ba\u4e86\u8b93\u85cd\u82bd\u50b3\u8f38\u9806\u66a2\uff0c\u9084\u6703\u505a\u904e\u8f49\u6a94\u3001\u91cd\u65b0\u8f49\u6210\u7279\u5b9a\u63a1\u6a23\u6bd4\u7684\u8cc7\u6599\uff0c\u628a\u9ad8\u97f3\u8cea\u7684\u6a94\u6848\u8f49\u6210\u666e\u901a\u7684\u97f3\u8cea\u64ad\u653e\u3002</p>"},{"location":"tools/","title":"\u5e38\u7528\u76f8\u95dc\u5de5\u5177","text":"<p>\u8ddf\u97f3\u6a94\u76f8\u95dc\u7684\u5de5\u5177\u975e\u5e38\u591a\uff0c\u6211\u5011\u5148\u4ecb\u7d39\u4e00\u4e9b\u5e38\u7528\u7684\u5de5\u5177</p>"},{"location":"tools/#file","title":"file \u6307\u4ee4","text":"<p>\u5982\u679c\u4f60\u62ff\u5230\u4e00\u500b\u6a94\u6848\uff0c\u537b\u7121\u6cd5\u78ba\u5b9a\u9019\u500b\u6a94\u6848\u662f\u4ec0\u9ebc\u985e\u578b\uff0c\u751a\u81f3\u6c92\u6709\u526f\u6a94\u540d\u53ef\u4ee5\u5224\u65b7\uff0c\u5c31\u53ef\u4ee5\u5148\u7528 <code>file</code> \u9019\u500b\u547d\u4ee4\u5217\u6307\u4ee4\u78ba\u8a8d\u770b\u770b\u3002</p> <p><code>file</code> \u9019\u500b\u6307\u4ee4\u7684\u7528\u9014\uff0c\u5c31\u662f\u5e6b\u52a9\u4f60\u5224\u65b7\u6a94\u6848\u985e\u578b\uff0c\u5728 macOS \u4ee5\u53ca\u5f88\u591a UNIX-like \u7684\u7cfb\u7d71\u4e0a\u662f\u5167\u5efa\u7684\u6307\u4ee4\uff0c\u53e6\u5916\u4e5f\u6709\u5c08\u4f9b Windows \u5e73\u53f0\u4f7f\u7528\u7684\u7248\u672c\u53ef\u4ee5\u4e0b\u8f09\u3002<code>file</code> \u53ef\u4ee5\u5e6b\u4f60\u6aa2\u67e5\u51fa\u975e\u5e38\u591a\u7a2e\u7a2e\u985e\u7684\u6a94\u6848\u985e\u578b\uff0c\u4e26\u4e0d\u5c40\u9650\u65bc\u97f3\u6a94\uff0c\u5404\u7a2e\u5716\u7247\u3001\u6587\u4ef6\u683c\u5f0f\uff0c\u90fd\u53ef\u4ee5\u6aa2\u67e5\u51fa\u4f86\u3002</p> <p>\u5728\u4e0b\u9762\u7684\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u6709\u4e00\u500b\u6a94\u6848\u53eb\u505a\u300csong\u300d\uff0c\u4f46\u662f\u6c92\u6709\u526f\u6a94\u540d\uff0c<code>file</code> \u5f88\u8f15\u6613\u7684\u5e6b\u6211\u5011\u5224\u65b7\u51fa\uff0c\u985e\u578b\u662f<code>ISO Media, Apple iTunes ALAC/AAC-LC (.M4A) Audio</code>\u2014\u9019\u4e00\u500b M4A \u6a94\u6848\uff0c\u4e0d\u904e\u4ed6\u89ba\u5f97\u6709\u53ef\u80fd\u662f AAC codec\uff0c\u4e5f\u53ef\u80fd\u662f\u860b\u679c\u81ea\u5df1\u7684\u7121\u640d\u683c\u5f0f ALAC\u3002</p> <p></p>"},{"location":"tools/#ffmpeg","title":"ffmpeg","text":"<p>ffmpeg \u5927\u6982\u662f\u5728\u6240\u6709\u5e73\u53f0\u4e0a\u90fd\u76f8\u7576\u901a\u884c\u7684\u5de5\u5177\u3002\u9019\u7d44\u5de5\u5177\u5728 Linux \u4e0a\u53ef\u4ee5\u7528 apt-get \u7b49\u5957\u4ef6\u7ba1\u7406\u5de5\u5177\u5b89\u88dd\uff0c\u5728 macOS \u5247\u53ef\u4ee5\u7528 homebrew \u5b89\u88dd\uff0c\u81f3\u65bc Windows \u7248\u672c\uff0c\u5247\u53ef\u4ee5\u53bb\u5b98\u7db2\u4e0a\u4e0b\u8f09\u3002</p> <p>\u6574\u5957 ffpmeg \u4e2d\uff0c\u6709\u4e09\u5957\u5de5\u5177\uff1a</p> <ul> <li><code>ffmpeg</code>\uff1a\u8ca0\u8cac\u6a94\u6848\u683c\u5f0f\u7684\u8f49\u63db</li> <li><code>ffplay</code>\uff1a\u547d\u4ee4\u5217\u64ad\u653e\u5de5\u5177</li> <li><code>ffprobe</code>\uff1a\u6a94\u6848\u683c\u5f0f\u89e3\u6790\u5de5\u5177</li> </ul> <p><code>ffprobe</code> \u53ef\u4ee5\u5e6b\u6211\u5011\u8b80\u51fa\u6b4c\u66f2\u7684 metadata\uff0c\u4ee5\u53ca\u50cf\u662f sample rate\u3001bit rate \u7b49\u57fa\u672c\u8cc7\u8a0a\uff0c\u5982\u4e0b\u5716\uff1a</p> <p></p> <p>\u6211\u5011\u770b\u5230\uff0c<code>ffprobe</code> \u5e6b\u6211\u5011\u89e3\u6790\u51fa</p>"},{"location":"tools/#afconvertafplay-afinfo","title":"afconvert\u3001afplay\u3001\u8207 afinfo","text":"<p><code>afconvert</code>\u3001<code>afplay</code> \u8207 <code>afinfo</code> \u662f\u500b macOS \u4e0b\u7684\u547d\u4ee4\u5217\u6307\u4ee4\uff0c\u9019\u4e09\u500b\u6307\u4ee4\uff0c\u5176\u5be6\u53ef\u4ee5\u8207 ffmpeg \u63d0\u4f9b\u7684\u4e09\u500b\u5de5\u5177\u4e4b\u9593\u5c0d\u61c9\u8d77\u4f86\uff1a</p> \u529f\u80fd ffmpeg \u6307\u4ee4 macOS \u6307\u4ee4 \u8f49\u6a94 ffmpeg afconvert \u64ad\u653e ffplay afplay \u89e3\u6790 ffprobe afinfo <p>\u8ddf ffmpeg \u6bd4\u8f03\uff0c\u9019\u4e9b\u7cfb\u7d71\u5de5\u5177\u6700\u4e3b\u8981\u7684\u7279\u8272\u662f\u4f7f\u7528 Core Audio API\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u6709\u4e00\u500b\u7528 Core Audio \u958b\u767c\u7684\u64ad\u653e\u5668\uff0c\u60f3\u8981\u78ba\u8a8d\u662f\u5426\u53ef\u4ee5\u9806\u5229\u64ad\u653e\uff0c\u6216\u662f\u60f3\u77e5\u9053\u7528 Core Audio API \u53ef\u4ee5\u89e3\u6790\u51fa\u54ea\u8cc7\u8a0a\uff0c\u5c31\u53ef\u4ee5\u5584\u7528\u9019\u4e9b\u6307\u4ee4\u3002\u76f8\u5c0d\u5730\uff0c\u5982\u679c Core Audio \u4e26\u4e0d\u652f\u63f4\u9019\u7a2e\u6a94\u6848\u683c\u5f0f\uff08\u50cf\u6211\u5011\u5728\u8b1b HLS \u63d0\u5230\u7684 ts\u3001\u9084\u6709\u524d\u7ae0\u8b1b\u5230\u7684 DASH\u2026\uff09\uff0c\u90a3\u9ebc\u5c31\u6d3e\u4e0d\u4e0a\u7528\u5834\u4e86\u3002</p> <p><code>afplay</code> \u7684\u7528\u9014\u662f\u76f4\u63a5\u5728\u547d\u4ee4\u5217\u4e0b\u64ad\u653e\u6a94\u6848\uff0c\u76f8\u8f03\u65bc\u6709 GUI \u7684\u64ad\u653e\u8edf\u9ad4\uff0c\u9019\u500b\u6307\u4ee4\u53ef\u4ee5\u76f4\u63a5\u7528\u53c3\u6578\uff0c\u6307\u5b9a\u8981\u64ad\u653e\u591a\u4e45\u4ee5\u53ca\u64ad\u653e\u901f\u7387\uff0c\u6bd4\u65b9\u8aaa\uff0c\u4e0b\u4e86 <code>afplay -t 5 -r 1.5 song.mp4</code> \u6307\u4ee4\uff0c\u5c31\u53ef\u4ee5\u7528 1.5 \u500d\u901f\u7387\uff0c\u53ea\u64ad\u653e\u9019\u500b\u6a94\u6848\u4e94\u79d2\u9418\u3002</p> <p><code>afinfo</code> \u5247\u53ef\u4ee5\u67e5\u770b\u6a94\u6848\u7684\u76f8\u95dc\u8cc7\u8a0a\u3002\u4ee5\u4e00\u500b aac \u6a94\u6848\u4f86\u8aaa\uff0c\u6211\u5011\u53ef\u80fd\u6703\u770b\u5230\u9019\u6a23\u7684\u8cc7\u8a0a\uff1a</p> <p></p> <p>\u5f9e\u9019\u88e1\u6211\u5011\u5c31\u53ef\u4ee5\u770b\u5230\uff0cafinfo \u5e6b\u6211\u5011\u627e\u51fa Sample Rate \u662f 44100\uff0c\u6709\u5169\u500b\u8072\u9053\u3001\u6bcf\u500b packet \u6709 1024 \u500b frame \u7b49\u8cc7\u8a0a\uff0c\u6bcf\u500b packet \u6709\u591a\u5c11 bytes \u70ba 0\uff0c\u4ee3\u8868 bit rate \u6703\u8b8a\u52d5\uff0c\u4f46\u5f9e bit rate \u7b97\u51fa\u4f86\u662f 319725\uff0c\u90a3\u5dee\u4e0d\u591a\u662f\u500b 320k \u7684\u97f3\u6a94\u3002afinfo \u5e6b\u6211\u5011\u627e\u5230 9281 \u500b packet\uff0c\u7b97\u4e00\u4e0b 9281 * 1024 / 44100\uff0c\u5927\u6982 215.504399\uff0c\u4e0d\u904e afinfo \u7b97\u51fa\u4f86\u662f 215.456508\uff0c\u4f3c\u4e4e\u6709\u9ede\u8aa4\u5dee\uff0c\u4e3b\u8981\u539f\u56e0\u662f\u6263\u53bb\u4e86\u524d\u65b9 2112 \u500b\u586b\u96f6\u7684 frame\uff08priming frame\uff09\u3002</p> <p>\u770b\u5230\u300cnot optimized\u300d\u5247\u8981\u6ce8\u610f\uff0c\u9019\u7a2e\u6a94\u6848\u7684 <code>moov</code> atom \u662f\u653e\u5728 <code>mdat</code> \u5f8c\u65b9\uff0c\u90a3\u9ebc\uff0ciOS \u4e0a\u7684 Core Audio \u7684 parser\uff0c\u5c31\u53ef\u80fd\u7121\u6cd5\u89e3\u6790\u9019\u7a2e\u6a94\u6848\uff0c\u901a\u5e38\u6211\u5011\u7528 <code>ffmpeg</code> \u8f49\u51fa\u7684\u6a94\u6848 MP4 \u6216 ALAC \u6a94\u6848\u4fbf\u6703\u5982\u6b64\uff0c\u9019\u6642\u5019\u5c31\u53ef\u4ee5\u8a66\u8a66\u770b\u4f7f\u7528 <code>afconvert</code> \u8f49\u6a94\u3002\u8acb\u53c3\u8003 AAC \u8207 MP4 \u683c\u5f0f \u9019\u4e00\u7ae0\u4e2d\u7684\u8aaa\u660e\u3002</p>"},{"location":"tools/#mdls-mdfind","title":"mdls \u8207 mdfind","text":"<p>\u9019\u4e5f\u662f macOS \u4e0a\u7684\u5de5\u5177\uff0c\u800c\u4e14\u56b4\u683c\u4f86\u8aaa\uff0c\u9019\u662f macOS \u7cfb\u7d71\u529f\u80fd Spottlight \u641c\u5c0b\u5de5\u5177\u7684\u76f8\u95dc\u547d\u4ee4\u5217\u5de5\u5177\u3002 <code>mdls</code> \u7684\u7528\u9014\u662f\u5f9e\u6a94\u6848\u4e2d\u62bd\u53d6\u51fa\u8cc7\u8a0a\uff0c\u7136\u5f8c\u8b93 Spotlight \u5efa\u7acb\u6aa2\u7d22\uff08index\uff09\uff0c\u6240\u4ee5 <code>mdls</code> \u6240\u5448\u73fe\u51fa\u4f86\u7684\u5c31\u662f\u6839\u64da Spottlight \u6b04\u4f4d\u7684\u8cc7\u6599\u3002</p> <p>\u7528 <code>mdls</code> \u5448\u73fe\u51fa\u4f86\u7684\u8cc7\u6599\u5982\u4e0b\uff1a</p> <p></p> <p>\u7136\u5f8c\uff0c\u56e0\u70ba\u6211\u5011\u77e5\u9053\u6709\u54ea\u4e9b\u6b04\u4f4d\u53ef\u7528\uff0c\u6240\u4ee5\u6709\u6642\u5019\u6211\u5011\u53ef\u4ee5\u900f\u904e <code>mdfind</code> \u505a\u4e00\u4e9b\u5947\u7279\u7684\u641c\u5c0b\u3002\u6bd4\u65b9\u8aaa\uff0c\u6211\u5011\u7a81\u7136\u60f3\u8981\u627e\u51fa\u96fb\u8166\u88e1\u982d\u6240\u6709 bit rate \u90fd\u662f 128k \u7684\u97f3\u6a94\uff0c\u5c31\u53ef\u4ee5\u7528\u4ee5\u4e0b\u6307\u4ee4\uff1a</p> <pre><code>mdfind \"kMDItemTotalBitRate == 128000\"\n</code></pre> <p>\u7d50\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u9019\u908a\u4e5f\u5217\u51fa\u4e00\u4e9b\u53ef\u4ee5\u8a66\u8a66\u770b\u7684\u641c\u5c0b\u689d\u4ef6\uff1a</p> <ul> <li>\u627e\u51fa\u96fb\u8166\u4e0a\u6240\u6709\u7684 FLAC \u6a94\u6848\uff1a<code>mdfind \"kMDItemContentTypeTree=org.xiph.flac\"</code></li> <li>\u627e\u51fa\u96fb\u8166\u4e0a\u6240\u6709\u7684 MP4 \u6a94\u6848\uff1a<code>mdfind \"kMDItemContentTypeTree=public.mpeg-4-audio\"</code></li> <li>\u627e\u51fa\u96fb\u8166\u4e0a\u6240\u6709\u7684\u6416\u6efe\u6a02\u98a8\u7684\u6a94\u6848\uff1a<code>mdfind \"kMDItemMusicalGenre=Rock\"</code></li> <li>\u641c\u5c0b\u9577\u5ea6\u5927\u65bc\u4e94\u5206\u9418\u7684\u6a94\u6848\uff1a<code>mdfind \"kMDItemDurationSeconds&gt;300\"</code></li> </ul>"}]}